<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.57 in css mode. -->
<html>
  <head>
    <title>AlBasmala.org</title>
    <style type="text/css">
    <!--
      body {
        color: #122B3F;
        background-color: #F7F8FD;
      }
      .bold {
        /* bold */
        font-weight: bold;
      }
      .bold-italic {
        /* bold-italic */
        font-weight: bold;
        font-style: italic;
      }
      .builtin {
        /* font-lock-builtin-face */
        color: #F99416;
      }
      .comment {
        /* font-lock-comment-face */
        color: #7D8EAE;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #7D8EAE;
      }
      .constant {
        /* font-lock-constant-face */
        color: #36A1BB;
      }
      .css-property {
        /* css-property */
        color: #F99416;
        font-weight: bold;
      }
      .css-proprietary-property {
        /* css-proprietary-property */
        color: #F99416;
        font-weight: bold;
        font-style: italic;
      }
      .css-selector {
        /* css-selector */
        color: #36A1BB;
      }
      .custom {
        /* (:foreground "orange") */
        color: #ffa500;
      }
      .custom-1 {
        /* (:foreground "#dc8cc3") */
        color: #dc8cc3;
      }
      .custom-10 {
      }
      .custom-11 {
        /* (:foreground "#afd8af") */
        color: #afd8af;
      }
      .custom-12 {
        /* (:foreground "#d0bf8f") */
        color: #d0bf8f;
      }
      .custom-13 {
      }
      .custom-14 {
        /* (:foreground "#cc9393") */
        color: #cc9393;
      }
      .custom-2 {
        /* (:background "#4183c4" :foreground "#ffffff" :box (:line-width -1)) */
        color: #ffffff;
        background-color: #4183c4;
      }
      .custom-3 {
        /* (:background "#fff" :foreground "black" :box (:line-width -1)) */
        color: #000000;
        background-color: #fff;
      }
      .custom-4 {
        /* (:background "#ddd" :foreground "black" :box (:line-width -1)) */
        color: #000000;
        background-color: #ddd;
      }
      .custom-5 {
        /* (:background "#000000" :foreground "#ffffff" :box (:line-width -1)) */
        color: #ffffff;
        background-color: #000000;
      }
      .custom-6 {
        /* (:background "#ff0000" :foreground "#ffffff" :box (:line-width -1)) */
        color: #ffffff;
        background-color: #ff0000;
      }
      .custom-7 {
        /* (:background "#ffc0cb" :foreground "black" :box (:line-width -1)) */
        color: #000000;
        background-color: #ffc0cb;
      }
      .custom-8 {
        /* (:background "#777777" :foreground "#ffffff" :box (:line-width -1)) */
        color: #ffffff;
        background-color: #777777;
      }
      .custom-9 {
        /* (:background "#ffffff" :foreground "black" :box (:line-width -1)) */
        color: #000000;
        background-color: #ffffff;
      }
      .custom-button {
        /* custom-button */
        color: #000000;
        background-color: #d3d3d3;
      }
      .doc {
        /* font-lock-doc-face */
        color: #902B5B;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #36A1BB;
      }
      .hl-todo {
        /* hl-todo */
        color: #cc9393;
        font-weight: bold;
      }
      .italic {
        /* italic */
        font-style: italic;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #F99416;
        font-weight: bold;
      }
      .negation-char {
      }
      .org-block {
        /* org-block */
        background-color: #EDF2FF;
      }
      .org-block-begin-line {
        /* org-block-begin-line */
        color: #7D8EAE;
        background-color: #FBFBFE;
        font-size: 80%;
        text-decoration: underline;
      }
      .org-block-end-line {
        /* org-block-end-line */
        color: #7D8EAE;
        background-color: #FBFBFE;
        font-size: 80%;
        text-decoration: overline;
      }
      .org-code {
        /* org-code */
        color: #863FC4;
        background-color: #F7F8FD;
      }
      .org-date {
        /* org-date */
        color: #863FC4;
      }
      .org-document-info {
        /* org-document-info */
        color: #191970;
      }
      .org-document-info-keyword {
        /* org-document-info-keyword */
        color: #7D8EAE;
      }
      .org-document-title {
        /* org-document-title */
        color: #191970;
        font-weight: bold;
      }
      .org-done {
        /* org-done */
        color: #739F2F;
      }
      .org-drawer {
        /* org-drawer */
        color: #BBC1DC;
      }
      .org-formula {
        /* org-formula */
        color: #b22222;
      }
      .org-headline-done {
        /* org-headline-done */
        color: #739F2F;
      }
      .org-hide {
        /* org-hide */
        color: #F7F8FD;
      }
      .org-inline-src-block {
        /* org-inline-src-block */
        background-color: #EDF2FF;
      }
      .org-latex-and-related {
        /* org-latex-and-related */
        background-color: #EDF2FF;
      }
      .org-level-1 {
        /* org-level-1 */
        color: #F99416;
        font-weight: bold;
      }
      .org-level-2 {
        /* org-level-2 */
        color: #36A1BB;
        font-weight: bold;
      }
      .org-level-3 {
        /* org-level-3 */
        color: #902B5B;
        font-weight: bold;
      }
      .org-level-4 {
        /* org-level-4 */
        color: #739F2F;
        font-weight: bold;
      }
      .org-link {
        /* org-link */
        color: #739F2F;
        text-decoration: underline;
      }
      .org-list-dt {
        /* org-list-dt */
        font-weight: bold;
      }
      .org-macro {
        /* org-macro */
        background-color: #EDF2FF;
      }
      .org-meta-line {
        /* org-meta-line */
        color: #7D8EAE;
      }
      .org-property-value {
      }
      .org-special-keyword {
        /* org-special-keyword */
        color: #863FC4;
        font-weight: bold;
      }
      .org-table {
        /* org-table */
        color: #863FC4;
      }
      .org-tag {
        /* org-tag */
        color: #902B5B;
      }
      .org-target {
        /* org-target */
        text-decoration: underline;
      }
      .org-todo {
        /* org-todo */
        color: #ED474A;
      }
      .org-verbatim {
        /* org-verbatim */
        color: #863FC4;
        background-color: #F7F8FD;
      }
      .regexp-grouping-backslash {
        /* font-lock-regexp-grouping-backslash */
        font-weight: bold;
      }
      .regexp-grouping-construct {
        /* font-lock-regexp-grouping-construct */
        font-weight: bold;
      }
      .shadow {
        /* shadow */
        color: #7D8EAE;
      }
      .string {
        /* font-lock-string-face */
        color: #739F2F;
      }
      .type {
        /* font-lock-type-face */
        color: #36A1BB;
      }
      .underline {
        /* underline */
        text-decoration: underline;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #863FC4;
      }
      .warning {
        /* font-lock-warning-face */
        color: #ED474A;
        font-weight: bold;
      }
      .writegood-duplicates {
        /* writegood-duplicates-face */
        text-decoration: underline;
      }
      .writegood-passive-voice {
        /* writegood-passive-voice-face */
        text-decoration: underline;
      }
      .writegood-weasels {
        /* writegood-weasels-face */
        text-decoration: underline;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment"># -*- eval: (org-babel-load-file "AlBasmala.org") -*-</span>
<span class="org-document-info-keyword">#+title:</span> <span class="org-document-title">AlBasmala: @@html: &lt;br&gt;@@ Blogging with Emacs &amp; Org-mode (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;
</span><span class="org-meta-line">#+description: How my blog is setup (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;</span>
<span class="org-document-info-keyword">#+date:</span> <span class="org-document-info">&lt;2020-05-03 19:29&gt;
</span><span class="comment"># +DATE: 2018-06-01 ~ date of </span><span class="comment"><span class="writegood-weasels">very</span></span><span class="comment"> first AlBasmala, for a Jekyll-basked blog</span>
<span class="comment"># +filetags: emacs org html css javascript git</span>
<span class="org-meta-line">#+fileimage: org_logo.png </span><span class="org-meta-line"><span class="writegood-duplicates">150 150</span></span><span class="org-meta-line"> no-border</span>
<span class="org-meta-line">#+property: header-args :tangle "~/blog/AlBasmala.el" :results silent :exports code :noeval</span>
<span class="comment"># Use checkmarks instead of boring bullet points</span>
<span class="org-meta-line">#+html_head: &lt;style&gt; ul {list-style-type: " &#10003;"} &lt;/style&gt;</span>

<span class="comment"># </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">: When I'm done, look around and ensure there are no 'TODO's; or if there are any, move them to my todo.org::<a href="Blog::Ideas">Blog::Ideas</a> section!</span>

<span class="comment"># ;; Need this conditional since AlBasmala lives in ~/blog whereas usually articles live in ~/blog/posts.</span>
<span class="comment"># ;; </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">: Consider just making AlBasmala live in ~/blog/posts, I don't think there's any real reason for breaking consistency.</span>
<span class="comment">#</span>
<span class="comment"># In-particular, besides </span><span class="comment"><span class="writegood-weasels">some</span></span><span class="comment"> extra code in blog/style-setup, by breaking consistency, AlBasmala does not produce tag</span>
<span class="comment"># pages /not/ contribute to them! This is </span><span class="comment"><span class="writegood-weasels">probably</span></span><span class="comment"> a good enough reason to have it live alongside the other posts!</span>

<span class="org-level-1">* Abstract                                                           </span><span class="org-level-1"><span class="org-tag">:ignore:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Abstract</span>
<span class="org-drawer">:END:</span>
How my blog is setup (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;

Here are <span class="writegood-weasels">some</span> notable features of my blog.

+ Org-mode, a rich markup, to write articles &#9829;&#8255;&#9829;
+ Tags and RSS feed for blog articles --- &#167;<span class="org-link"><a href="initial-setup">initial-setup</a></span>
+ A nice blog banner --- &#167;<span class="org-link"><a href="blog-banner">blog-banner</a></span>
+ <span class="italic">Dynamically</span> highlighting code from references in prose --- &#167;<span class="org-link"><a href="blog-banner">blog-banner</a></span>
+ Tooltips, folded regions, and badges --- <a href="badge:org-special-block-extras|2.0|informational|https://alhassy.github.io/org-special-block-extras/|Gnu-Emacs">badge:org-special-block-extras|2.0|informational|https://alhassy.github.io/org-special-block-extras/|Gnu-Emacs</a>
+ Overall nice looking HTML style --- <span class="org-link"><a href="http://taopeng.me/org-notes-style/">org-notes-style</a></span>
+ Beautiful math using LaTeX notation,<span class="org-latex-and-related"> $\forall \phi &#8658; \exists \phi$ </span>---
  &#167;<span class="org-link"><a href="MathJax-Support">MathJax-Support</a></span>
+ A floating, yet unobtrusive, table of contents --- &#167;<span class="org-link"><a href="floating-toc">floating-toc</a></span>
+ Headings are clickable links with the resulting anchors being
  Github-like --- &#167;<span class="org-link"><a href="ensuring-useful-html-anchors">ensuring-useful-html-anchors</a></span> and &#167;<span class="org-link"><a href="clickable-headlines">clickable-headlines</a></span>
+ Comments for blog readers --- &#167;<span class="org-link"><a href="Comments">Comments</a></span>
+ Articles have dedicated images, &#167;<span class="org-link"><a href="Images">Images</a></span>, which <span class="writegood-passive-voice">are displayed</span>
  on the blog's welcome page along with the article's abstract, &#167;<span class="org-link"><a href="Index">Index</a></span>
  - Auto-generated index/sitemap that shows an image and short abstract of each article
+ Augment article footers to link to the Org source and to the Github history
  --- &#167;<span class="org-link"><a href="footers">footers</a></span>
  - Org source <span class="writegood-passive-voice">is colourised</span>!
+ Article titles may contain arbitrary <span class="comment">@@</span><span class="org-tag">html:</span><span class="org-code"> ...</span><span class="comment">@@</span> <span class="italic">yet</span> still render nicely in both the frame tab and page title,
  thanks to <span class="custom-button"><a href="doc:org-link/blog">doc:org-link/blog</a></span>.
+ <span class="italic">Dynamically</span> adjust amount of time left until user finishes reading the
    article --- &#167;<span class="org-link"><a href="footers">footers</a></span>
+ Style inline code and tables --- &#167;<span class="org-link"><a href="curvy-blocks">curvy-blocks</a></span>
+ Unfurling links --- &#167;<span class="org-link"><a href="unfurling">unfurling</a></span>

<span class="org-level-1">* Image Org Link                                          </span><span class="org-level-1"><span class="org-tag">:details_imagelink:</span></span>

A quick way to embed clickable images, along with tooltip credits and other configs.

<span class="org-block-begin-line">#+begin_src emacs-lisp :exports code
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">org-deflink</span></span><span class="org-block"> image
             </span><span class="org-block"><span class="string">"Provide a quick way to insert images along with credits via tooltips.

Example usage:

<a href="image:https://upload.wikimedia.org/wikipedia/commons/3/33/Heisokudachi.svg|100|100">image:https://upload.wikimedia.org/wikipedia/commons/3/33/Heisokudachi.svg|100|100</a>

<a href="image:URL|WIDTH|HEIGHT|CENTER?|CREDIT">image:URL|WIDTH|HEIGHT|CENTER?|CREDIT</a>?
"</span></span><span class="org-block">
</span><span class="org-block"><span class="comment-delimiter">;;             </span></span><span class="org-block"><span class="comment">(upcase (or o-description o-label))
</span></span><span class="org-block">  (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [(image width height center? credit?) (s-split </span><span class="org-block"><span class="string">"|"</span></span><span class="org-block"> o-label)]
    (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [unsplash (cl-second (s-match </span><span class="org-block"><span class="string">".*unsplash.com/photos/</span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">(</span></span></span><span class="org-block"><span class="string">.*</span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">)</span></span></span><span class="org-block"><span class="string">"</span></span><span class="org-block"> image))]
      (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((href (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (concat </span><span class="org-block"><span class="string">"<a href="https://unsplash.com/photos/">https://unsplash.com/photos/</a>"</span></span><span class="org-block"> unsplash) image))
            (title (format </span><span class="org-block"><span class="string">"Image credit &#8220;%s&#8221;"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> credit? (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (concat </span><span class="org-block"><span class="string">"<a href="https://unsplash.com/photos/">https://unsplash.com/photos/</a>"</span></span><span class="org-block"> unsplash) image))))
            (src (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (format </span><span class="org-block"><span class="string">"<a href="https://source.unsplash.com/%s/%sx%s">https://source.unsplash.com/%s/%sx%s</a>"</span></span><span class="org-block"> unsplash width height) image))
            (it (format </span><span class="org-block"><span class="string">"&lt;a href=\"%s\" class=\"tooltip\" title=\"%s\"&gt;&lt;img src=\"%s\" alt=\"Article image\"
             width=\"%s\" height=\"%s\" align=\"top\"/&gt;&lt;/a&gt;"</span></span><span class="org-block">
                        href title src width height)))
        (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> center?
            (format </span><span class="org-block"><span class="string">"&lt;center&gt; %s &lt;/center&gt;"</span></span><span class="org-block"> it)
          it)))))
</span><span class="org-block-end-line">#+end_src
</span>
This will eventually be part of <span class="org-link"><a href="http://alhassy.com/org-special-block-extras/">org-special-block-extras</a></span>.

<span class="org-level-1">* Redefining Org Section for purposes of blocks              </span><span class="org-level-1"><span class="org-tag">:details_deftag:</span></span>

<a href="image:https://i.redd.it/rre5ggpx9jya1.png|100%|100%|center|Musa">image:https://i.redd.it/rre5ggpx9jya1.png|100%|100%|center|Musa</a>
(<span class="org-link"><a href="https://www.reddit.com/r/emacs/comments/13bdlck/tags_are_functions_of_org_sections_%E1%B4%97%D9%88/">Reddit Post</a></span>)

This will eventually be part of <span class="org-link"><a href="http://alhassy.com/org-special-block-extras/">org-special-block-extras</a></span>.

<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp :export none
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defmacro</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">org-deftag</span></span><span class="org-block"> (name args docstring </span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> body)
  </span><span class="org-block"><span class="doc">"Re-render an Org section in any way you like, by tagging the section with NAME.

That is to say, we essentially treat tags as functions that act on Org headings:
We redefine Org sections for the same purposes as Org special blocks.

Anyhow:
ARGS are the sequence of items seperated by underscores after the NAME of the new tag.
BODY is a form that may anaphorically mention:
- O-BACKEND: The backend we are exporting to, such as `</span></span><span class="org-block"><span class="doc"><span class="constant">latex</span></span></span><span class="org-block"><span class="doc">' or `</span></span><span class="org-block"><span class="doc"><span class="constant">html</span></span></span><span class="org-block"><span class="doc">'.
- O-HEADING: The string denoting the title of the tagged section heading.

DOCSTRING is mandatory; everything should </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">be documented</span></span></span><span class="org-block"><span class="doc"> for future maintainability.

The result of this anaphoric macro is a symbolic function name `</span></span><span class="org-block"><span class="doc"><span class="constant">org-deftag/NAME</span></span></span><span class="org-block"><span class="doc">',
which </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is added</span></span></span><span class="org-block"><span class="doc"> to `</span></span><span class="org-block"><span class="doc"><span class="constant">org-export-before-parsing-hook</span></span></span><span class="org-block"><span class="doc">'.

----------------------------------------------------------------------

Below is the motivating reason for inventing this macro. It </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is used</span></span></span><span class="org-block"><span class="doc">:

     ,** Interesting, but low-priority, content   :details_red:
     </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">Blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> blah.
     </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">Blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> </span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">blah blah</span></span></span><span class="org-block"><span class="doc"> blah.

Here is the actual implementation:

(org-deftag details (color)
   \"HTML export a heading as if it were a &lt;details&gt; block; COLOR is an optional
   argument indicating the background colour of the resulting block.\"
   (insert \"\n#+html:\"
           (format \"&lt;details style=\\\"background-color: %s\\\"&gt;\" color)
           \"&lt;summary&gt;\" (s-replace-regexp \"^</span></span><span class="org-block"><span class="doc"><span class="warning">\</span></span></span><span class="org-block"><span class="doc">** \" \"\" heading) \"&lt;/summary&gt;\")
   (org-next-visible-heading 1)
   (insert \"#+html: &lt;/details&gt;\"))

"</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((func-name (intern (format </span><span class="org-block"><span class="string">"org-deftag/%s"</span></span><span class="org-block"> name))))
    `(</span><span class="org-block"><span class="keyword">progn</span></span><span class="org-block">
       (</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> ,func-name (o-backend)
         ,docstring
         (outline-show-all)
         (org-map-entries
          (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> ()
            (kill-line)
            (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((o-heading (car kill-ring)))
              (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> (not (s-contains? (format </span><span class="org-block"><span class="string">":%s"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">quote</span></span><span class="org-block"> ,name)) o-heading 'ignoring-case))
                  (insert o-heading)
                (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [,args (cdr (s-split </span><span class="org-block"><span class="string">"_"</span></span><span class="org-block"> (car (s-match (format </span><span class="org-block"><span class="string">"%s[</span></span><span class="org-block"><span class="string"><span class="negation-char">^</span></span></span><span class="org-block"><span class="string">:]*"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">quote</span></span><span class="org-block"> ,name)) o-heading))))]
                  (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> o-heading (s-replace-regexp (format </span><span class="org-block"><span class="string">":%s[</span></span><span class="org-block"><span class="string"><span class="negation-char">^</span></span></span><span class="org-block"><span class="string">:]*:"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">quote</span></span><span class="org-block"> ,name)) </span><span class="org-block"><span class="string">""</span></span><span class="org-block"> o-heading))
                  ,@body)
                </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Otherwise we impede on the auto-inserted &#8220;* footer :ignore:&#8221;
</span></span><span class="org-block">                (insert </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block">))))))
       (add-hook 'org-export-before-parsing-hook (</span><span class="org-block"><span class="keyword">quote</span></span><span class="org-block"> ,func-name))
       (</span><span class="org-block"><span class="keyword">quote</span></span><span class="org-block"> ,func-name))))
</span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp :export none
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">org-deftag</span></span><span class="org-block"> details (anchor color)
   </span><span class="org-block"><span class="string">"HTML export a heading as if it were a &lt;details&gt; block; ANCHOR &amp; COLOR are optional
   arguments indicating the anchor for this block as well as the background colour of the resulting block.

For example, in my blog, I would use :details_rememberthis_#F47174: to mark a section as
friendly-soft-red to denote it as an &#8220;advanced&#8221; content that could </span></span><span class="org-block"><span class="string"><span class="writegood-passive-voice">be ignored</span></span></span><span class="org-block"><span class="string">
on a first reading of my article.
Incidentally, `</span></span><span class="org-block"><span class="string"><span class="constant">orange</span></span></span><span class="org-block"><span class="string">' and `#f2b195' are also nice &#8216;</span></span><span class="org-block"><span class="string"><span class="constant">warning</span></span></span><span class="org-block"><span class="string">&#8217; colours."</span></span><span class="org-block">
   (insert </span><span class="org-block"><span class="string">"\n#+html:"</span></span><span class="org-block">
           (format </span><span class="org-block"><span class="string">"&lt;div&gt;%s &lt;details class=\"float-child\" style=\"background-color: %s\"&gt;"</span></span><span class="org-block">
                   (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> anchor (format </span><span class="org-block"><span class="string">"&lt;a style=\"width: 1%%;float: left; padding: 0px\" id=\"%s\" href=\"#%s\"&gt;&#128279;&lt;/a&gt;"</span></span><span class="org-block"> </span><span class="org-block"><span class="writegood-duplicates">anchor anchor</span></span><span class="org-block">) </span><span class="org-block"><span class="string">""</span></span><span class="org-block">)
                   color)
           </span><span class="org-block"><span class="string">"&lt;summary&gt; &lt;strong&gt; &lt;font face=\"Courier\" size=\"3\" color=\"green\"&gt;"</span></span><span class="org-block">
           (s-replace-regexp </span><span class="org-block"><span class="string">"^</span></span><span class="org-block"><span class="string"><span class="warning">\</span></span></span><span class="org-block"><span class="string">** "</span></span><span class="org-block"> </span><span class="org-block"><span class="string">""</span></span><span class="org-block"> o-heading)
           </span><span class="org-block"><span class="string">"&lt;/font&gt; &lt;/strong&gt; &lt;/summary&gt;"</span></span><span class="org-block">)
   (org-next-visible-heading 1)
   (insert </span><span class="org-block"><span class="string">"#+html: &lt;/details&gt; &lt;/div&gt;"</span></span><span class="org-block">))
</span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> Demo</span>
See: <span class="org-link"><a href="https://www.reddit.com/r/emacs/comments/13bdlck/tags_are_functions_of_org_sections_%E1%B4%97%D9%88/">https://www.reddit.com/r/emacs/comments/13bdlck/tags_are_functions_of_org_sections_%E1%B4%97%D9%88/</a></span>

<span class="comment">@@</span><span class="org-tag">html:</span> &lt;div style="padding-bottom: 30cm;"&gt;&lt;/div&gt;<span class="comment">@@</span>


<span class="org-hide">**</span><span class="org-level-3">* Tags are functions of Org sections                           </span><span class="org-level-3"><span class="org-tag">:quote_blue:</span></span>
  Just as a source block is a function on a region of text, so too a tag is
  construable as a function operating on an Org section. Thanks to <span class="custom-button"><a href="doc:org-deftag">doc:org-deftag</a></span> (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;

  For instance, this tree <span class="writegood-passive-voice">is tagged</span> <span class="org-verbatim">:quote:</span> with the single parameter <span class="org-verbatim">blue</span>.
  Look to the buffer to the right for the resulting HTML rendition.

<span class="org-hide">**</span><span class="org-level-3">* Here is the actual implementation                   </span><span class="org-level-3"><span class="org-tag">:details_quoteSource:</span></span>

  The implementation is interesting, but it is of low-priority and so it <span class="writegood-passive-voice">is tagged</span>
  with <span class="org-verbatim">:details:</span> which folds it away via a <span class="org-code">&lt;details&gt;</span> element, with an anchor.

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">org-deftag</span></span><span class="org-block"> quote (color)
   </span><span class="org-block"><span class="string">"HTML export a section as if it were a &lt;blockquote&gt; block; COLOR is an optional
   argument indicating the text colour of the resulting block."</span></span><span class="org-block">
   (insert </span><span class="org-block"><span class="string">"\n#+html:"</span></span><span class="org-block"> (format </span><span class="org-block"><span class="string">"&lt;blockquote style=\"color: %s\"&gt;"</span></span><span class="org-block"> color))
   (org-next-visible-heading 1)
   (insert </span><span class="org-block"><span class="string">"#+html: &lt;/blockquote&gt;"</span></span><span class="org-block">))
</span><span class="org-block-end-line">#+end_src
</span>
See <span class="org-link"><a href="http://alhassy.com/AlBasmala#deftag">http://alhassy.com/AlBasmala#deftag</a></span> for the definition of <span class="org-verbatim">org-deftag</span>.

<span class="org-hide">**</span><span class="org-level-3">* Bye!                                                             </span><span class="org-level-3"><span class="org-tag">:ignore:</span></span>

<span class="italic">Have a great evening!</span>




<span class="comment">@@</span><span class="org-tag">html:</span> &lt;div style="padding-bottom: 30cm;"&gt;&lt;/div&gt;<span class="comment">@@</span>
<span class="org-hide">*</span><span class="org-level-2">* Known bug and proposed fix.                                     </span><span class="org-level-2"><span class="org-tag">:noexport:</span></span>
Warning!
<span class="org-block-begin-line">#+begin_src org
</span><span class="org-block">,* Useful notes :noexport:
Be a good person.

,* Advice to readers :details:
Since this section is rewritten as a &lt;details&gt; block,
it will, by structure, reside as an element in the previous
tree which is not exported! </span><span class="org-block"><span class="writegood-duplicates"><span class="writegood-duplicates">This this</span></span></span><span class="org-block"> tree wont be visible!
</span><span class="org-block-end-line">#+end_src
</span>
<span class="hl-todo"><span class="custom-14">TODO</span></span>: Fix the above bug by ensuring all altered headings <span class="writegood-passive-voice">are preserved</span> as
follows.
<span class="org-block-begin-line">#+begin_src org
</span><span class="org-block">,* original heading :FOO:

becomes

,* original heading :ignore:
&#10627;transformed heading&#10628;
</span><span class="org-block-end-line">#+end_src
</span>
This way we ensure that the new tree is <span class="writegood-weasels">completely</span> independent of the previous
tree.

<span class="org-hide">**</span><span class="org-level-3">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-3"> Posterity                             </span><span class="org-level-3"><span class="org-tag">:Delete_when_things_settle:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Posterity</span>
<span class="org-drawer">:END:</span>
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp :export none
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">my-headline-alteration</span></span><span class="org-block"> (backend)
  </span><span class="org-block"><span class="doc">"BACKEND is the export back-end </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">being used</span></span></span><span class="org-block"><span class="doc">, as a symbol."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> first-heading t)
  (outline-show-all)
  (org-map-entries
   (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> ()
    (kill-line)
    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(thing-at-point 'line)
</span></span><span class="org-block">    (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((heading (car kill-ring)))

      (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> (not (s-contains? </span><span class="org-block"><span class="string">":NOPE:"</span></span><span class="org-block"> heading 'ignoring-case))
          (insert heading)

          (insert heading) (insert </span><span class="org-block"><span class="string">"NIIIIICE"</span></span><span class="org-block">)
          </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(if first-heading (setq first-heading nil)
</span></span><span class="org-block">          </span><span class="org-block"><span class="comment-delimiter">;;                 </span></span><span class="org-block"><span class="comment">(insert "+latex:\\end\{alertblock\}"))
</span></span><span class="org-block">        </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(insert "\n\n+latex: \\begin\{alertblock\}\{")
</span></span><span class="org-block">
          (org-next-visible-heading 1)
        (insert </span><span class="org-block"><span class="string">"WOW :: "</span></span><span class="org-block"> (s-chop-prefix </span><span class="org-block"><span class="string">"</span></span><span class="org-block"><span class="string"><span class="warning">\</span></span></span><span class="org-block"><span class="string">** "</span></span><span class="org-block"> heading))

        (insert </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block">) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Otherwise we impede on the auto-inserted &#8220;* footer :ignore:&#8221;
</span></span><span class="org-block">        </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(insert "\}")
</span></span><span class="org-block">      )
    )
)))

(add-hook 'org-export-before-parsing-hook 'my-headline-alteration)
(remove-hook 'org-export-before-parsing-hook 'my-headline-alteration)
</span><span class="org-block-end-line">#+END_SRC
</span>


(org-next-visible-heading 1)

<span class="org-level-1">* </span><span class="org-level-1"><span class="org-todo"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span><span class="org-level-1"> Misc                                                        </span><span class="org-level-1"><span class="org-tag">:noexport:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Misc</span>
<span class="org-drawer">:END:</span>
<span class="hl-todo"><span class="custom-14">TODO</span></span>: Add #+date when publishing, otherwise order's are all wonky.

<span class="hl-todo"><span class="custom-14">TODO</span></span>:
Find-replace all px with percentages, then ensure things look good!

<span class="org-hide">*</span><span class="org-level-2">* Magit and large HTML files</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Magit-and-large-HTML-files</span>
<span class="org-drawer">:END:</span>
Since I'm producing <span class="italic">massive</span> HTML files for each post, trying to review changes with the default Magit buffer <span class="italic">which shows
all changes in the repository</span> can be painfully slow. As such, when I'm blogging, let's change my <span class="org-code">C-x g</span> binding from
<span class="custom-button"><a href="doc:magit-status">doc:magit-status</a></span> to <span class="custom-button"><a href="doc:magit-file-dispatch">doc:magit-file-dispatch</a></span>, which just narrow's Magit's view to the file I'm currently working with:
<span class="org-code">C-x g D u</span> to see the &#8220;u&#8221;nstaged &#8220;d&#8221;ifferences for the file, then stage what I like with <span class="org-code">s</span>, then <span class="org-code">C-x g c</span> to &#8220;c&#8221;ommit whatever differences I have staged.
<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">bind-key</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"C-x g"</span></span><span class="org-block"> #'magit-file-dispatch)
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">*</span><span class="org-level-2">* Column Width</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Column-Width</span>
<span class="org-drawer">:END:</span>
When blogging, I see live HTML previews whenever I save thanks to
<span class="custom-button"><a href="doc:blog/preview">doc:blog/preview</a></span>.  As such, I cannot have my lines being too wide. I'll settle
for a modest 80 columns.  Then <span class="custom-13"><a href="kbd:M-q">kbd:M-q</a></span> will format my paragraphs to wrap nicely
into this 80-column width.
<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq-default</span></span><span class="org-block"> fill-column 80)
</span><span class="org-block-end-line">#+end_src
</span>
(When I'm coding with a single open window, I usually use a comfortable 120 columns.)

<span class="org-hide">*</span><span class="org-level-2">* Required loads</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Clean-this-section-up</span>
<span class="org-drawer">:END:</span>
<span class="org-block-begin-line">#+begin_src emacs-lisp :exports none
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">cl-lib </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">was published</span></span></span><span class="org-block"><span class="comment"> as a better (namespaced!) alternative to cl, which has a deprecation warning in Emacs27.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Yet </span></span><span class="org-block"><span class="comment"><span class="writegood-weasels">some</span></span></span><span class="org-block"><span class="comment"> old pacakges require cl, and so the below setq silences the deprecation warning.
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> byte-compile-warnings '(cl-functions))
(</span><span class="org-block"><span class="keyword">require</span></span><span class="org-block"> '</span><span class="org-block"><span class="constant">cl-lib</span></span><span class="org-block">) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">to get loop instead of cl-loop, etc.
</span></span><span class="org-block">
(</span><span class="org-block"><span class="keyword">require</span></span><span class="org-block"> '</span><span class="org-block"><span class="constant">shortdoc</span></span><span class="org-block">) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Essentially "tldr" but for Emacs Lisp!
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(cl-defun define-short-documentation-group (&amp;rest _))
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(cl-defun org-duration-to-minutes (&amp;rest _) )
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(cl-defun org-id-find-id-file (&amp;rest _))
</span></span><span class="org-block">
(</span><span class="org-block"><span class="keyword">ignore-errors</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">use-package</span></span><span class="org-block"> org-preview-html)
  (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-preview-html-viewer 'xwidget)
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(xwidget-webkit-browse-url "<a href="https://github.com/adithyaov/helm-org-static-blog">https://github.com/adithyaov/helm-org-static-blog</a>")
</span></span><span class="org-block">  (advice-add #'xwidget-webkit-browse-url </span><span class="org-block"><span class="builtin">:before</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _) (doom-modeline-mode 0)))
  (advice-add #'xwidget-webkit-browse-url </span><span class="org-block"><span class="builtin">:after</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _) (</span><span class="org-block"><span class="keyword">--map</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">with-current-buffer</span></span><span class="org-block"> it (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> mode-line-format </span><span class="org-block"><span class="string">"%b %p L%l C%c"</span></span><span class="org-block">)) (buffer-list)) ))
  (advice-add #'doom-modeline-mode </span><span class="org-block"><span class="builtin">:before</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _)  (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [kill-buffer-query-functions nil]
                                                           (mapcar #'kill-buffer (</span><span class="org-block"><span class="keyword">--filter</span></span><span class="org-block"> (s-starts-with? </span><span class="org-block"><span class="string">"*xwidget"</span></span><span class="org-block"> (buffer-name it)) (buffer-list)))
                                                           )))
  (</span><span class="org-block"><span class="keyword">use-package</span></span><span class="org-block"> org-special-block-extras)
  </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">(load-file "~/blog/AlBasmala.el")
</span></span><span class="org-block">  ) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">M-x blog/preview
</span></span><span class="org-block">
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Required for Github Actions; i.e., testing.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-14"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span></span></span><span class="org-block"><span class="comment"> Clean me!
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">quelpa-read-cache</span></span><span class="org-block"> ()) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Used somewhere, but not defined.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">See: quelpa-persistent-cache-file
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> quelpa-cache nil)

</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Eager macro-expansion failure: (void-function all-the-icons-faicon)
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Symbol&#8217;s function definition is void: all-the-icons-faicon
</span></span><span class="org-block-end-line">#+end_src
</span><span class="org-block-begin-line">#+begin_src emacs-lisp :exports none
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Error in kill-emacs-hook (org-clock-save): (void-function org-clocking-buffer)
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">org-clocking-buffer</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> Arabic Setup    </span><span class="org-level-2"><span class="org-tag">:Possibly_already_in_AlBasmala_so_just_load_that:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Arabic-Setup</span>
<span class="org-drawer">:END:</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">bind-key</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"M-x"</span></span><span class="org-block"> #'execute-extended-command)

(set-fontset-font </span><span class="org-block"><span class="string">"fontset-default"</span></span><span class="org-block"> '(#x600 . #x6ff) </span><span class="org-block"><span class="string">"Amiri Quran Colored"</span></span><span class="org-block">) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Makes all dots, hamza, diadiract marks colored!
</span></span><span class="org-block">
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Note: "arabic" input method just changes my English query keyboard into an Arabic keyboard ---useful if one's mastered touch typing in Arabic!
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">In contrast, the Perso-Arabic input method uses a system of transliteration: Ascii keys are phonetically mapped to Arabic letters.
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">bind-key*</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"M-SPC"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> () (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
   (message (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> (not current-input-method)
      (</span><span class="org-block"><span class="keyword">progn</span></span><span class="org-block"> (set-input-method </span><span class="org-block"><span class="string">"farsi-transliterate-banan"</span></span><span class="org-block"> t) </span><span class="org-block"><span class="string">"Perso-Arabic! Hint: M-x describe-input-method"</span></span><span class="org-block">)
      (</span><span class="org-block"><span class="keyword">progn</span></span><span class="org-block"> (set-input-method nil) </span><span class="org-block"><span class="string">"English!"</span></span><span class="org-block">)))))


</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Press C-q on a word to quote it with nice unicode quotes.
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">bind-key*</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"C-q"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> () (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">) (insert (format </span><span class="org-block"><span class="string">"&#8220;%s&#8221;"</span></span><span class="org-block"> (thing-at-point 'word))) (kill-word 1)))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">**</span><span class="org-level-3">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-3"> [HERE TODAY] Rndm</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-HERE-TODAY-Rndm</span>
<span class="org-drawer">:END:</span>

    ;; After startup, if Emacs is idle for 10 seconds, then open my work file;
    ;; which is a GPG file and so requires passphrase before other things can load.
    ;; (run-with-idle-timer 10 nil (lambda () (find-file "~/Desktop/work.org.gpg")))



;; <span class="hl-todo"><span class="custom-12">NOTE</span></span>: Will not work when doom-modeline <span class="writegood-passive-voice">is enabled</span>!
;; (xwidget-webkit-browse-url  "<span class="org-link"><a href="https://www.reddit.com/r/emacs/">https://www.reddit.com/r/emacs/</a></span>")


;; Press C-q on a word to quote it with nice unicode quotes.
(bind-key* "C-q" (lambda () (interactive) (insert (format "&#8220;%s&#8221;" (thing-at-point 'word))) (kill-word 1)))


(load-file "~/blog/AlBasmala.el")

<span class="org-block-begin-line">#+begin_src emacs-lisp :exports code
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">org-deflink</span></span><span class="org-block"> card
 </span><span class="org-block"><span class="string">"Show one of 6 hardcoded phrases as a small inline image."</span></span><span class="org-block">
 (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [url
        (</span><span class="org-block"><span class="keyword">pcase</span></span><span class="org-block"> o-label
          (</span><span class="org-block"><span class="string">"Let's take a break"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-19.png">https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-19.png</a>"</span></span><span class="org-block">)
          (</span><span class="org-block"><span class="string">"Yes"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-20.png">https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-20.png</a>"</span></span><span class="org-block">)
          (</span><span class="org-block"><span class="string">"No"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-21.png">https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-21.png</a>"</span></span><span class="org-block">)
          (</span><span class="org-block"><span class="string">"Agree"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-22.png">https://i0.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-22.png</a>"</span></span><span class="org-block">)
          (</span><span class="org-block"><span class="string">"Disagree"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-23.png">https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-23.png</a>"</span></span><span class="org-block">)
          (</span><span class="org-block"><span class="string">"I have a question"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"<a href="https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-35.png">https://i1.wp.com/oerabic.llc.ed.ac.uk/wp-content/uploads/2020/09/Visual-Communication-Signs-IRAQI-35.png</a>"</span></span><span class="org-block">))]
   (format </span><span class="org-block"><span class="string">"&lt;a href=\"%s\" class=\"tooltip\" title=\"%s\"&gt;&lt;img src=\"%s\" height=50&gt;&lt;/a&gt;"</span></span><span class="org-block"> url o-label url)))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-level-1">* </span><span class="org-level-1"><span class="org-todo"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span><span class="org-level-1"> </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1"> Glossary Library of Arabic Linguistic Jargon</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Glossary-Library-of-Arabic-Linguistic-Jargon</span>
<span class="org-drawer">:END:</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">See: <a href="http://alhassy.com/org-special-block-extras/#Tooltips-for-Glossaries-Dictionaries-and-Documentation">http://alhassy.com/org-special-block-extras/#Tooltips-for-Glossaries-Dictionaries-and-Documentation</a>
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">My personal documentation library can </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">be seen</span></span></span><span class="org-block"><span class="comment"> <a href="https://alhassy.github.io/org-special-block-extras/documentation.html">[[https://alhassy.github.io/org-special-block-extras/documentation.html][here]]</a>
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">push</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"~/blog/posts/arabic-glossary.org"</span></span><span class="org-block"> org-docs-libraries)
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-level-1">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1"> Presentation Order</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Presentation-Order</span>
<span class="org-drawer">:END:</span>
We start off with
1. the styling I'd like to have,
2. then move on to grouping those styles togther,
3. then making that result practical to use anywhere via a new Org-mode link, namely <span class="custom-button"><a href="doc:blog">doc:blog</a></span>,
4. then doing this blog-link injection seemlessly/automatically.
5. Wrapping all of this up into a nice "article preview" background function.
6. Finally, hooking this stuff up into the org-static-blog setup.
   - Which I use since it provides me with a nice index.html to showcase my posts,
     a tagging mechanism, an RSS mechanism, etc.

<span class="org-level-1">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1"> Preview </span><span class="org-level-1"><span class="org-tag">:move_to_init:Mention_in_AlBasmala:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Preview</span>
<span class="org-drawer">:END:</span>
<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Nearly instanteous preview: Just Save and it'll rebuild, and pop-up the preview to the side!
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-preview-html-viewer 'xwidget)
(org-preview-html-mode) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-14"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span></span></span><span class="org-block"><span class="comment">. Need to advise this to turn off doom-modeline first!
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Why? Since xwidget does not work well with doom-modeline.
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="org-block">. Something in my init.el breaks this package!?!
</span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Mention this in my AlBasmala.org as a way to preview my articles ^_^
</span></span><span class="org-block">
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Turn off doom-modeline when previewing.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(advice-add #'org-preview-html-mode :before (lambda (&amp;rest _) (doom-modeline-mode 0)))
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The following suffices.
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">(xwidget-webkit-browse-url </span><span class="org-block"><span class="string">"<a href="https://github.com/adithyaov/helm-org-static-blog">https://github.com/adithyaov/helm-org-static-blog</a>"</span></span><span class="org-block">)
(advice-add #'xwidget-webkit-browse-url </span><span class="org-block"><span class="builtin">:before</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _) (doom-modeline-mode 0)))
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Make the modeline minimal, otherwise it's super ugly.
</span></span><span class="org-block">(advice-add #'xwidget-webkit-browse-url </span><span class="org-block"><span class="builtin">:after</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _) (</span><span class="org-block"><span class="keyword">--map</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">with-current-buffer</span></span><span class="org-block"> it (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> mode-line-format </span><span class="org-block"><span class="string">"%b %p L%l C%c"</span></span><span class="org-block">)) (buffer-list)) ))
</span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Make an Issue on both doom-modeline github and on org-preview-html Github. Link these issues to each other.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Maybe instead make a README PRs that have the above advice-add clause; I think that might be best ---along with MWE init.el in the PR description to justify these additions.
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Along with a MWE init.el to substanitate my claim.
</span></span><span class="org-block">
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Conversely, when we start doom-modeline let's ensure we have no xwidget buffer lying around, otherwise Emacs will hang.
</span></span><span class="org-block">(advice-add #'doom-modeline-mode </span><span class="org-block"><span class="builtin">:before</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> _)  (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [kill-buffer-query-functions nil]
                                                              (mapcar #'kill-buffer (</span><span class="org-block"><span class="keyword">--filter</span></span><span class="org-block"> (s-starts-with? </span><span class="org-block"><span class="string">"*xwidget"</span></span><span class="org-block"> (buffer-name it)) (buffer-list)))
                                                              )))
</span><span class="org-block-end-line">#+end_src
</span><span class="org-level-1">* Why not use an existing blogging platform?</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Why-not-use-an-existing-blogging-platform</span>
<span class="org-drawer">:END:</span>
I dislike coding in any website's primitive textarea, likewise for general writing.
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-level-2"><span class="org-done"><span class="hl-todo"><span class="custom-11">DONE</span></span></span></span><span class="org-level-2"> </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"><span class="org-headline-done"> How to blog to hashnode?</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-How-to-blog-to-hashnode</span>
<span class="org-drawer">:END:</span>

+ <span class="org-list-dt">Get markup ::</span> C-<span class="writegood-duplicates">c c</span>-e C-b <span class="writegood-duplicates">h h</span>
+ <span class="org-list-dt">Copy then Paste ::</span> that into hashnode
+ <span class="org-list-dt">Profit ::</span> ^_^

Hashnode does not respect my CSS, unless I advertise/recruit for them (via their 'ambassador' program. Super lame!)

Likewise my inline JS ---a small root-meaning program--- is not honored by hashnode.

<span class="hl-todo"><span class="custom-14">TODO</span></span>. Consider moving back to my own personal blog setup?!
- But need a way to streamline <span class="bold">quick</span> article publishing!
  - My blog does provide a local-WYSIWYG: Just C-<span class="writegood-duplicates">c C</span>-e h o, or use one of those org-preview packages! &lt;3
    - I like working on my blog, so that's fun for me.
      - However, my <span class="bold">current</span> goal is to learn arabic!
        - So maybe learn arabic, then migrate back to my personal blogging platform!
<span class="org-level-1">* Typical workflow: How do I publish an article?                     </span><span class="org-level-1"><span class="org-tag">:ignore:</span></span>
<span class="org-special-keyword">CLOSED:</span> <span class="org-date">[2022-10-21 Fri 15:50]</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Typical-workflow-How-do-I-publish-an-article</span>
<span class="org-drawer">:END:</span>
<span class="comment"># </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">. ? +include: ~/.emacs.d/init.org::#Mini-tutorial-on-Org-mode</span>

<span class="org-block-begin-line">#+begin_details "Typical workflow: How do I publish an article?" :title-color red
</span><span class="org-block">1. &#8496;&#120001;&#119998;&#120008;&#120005;&#64830;(org-babel-load-file </span><span class="org-block"><span class="string">"~/blog/AlBasmala.org"</span></span><span class="org-block">)&#64831;

2. Invoke <a href="doc:blog/new-article">doc:blog/new-article</a>

   This sets up a new article based on existing tags and posts. Moreover it also does:
   1. Do M-x org-preview-html-mode
   2. Now every alteration, followed by a save <a href="kbd:C-x_C-s">kbd:C-x_C-s</a> will result in a live preview of the blog article, nearly
      instantaneous.
   # [This is part of blog/new-article; but left the instructions here as a precautionary measure]

3. Until content:
   1. Write, write, and write!
   2. <a href="kbd:C-x_C-s">kbd:C-x_C-s</a>
   3. Preview

   Consider using <a href="kbd:C-x_n_s">kbd:C-x_n_s</a>, or <a href="kbd:C-x_n_n">kbd:C-x_n_n</a>, to focus your attention on a
   particular section, thereby dramatically
   increasing the speed at which the preview renders.

4. Execute <a href="doc:blog/publish-current-article">doc:blog/publish-current-article</a> when you're done.
   - This gets the new article showing up in index, RSS, archive, and updates the tags.
5. </span><span class="org-block"><span class="hl-todo"><span class="custom-12">NOTE</span></span></span><span class="org-block">: It takes about. 20secs ~ 1min for the changes to be live on github pages.
</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-level-1">* </span><span class="org-level-1"><span class="italic">Style</span></span><span class="org-level-1">! &#10024; What do we want to </span><span class="org-level-1"><span class="writegood-passive-voice">be inserted</span></span><span class="org-level-1"> into the head of every page?</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">HTML-Header</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;the-html-header&gt;&gt;</span>

For each article, I'll have a set of styles loaded <span class="italic">as well as</span> a set of <span class="org-code">&lt;script&gt;</span> code fragments. Here is an overview of
these fragments, and throughout the rest of this article, I'll tangle code to where appropriate.

<span class="org-hide">*</span><span class="org-level-2">* Style Header Elements</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Style-Header-Elements</span>
<span class="org-drawer">:END:</span>

Firstly, we want <span class="writegood-weasels">some</span> styling rules to <span class="writegood-passive-voice">be loaded</span>.
<span class="org-block-begin-line">#+begin_src emacs-lisp -r -n :noweb-ref my-html-header :tangle no
</span><span class="org-block">(concat
</span><span class="org-block"><span class="string">"&lt;meta name=\"author\" content=\"Musa Al-hassy\"&gt;
 &lt;meta name=\"referrer\" content=\"no-referrer\"&gt;"</span></span><span class="org-block">
</span><span class="org-block"><span class="string">"&lt;link href=\"usual-org-front-matter.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;"</span></span><span class="org-block"> (ref:usualCSS)
</span><span class="org-block"><span class="string">"&lt;link href=\"org-notes-style.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;"</span></span><span class="org-block"> (ref:orgNotesCSS)
</span><span class="org-block"><span class="string">"&lt;link href=\"floating-toc.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;"</span></span><span class="org-block"> (ref:tocCSS)
</span><span class="org-block"><span class="string">"&lt;link href=\"blog-banner.css\" rel=\"stylesheet\" type=\"text/css\" /&gt;"</span></span><span class="org-block"> (ref:bannerCSS)
</span><span class="org-block"><span class="string">"&lt;link rel=\"icon\" href=\"images/favicon.png\"&gt;"</span></span><span class="org-block">)
</span><span class="org-block-end-line">#+end_src
</span>
+ <span class="org-link"><span class="org-list-dt"><a href="(usualCSS)">usual-org-front-matter.css</a></span></span><span class="org-list-dt"> <a href="badge:||success|usual-org-front-matter.css|css3">badge:||success|usual-org-front-matter.css|css3</a> ::</span>
  Org-static-blog ignores any styling exported by Org, so let's bring that back
  in. I just exported this file with the usual <span class="custom-10"><a href="kbd:C-c_C-e_h_o">kbd:C-c_C-e_h_o</a></span>, then saved the CSS
  it produced.

+ <span class="org-link"><span class="org-list-dt"><a href="(orgNotesCSS)">org-notes-style.css</a></span></span><span class="org-list-dt"> <a href="badge:||success|org-notes-style.css|css3">badge:||success|org-notes-style.css|css3</a> ::</span>

  I like the rose-style of this <span class="org-link"><a href="http://taopeng.me/org-notes-style/">org-notes-style</a></span> for HTML export.  However, it
  seems loading the CSS directly from its homepage does not work, so I've copied
  the CSS file for my blog.

+ <span class="org-link"><span class="org-list-dt"><a href="(tocCSS)">floating-toc.css</a></span></span><span class="org-list-dt"> <a href="badge:||success|floating-toc.css|css3">badge:||success|floating-toc.css|css3</a> ::</span>

  I want to have an unobtrusive floating table of contents, see
  &#167;<span class="org-link"><a href="floating-toc">floating-toc</a></span>.

+ <span class="org-link"><span class="org-list-dt"><a href="(bannerCSS)">blog-banner.css</a></span></span><span class="org-list-dt"> <a href="badge:||success|blog-banner.css|css3">badge:||success|blog-banner.css|css3</a> ::</span>

  Finally, we want a beautiful welcome mat, see &#167;<span class="org-link"><a href="blog-banner">blog-banner</a></span>.

<span class="org-hide">*</span><span class="org-level-2">* Script Header Elements</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Script-Header-Elements</span>
<span class="org-drawer">:END:</span>
In addition, we have two more pieces we would like to add to the header: Support
for <span class="italic">dynamic</span> code-line highlighting, &#167;<span class="org-link"><a href="blog-banner">blog-banner</a></span>, and support for using
LaTeX-style notation to write mathematics, &#167;<span class="org-link"><a href="MathJax-Support">MathJax-Support</a></span>.  We will use a
<span class="org-link"><a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like">noweb-ref</a></span> named <span class="org-verbatim">my-html-header</span> to refer to them, which are then catenated below.
<span class="org-block-begin-line">#+begin_details "Full, tangled, value of org-static-blog-page-header"
</span><span class="org-block">#+begin_src emacs-lisp -r :noweb yes :results raw -n
 (setq org-static-blog-page-header
  (concat
   org-html-head-extra  ;; Altered by &#8216;org-special-block-extras&#8217;
   &lt;&lt;my-html-header&gt;&gt;
   ))
#+end_src
# Using &#8220;html-header&#8221; as the noweb-ref caused the entirrity of the source
# block, along with the #+begin&#8230;#+end to </span><span class="org-block"><span class="writegood-passive-voice">be included</span></span><span class="org-block">.

:MetaRemark_about_above_lisp:
The noweb-ref invocation l &lt;&lt;&#120013;&#120008;&gt;&gt; r expands into
#+begin_src emacs-lisp :tangle no :noeval
l &#120013;&#8320; r
l &#120013;&#8321; r
  &#8942;
l &#120013;&#8345; r
#+end_src
Where the &#120013;&#7522; are the lines referenced by &#120013;&#120008;.

As such, we had our reference call, above, in its own line!
:End:
</span><span class="org-block-end-line">#+end_details
</span><span class="org-hide">*</span><span class="org-level-2">* Lisp Header Elements</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Lisp-Header-Elements</span>
<span class="org-drawer">:END:</span>

<span class="writegood-weasels">Some</span> Lisp code <span class="writegood-passive-voice">is required</span> to string everything together.
+ Lisp fragments <span class="writegood-passive-voice">are tangled</span> to <span class="org-link"><a href="https://alhassy.com/AlBasmala.el">AlBasmala.el</a></span>.

<span class="org-level-1">* </span><span class="org-level-1"><span class="italic">Seamlessly</span></span><span class="org-level-1"> Previewing Articles </span><span class="org-level-1"><span class="italic">within</span></span><span class="org-level-1"> Emacs &#128562;</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Seamlessly-Previewing-Articles-within-Emacs</span>
<span class="org-drawer">:END:</span>

The following makes it so that my blog style <span class="writegood-passive-voice">is appended</span> to my org files.

As outlined above, I'd like to add <span class="italic">styles</span> and things, and so I'd like a nonintrusive way to preview what I write.
+ I'd like to have all of my styles <span class="italic">automatically</span> loaded in the right places.
+ Have my article image and abstract rendered.
+ See the resulting webpage in a JavaScript-supported browser <span class="italic">within</span> Emacs.
+ All of this is to happen whenever I <span class="italic">save</span>, <span class="custom-13"><a href="kbd:C-x_C-s">kbd:C-x_C-s</a></span>.

We accomplish these goals in stages.
<span class="org-hide">*</span><span class="org-level-2">* Using My Blog Styles Anywhere: </span><span class="org-level-2"><span class="custom-button"><a href="doc:org-link/blog">doc:org-link/blo</a><a href="doc:org-link/blog">g</a></span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">HTML-Postamble</span>
  <span class="org-drawer">:END:</span>

<span class="comment">#  </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">: For the footer, we want ~<a href="blog:footer|src|history">blog:footer|src|history</a>~ where ~src~ is Boolean to</span>
<span class="comment">#  indicate generating the *.org.html file and ~history~ is the relevant repo.</span>
<span class="comment">#</span>
<span class="comment"># Low priority.</span>

In any Org-mode file ---including random ones that are not even for my blog--- I'll use the Org links <span class="org-code"><a href="blog:header">blog:header</a></span> and
<span class="org-code"><a href="blog:footer">blog:footer</a></span> to obtain the nice styling of my blog.

<span class="org-block-begin-line">#+begin_details "Definition of &#8220;<a href="blog:&#119987;&#119988;&#119989;">blog:&#119987;&#119988;&#119989;</a>&#8221; link"
</span><span class="org-block">This is a minor alteration from the examples within the docstring of <a href="doc:org-deflink">doc:org-deflink</a>.
#+begin_src emacs-lisp :exports code
(org-deflink blog
  "Provide the styles for &#8220;www.alhassy.com&#8221;'s &#8220;header&#8221; and &#8220;footer&#8221;.

The use of &#8220;<a href="blog:footer">blog:footer</a>&#8221; aims to provide a clickable list of tags, produce an HTMLized version of the Org source,
and provides a Disqus comments sections. For details, consult the `org-static-blog-post-postamble' function.

Finally, I want to avoid any `@@backend:...@@' from appearing in the browser frame's title.
We accomplish this with the help of </span><span class="org-block"><span class="writegood-weasels">some</span></span><span class="org-block"> handy-dandy JavaScript: Just use &#8220;<a href="blog:sanitise-title">blog:sanitise-title</a>&#8221;.
"
      (pcase o-label
        ("header" (concat
                   org-static-blog-page-preamble
                   org-static-blog-page-header
                   "&lt;link href=\"<a href="https://alhassy.github.io/org-notes-style.css">https://alhassy.github.io/org-notes-style.css</a>\" rel=\"stylesheet\" type=\"text/css\" /&gt;"
                   "&lt;link href=\"<a href="https://alhassy.github.io/floating-toc.css">https://alhassy.github.io/floating-toc.css</a>\" rel=\"stylesheet\" type=\"text/css\" /&gt;"
                   "&lt;link href=\"<a href="https://alhassy.github.io/blog-banner.css">https://alhassy.github.io/blog-banner.css</a>\" rel=\"stylesheet\" type=\"text/css\" /&gt;"
                   ;; The use of the &#8220;post-title&#8221; class is so that the org-static-blog-assemble-rss method can work as intended.
                   (thread-last (org-static-blog-get-title (buffer-file-name))
                                (s-replace-regexp "@@html:" "")
                                (s-replace-regexp "@@" "")
                                (format "&lt;br&gt;&lt;center&gt;&lt;h1 class=\"post-title\"&gt;%s&lt;/h1&gt;&lt;/center&gt;"))))
        ("footer" (org-static-blog-post-postamble (buffer-file-name)))
        ("sanitise-title" "&lt;script&gt; window.parent.document.title =  window.parent.document.title.replace(@@.*@@, \"\") &lt;/script&gt;")
        (_ "")))
#+end_src

See also: <a href="http://alhassy.com/org-special-block-extras/#Links">[[http://alhassy.com/org-special-block-extras/#Links][How do I make a new Org link type?]]</a>
</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-hide">*</span><span class="org-level-2">* &#160; </span><span class="org-level-2"><span class="org-code">blog/style-setup</span></span><span class="org-level-2">: A function to insert </span><span class="org-level-2"><span class="custom-button"><a href="doc:org-link/blog">doc:org-link/blo</a><a href="doc:org-link/blog">g</a></span></span><span class="org-level-2"> into a buffer</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">A-function-to-insert-doc-org-link-blog-into-a-buffer</span>
<span class="org-drawer">:END:</span>






<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/style-setup</span></span><span class="org-block"> (_backend)
  </span><span class="org-block"><span class="doc">"Insert blog header (fancy title), tags, blog image (before &#8220;* Abstract&#8221;), and footer (links to tags).

There are default options: TOC is at 2 levels, no classic Org HTML postamble nor drawers </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">are shown</span></span></span><span class="org-block"><span class="doc">.
Notice that if you explicitly provide options to change the toc, date, or show drawers, etc;
then your options will </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">be honoured</span></span></span><span class="org-block"><span class="doc">. (Since they will technically come /after/ the default options,
which I place below at the top of the page.)
"</span></span><span class="org-block">
    (goto-char (point-min))
    (insert </span><span class="org-block"><span class="string">"#+options: toc:2 html-postamble:nil d:nil"</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"\n#+date: "</span></span><span class="org-block"> (format-time-string </span><span class="org-block"><span class="string">"%Y-%m-%d"</span></span><span class="org-block"> (current-time))
            (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> (buffer-narrowed-p) </span><span class="org-block"><span class="string">"\n#+options: broken-links:t"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">""</span></span><span class="org-block">)
            </span><span class="org-block"><span class="string">"\n <a href="blog:header">blog:header</a> <a href="blog:sanitise-title">blog:sanitise-title</a> \n"</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"\n* Tags, then Image :ignore:"</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"\n#+html: "</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"&lt;center&gt;"</span></span><span class="org-block">
            (blog/tags-of-file (buffer-file-name))
            </span><span class="org-block"><span class="string">"&lt;/center&gt;"</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"\n#+html: "</span></span><span class="org-block">
            (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [art (buffer-file-name)]
              </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Need this conditional since AlBasmala lives in ~/blog whereas usually articles live in ~/blog/posts.
</span></span><span class="org-block">              </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-14"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span></span></span><span class="org-block"><span class="comment">: Consider just making AlBasmala live in ~/blog/posts, I don't think there's any real reason for breaking consistency.
</span></span><span class="org-block">              (</span><span class="org-block"><span class="keyword">thread-last</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> (equal (f-base art) </span><span class="org-block"><span class="string">"AlBasmala"</span></span><span class="org-block">) </span><span class="org-block"><span class="string">"./images/"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"../images/"</span></span><span class="org-block">)
                           (my/org-static-blog-assemble-image art)
                           s-collapse-whitespace))
            </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block">)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">It seems I have essentially 3 different ways to handle things: Preview, Publish, Index. Consider brining those closer
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">together. If I decided to switch to the org-static-blog-publish-file approach, then I would need to
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">explicitly write #+begin_abstract...#+end_abstract, due to how I've defined
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">org-static-blog-post-preamble. (See also org-static-blog-assemble-multipost-page for how I handle the abstract there.)
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Wrap contents of &#8220;* Abstract&#8221; section in the &#8220;abstract&#8221; Org-special-block
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(In case we </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">are narrowed</span></span></span><span class="org-block"><span class="comment">, we only act when we can find the Abstract.)
</span></span><span class="org-block">
    (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> (re-search-forward </span><span class="org-block"><span class="string">"^</span></span><span class="org-block"><span class="string"><span class="warning">\</span></span></span><span class="org-block"><span class="string">* Abstract"</span></span><span class="org-block"> nil t)
      (beginning-of-line)
      (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [start (point)]
        (org-narrow-to-subtree)
        (org-show-entry)
        (re-search-forward </span><span class="org-block"><span class="string">"^ * :END:"</span></span><span class="org-block"> nil t) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Ignore :PROPERTIES: drawer, if any.
</span></span><span class="org-block">        (forward-line)
        (insert </span><span class="org-block"><span class="string">"\n#+begin_abstract\n"</span></span><span class="org-block">)
        (call-interactively #'org-forward-heading-same-level)
        </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">In case there is no next section, just go to end of file.
</span></span><span class="org-block">        (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> (equal start (point)) (goto-char (point-max)))
        (insert </span><span class="org-block"><span class="string">"\n#+end_abstract\n"</span></span><span class="org-block">)
        (widen)))

    (goto-char (point-max))
    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The Org file's title is already shown via <a href="blog:header">blog:header</a>, above, so we disable it in the preview.
</span></span><span class="org-block">    (insert (format </span><span class="org-block"><span class="string">"\n* footer :ignore: \n <a href="blog:footer">blog:footer</a> \n #+options: title:nil \n"</span></span><span class="org-block">)))
</span><span class="org-block-end-line">#+end_src
</span>
Note: <span class="custom-button"><a href="doc:my/org-static-blog-assemble-image">doc:my/org-static-blog-assemble-image</a></span> <span class="writegood-passive-voice">is defined</span> later on in this article.
<span class="org-hide">*</span><span class="org-level-2">* Inserting </span><span class="org-level-2"><span class="custom-button"><a href="doc:org-link/blog">doc:org-link/blo</a><a href="doc:org-link/blog">g</a></span></span><span class="org-level-2"> </span><span class="org-level-2"><span class="italic">seamlessly</span></span><span class="org-level-2"> via the export process; </span><span class="org-level-2"><span class="italic">then</span></span><span class="org-level-2"> preview with every save</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Inserting-doc-org-link-blog-seamlessly-via-the-export-process-then-preview-with-every-save</span>
<span class="org-drawer">:END:</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/preview</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"Enable preview-on-save, and add blog/style-setup from Org's export hook."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Let's ensure we have no xwidget buffer lying around, otherwise Emacs might hang.
</span></span><span class="org-block">  (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [kill-buffer-query-functions nil]
    (mapcar #'kill-buffer (</span><span class="org-block"><span class="keyword">--filter</span></span><span class="org-block"> (equal 'xwidget-webkit-mode (buffer-local-value 'major-mode it)) (buffer-list))))
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Inserting <a href="doc:org-link/blog">doc:org-link/blog</a> /seamlessly/ via the export process
</span></span><span class="org-block">  (add-hook 'org-export-before-processing-hook  #'blog/style-setup)
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Preview with every save
</span></span><span class="org-block">  (org-preview-html-mode))

(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/preview/disable</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"Disable preview-on-save, and remove blog/style-setup from Org's export hook."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
  (remove-hook 'org-export-before-processing-hook #'blog/style-setup)
  (org-preview-html-mode -1))
</span><span class="org-block-end-line">#+end_src
</span>
Upon a save, <span class="custom-13"><a href="kbd:C-x_C-s">kbd:C-x_C-s</a></span>, a new HTML file <span class="writegood-passive-voice">is created</span> ---bearing the same name as the Org file. It seems an <span class="italic">incremental</span>
export <span class="writegood-passive-voice">is performed</span> and so this is rather fast ---at least much faster than manually invoking <span class="custom-10"><a href="kbd:C-c_C-e_h_o">kbd:C-c_C-e_h_o</a></span>.

<span class="org-hide">*</span><span class="org-level-2">* Abstract Special Block                   </span><span class="org-level-2"><span class="org-tag">:Relocate_near_blog_setup:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Abstract-Special-Block</span>
<span class="org-drawer">:END:</span>
<span class="org-block-begin-line">#+begin_details "The above &#8220;Abstract&#8221; is an Org-mode Special Block" :title-color "orange"
</span><span class="org-block">Below is an alteration from the examples of the docstring of <a href="doc:org-defblock">doc:org-defblock</a>.
#+begin_src emacs-lisp
(org-defblock abstract (main) nil
  "Render a block in a slightly narrowed blueish box, titled \"Abstract\".

   Supported backends: HTML. "
   (format (concat
            "&lt;div class=\"abstract\" style=\"border: 1px solid black;"
            "padding: 1%%; margin-top: 1%%; margin-bottom: 1%%;"
            "margin-right: 10%%; margin-left: 10%%; background-color: lightblue;\"&gt;"
            "&lt;center&gt; &lt;strong class=\"tooltip\""
            "title=\"What's the goal of this article?\"&gt; Abstract &lt;/strong&gt; &lt;/center&gt;"
            "%s &lt;/div&gt;")
           contents))
#+end_src
</span><span class="org-block-end-line">#+end_details
</span>
Look:
<span class="org-block-begin-line">#+begin_abstract
</span>words
<span class="org-block-end-line">#+end_abstract
</span><span class="org-level-1">* &#926;: Floating </span><span class="org-level-1"><span class="italic">Table of Contents</span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Floating-TOC</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;floating-toc&gt;&gt;</span>

I would like to have a table of contents that floats so that it is accessible to
the reader in case they want to jump elsewhere in the document quickly
---possibly going to the top of the document.

When we write <span class="org-verbatim">#+toc: headlines 2</span> in our Org, HTML export produces the following.
<span class="org-block-begin-line">#+begin_src html -n  :exports code :tangle no :noeval
</span><span class="org-block">&lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">id</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"table-of-contents"</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">h2</span></span><span class="org-block">&gt;</span><span class="org-block"><span class="underline"><span class="bold-italic">Table of Contents</span></span></span><span class="org-block">&lt;/</span><span class="org-block"><span class="function-name">h2</span></span><span class="org-block">&gt;
  &lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">id</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"text-table-of-contents"</span></span><span class="org-block">&gt;
    &lt;</span><span class="org-block"><span class="function-name">ul</span></span><span class="org-block">&gt;
      &lt;</span><span class="org-block"><span class="function-name">li</span></span><span class="org-block">&gt; section 1 &lt;/</span><span class="org-block"><span class="function-name">li</span></span><span class="org-block">&gt;
             &#8942;
      &lt;</span><span class="org-block"><span class="function-name">li</span></span><span class="org-block">&gt; section &#120003; &lt;/</span><span class="org-block"><span class="function-name">li</span></span><span class="org-block">&gt;
    &lt;/</span><span class="org-block"><span class="function-name">ul</span></span><span class="org-block">&gt;
  &lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;
&lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line">#+end_src
</span>Hence, we can style the table of contents by writing rules that target those
<span class="org-verbatim">id</span>'s. We use the following rules, adapted from <span class="org-link"><a href="https://orgmode.org/worg/">the Worg community</a></span>.
<span class="org-block-begin-line">#+begin_src css -n  :tangle ~/blog/floating-toc.css :noeval
</span><span class="org-block"><span class="comment-delimiter">/*</span></span><span class="org-block"><span class="comment">TOC inspired by <a href="https://orgmode.org/worg/">https://orgmode.org/worg/</a></span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
</span><span class="org-block"><span class="css-selector">#table-of-contents</span></span><span class="org-block"> {
    </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Place the toc in the top right corner</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
    </span><span class="org-block"><span class="css-property">position</span></span><span class="org-block">: fixed; </span><span class="org-block"><span class="css-property">right</span></span><span class="org-block">: 0em; </span><span class="org-block"><span class="css-property">top</span></span><span class="org-block">: 0em;
    </span><span class="org-block"><span class="css-property">margin-top</span></span><span class="org-block">: 120px; </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">offset from the top of the screen</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">

    </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">It shrinks and grows as necessary</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
    </span><span class="org-block"><span class="css-property">padding</span></span><span class="org-block">: 0em </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-property">width</span></span><span class="org-block">: auto </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-property">min-width</span></span><span class="org-block">: auto </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;

    </span><span class="org-block"><span class="css-property">font-size</span></span><span class="org-block">: 10pt;
    </span><span class="org-block"><span class="css-property">background</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-9">white</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-property">line-height</span></span><span class="org-block">: 12pt;
    </span><span class="org-block"><span class="css-property">text-align</span></span><span class="org-block">: right;

    </span><span class="org-block"><span class="css-property">box-shadow</span></span><span class="org-block">: </span><span class="org-block"><span class="writegood-duplicates">0 0</span></span><span class="org-block"> 1em </span><span class="org-block"><span class="custom-8">#777777</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-proprietary-property">-webkit-box-shadow</span></span><span class="org-block">: </span><span class="org-block"><span class="writegood-duplicates">0 0</span></span><span class="org-block"> 1em </span><span class="org-block"><span class="custom-8">#777777</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-proprietary-property">-moz-box-shadow</span></span><span class="org-block">: </span><span class="org-block"><span class="writegood-duplicates">0 0</span></span><span class="org-block"> 1em </span><span class="org-block"><span class="custom-8">#777777</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-proprietary-property">-webkit-border-bottom-left-radius</span></span><span class="org-block">: 5px;
    </span><span class="org-block"><span class="css-proprietary-property">-moz-border-radius-bottomleft</span></span><span class="org-block">: 5px;

    </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Ensure doesn't flow off the screen when expanded</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
    </span><span class="org-block"><span class="css-property">max-height</span></span><span class="org-block">: 80%;
    </span><span class="org-block"><span class="css-property">overflow</span></span><span class="org-block">: auto;}

</span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">How big is the text &#8220;Table of Contents&#8221; and space around it</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
</span><span class="org-block"><span class="css-selector">#table-of-contents h2</span></span><span class="org-block"> {
    </span><span class="org-block"><span class="css-property">font-size</span></span><span class="org-block">: 13pt;
    </span><span class="org-block"><span class="css-property">max-width</span></span><span class="org-block">: 9em;
    </span><span class="org-block"><span class="css-property">border</span></span><span class="org-block">: 0;
    </span><span class="org-block"><span class="css-property">font-weight</span></span><span class="org-block">: normal;
    </span><span class="org-block"><span class="css-property">padding-left</span></span><span class="org-block">: 0.5em;
    </span><span class="org-block"><span class="css-property">padding-right</span></span><span class="org-block">: 0.5em;
    </span><span class="org-block"><span class="css-property">padding-top</span></span><span class="org-block">: 0.05em;
    </span><span class="org-block"><span class="css-property">padding-bottom</span></span><span class="org-block">: 0.05em; }

</span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Intially have the TOC folded up; show it if the mouse hovers it</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
</span><span class="org-block"><span class="css-selector">#table-of-contents #text-table-of-contents</span></span><span class="org-block"> {
    </span><span class="org-block"><span class="css-property">display</span></span><span class="org-block">: none;
    </span><span class="org-block"><span class="css-property">text-align</span></span><span class="org-block">: left; }

</span><span class="org-block"><span class="css-selector">#table-of-contents:hover #text-table-of-contents</span></span><span class="org-block"> {
    </span><span class="org-block"><span class="css-property">display</span></span><span class="org-block">: block;
    </span><span class="org-block"><span class="css-property">padding</span></span><span class="org-block">: 0.5em;
    </span><span class="org-block"><span class="css-property">margin-top</span></span><span class="org-block">: -1.5em; }
</span><span class="org-block-end-line">#+end_src
</span>
<span class="comment"># /* TOC entries, unnumbered lists, should not </span><span class="comment"><span class="writegood-passive-voice">be indented</span></span><span class="comment"> too much */</span>
<span class="comment"># #text-table-of-contents ul { padding-left: 20px }</span>

<span class="org-block-begin-line">#+begin_remark Strange
</span><span class="org-block">If I zoom in over 100% in my browser, the toc disappears until I zoom out.
</span><span class="org-block-end-line">#+end_remark
</span>
Since the table of contents floats, the phrase <span class="italic">Table of Contents</span> is rather
&#8216;in your face&#8217;, so let's use the more subtle Greek <span class="org-link"><a href="https://en.wikipedia.org/wiki/Xi_(letter)">letter</a></span> <span class="org-verbatim">&#926;</span>.
<span class="org-block-begin-line">#+begin_src emacs-lisp -n
</span><span class="org-block">(advice-add 'org-html--translate </span><span class="org-block"><span class="builtin">:before-until</span></span><span class="org-block"> 'display-toc-as-&#926;)
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(advice-remove 'org-html--translate 'display-toc-as-&#926;)
</span></span><span class="org-block">
(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">display-toc-as-&#926;</span></span><span class="org-block"> (phrase info)
  (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> (equal phrase </span><span class="org-block"><span class="string">"Table of Contents"</span></span><span class="org-block">)
    (s-collapse-whitespace
    </span><span class="org-block"><span class="string">"&#160;&lt;a href=\"javascript:window.scrollTo(0,0)\"
        style=\"color: black !important; border-bottom: none !important;\"
        class=\"tooltip\"
        title=\"Go to the top of the page\"&gt;
      &#926;
    &lt;/a&gt;&#160;"</span></span><span class="org-block">)))
</span><span class="org-block-end-line">#+end_src
</span>
How did I get here?
1. How does Org's HTML export TOCs? &#8658; <span class="custom-button"><a href="doc:org-html-toc">doc:org-html-toc</a></span>
2. Looking at its source, we see <span class="custom-button"><a href="doc:org-html--translate">doc:org-html--translate</a></span> being
   the only place mentioning the string <span class="italic">Table of Contents</span>
3. Let's advise it, with <span class="custom-button"><a href="doc:advice-add">doc:advice-add</a></span>, to return <span class="italic">&#926;</span>
   <span class="italic">only</span> on that particular input string.
4. Joy &#9829;&#8255;&#9829;

<span class="comment"># ( The Unicode whitespace &#8216;&#160;&#8217; before and after =&#926;= is to appease the <a href="clickable-headlines">clickable headlines utility</a>, below. )</span>

<span class="org-level-1">* Org Marco: &#8220;This section has been #+include'd from my init.org&#8221; </span><span class="org-level-1"><span class="org-tag">:ignore:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Org-Marco-This-section-has-been-include'd-from-my-init-org</span>
<span class="org-drawer">:END:</span>

<span class="comment"># </span><span class="comment"><span class="writegood-weasels">Some</span></span><span class="comment"> sections in this article come from my init.org.</span>
<span class="comment">#</span>
<span class="comment"># As such, the from-my-init macro </span><span class="comment"><span class="writegood-passive-voice">is used</span></span><span class="comment"> to provide a nice, small, linkable, message.</span>

<span class="comment"># Implementation below. ############################################################</span>

<span class="comment"># This CSS rule targets all images within anchors within a &lt;center&gt; that has a class named &#8220;</span><span class="comment"><span class="writegood-weasels">tiny</span></span><span class="comment">&#8221;. In particular, it's used</span>
<span class="comment"># to target badges so that they are about the same size as &lt;small&gt; text.</span>
<span class="org-meta-line">#+html: &lt;style&gt; center.</span><span class="org-meta-line"><span class="writegood-weasels">tiny</span></span><span class="org-meta-line"> a img { height: 15px } &lt;/style&gt;</span>

<span class="org-meta-line">#+macro: init <a href="badge:A_Life_Configuring|Emacs|green|https://alhassy.github.io/emacs.d|gnu-emacs">badge:A_Life_Configuring|Emacs|green|https://alhassy.github.io/emacs.d|gnu-emacs</a></span>
<span class="org-meta-line">#+macro: from-my-init-text /This section has been =#+include='d from my init.org/, {{{init}}}</span>
<span class="org-meta-line">#+macro: from-my-init @@html: &lt;center class="</span><span class="org-meta-line"><span class="writegood-weasels">tiny</span></span><span class="org-meta-line">" style="font-size: 15px"&gt;@@ {{{from-my-init-text}}} @@html: &lt;/center&gt;@@</span>

<span class="org-level-1">* Ensuring Useful HTML Anchors</span>
<span class="org-special-keyword">CLOSED:</span> <span class="org-date">[2022-10-22 Sat 22:08]</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Ensuring-Useful-HTML-Anchors</span>
  <span class="org-drawer">:END:</span>

<span class="org-macro">from-my-init</span>
<span class="org-target">&lt;&lt;ensuring-useful-html-anchors&gt;&gt;</span>
<span class="org-meta-line">#+include: "~/.emacs.d/init.org::*Ensuring Useful HTML Anchors"  :only-contents t</span>

<span class="org-level-1">* Clickable Headlines</span>
<span class="org-special-keyword">CLOSED:</span> <span class="org-date">[2022-10-22 Sat 22:08]</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Clickable-Headlines</span>
  <span class="org-drawer">:END:</span>

<span class="org-macro">from-my-init</span>
<span class="org-target">&lt;&lt;clickable-headlines&gt;&gt;</span>
<span class="org-meta-line">#+include: "~/.emacs.d/init.org::*Clickable Headlines" :only-contents t</span>

<span class="org-level-1">* Curvy Source Blocks &amp; Pink Inline</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Curvy-Source-Blocks</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;curvy-blocks&gt;&gt;</span>

The <span class="org-verbatim">border-radius</span> property defines the radius of an
element's corners, we use it to make curvy looking source blocks.
Its behaviour <span class="org-link"><a href="https://www.w3schools.com/cssref/css3_pr_border-radius.asp">changes</a></span> depending on how <span class="writegood-weasels">many</span> arguments it <span class="writegood-passive-voice">is given</span>.
- We also style the code block's label to be curvy.
- Both <span class="org-verbatim">.src</span> and <span class="org-verbatim">pre.src:before</span> <span class="writegood-passive-voice">are used</span> by Org.

<span class="org-block-begin-line">#+begin_src css -r -n :tangle ~/blog/blog-banner.css :noeval -n
</span><span class="org-block"><span class="css-selector">.src</span></span><span class="org-block"> {
  </span><span class="org-block"><span class="css-property">border</span></span><span class="org-block">: 0px </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
  </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">50px for top-left and bottom-right corners;
     20px for top-right and bottom-left cornerns.</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
  </span><span class="org-block"><span class="css-property">border-radius</span></span><span class="org-block">: 50px 20px </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
}

</span><span class="org-block"><span class="css-selector">pre.src:before</span></span><span class="org-block"> {
    </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">border: 0px !important;</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
    </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">background-color: inherit !important;</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
    </span><span class="org-block"><span class="css-property">padding</span></span><span class="org-block">: 3px </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-property">border-radius</span></span><span class="org-block">: 20px 50px </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
    </span><span class="org-block"><span class="css-property">font-weight</span></span><span class="org-block">:700
}

 </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">wrap lengthy lines for code blocks</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
 </span><span class="org-block"><span class="css-selector">pre</span></span><span class="org-block">{</span><span class="org-block"><span class="css-property">white-space</span></span><span class="org-block">:pre-wrap}

 </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Also curvy inline code with ~ &#8943; ~ and = &#8943; =</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
 </span><span class="org-block"><span class="css-selector">code</span></span><span class="org-block"> {
     </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">background: Cyan !important;</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
     </span><span class="org-block"><span class="css-property">background</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-7">pink</span></span><span class="org-block"> </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;
     </span><span class="org-block"><span class="css-property">border-radius</span></span><span class="org-block">: 7px;
     </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">border: 1px solid lightgrey; background: #FFFFE9; padding: 2px</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
 }
</span><span class="org-block-end-line">#+end_src
</span>
Code such as <span class="org-code">(= 2 (+ </span><span class="org-code"><span class="writegood-duplicates">1 1</span></span><span class="org-code">))</span> now sticks out with a cyan background &#9829;&#8255;&#9829;

<span class="org-block-begin-line">#+begin_src css :tangle ~/blog/blog-banner.css :noeval -n
</span><span class="org-block"> </span><span class="org-block"><span class="css-selector">table</span></span><span class="org-block"> {
     </span><span class="org-block"><span class="css-property">background</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-7">pink</span></span><span class="org-block">;
     </span><span class="org-block"><span class="css-property">border-radius</span></span><span class="org-block">: 10px;
     </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">width:90%</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">

     </span><span class="org-block"><span class="css-property">border-bottom</span></span><span class="org-block">: hidden;
     </span><span class="org-block"><span class="css-property">border-top</span></span><span class="org-block">: hidden;

     </span><span class="org-block"><span class="css-property">display</span></span><span class="org-block">: table </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;

     </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Put table in the center of the page, horizontally.</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
     </span><span class="org-block"><span class="css-property">margin-left</span></span><span class="org-block">:auto </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;</span><span class="org-block"><span class="css-property">margin-right</span></span><span class="org-block">:auto </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">;

     </span><span class="org-block"><span class="css-property">font-family</span></span><span class="org-block">:</span><span class="org-block"><span class="string">"Courier New"</span></span><span class="org-block">;
     </span><span class="org-block"><span class="css-property">font-size</span></span><span class="org-block">:90%;
 }

 </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Styling for &#8216;t&#8217;able &#8216;d&#8217;ata and &#8216;h&#8217;eader elements</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
 </span><span class="org-block"><span class="css-selector">th, td</span></span><span class="org-block"> {
     </span><span class="org-block"><span class="css-property">border</span></span><span class="org-block">: 0px solid </span><span class="org-block"><span class="custom-6">red</span></span><span class="org-block">;
 }
</span><span class="org-block-end-line">#+end_src
</span><span class="org-meta-line">#+caption:</span> <span class="org-block">Example table</span>
<span class="org-table">| Prime | 2^{Prime} |</span>
<span class="org-table">|-------+-----------|</span>
<span class="org-table">|  </span><span class="org-formula">&lt;c&gt;</span><span class="org-table">  |    </span><span class="org-formula">&lt;c&gt;</span><span class="org-table">    |</span>
<span class="org-table">|   1   |     2     |</span>
<span class="org-table">|   2   |     4     |</span>
<span class="org-table">|   3   |     8     |</span>
<span class="org-table">|   5   |    32     |</span>
<span class="org-table">|   7   |    128    |</span>
<span class="org-table">|  11   |   2048    |</span>
<span class="org-meta-line">#+TBLFM: $2='(expt 2 $1);N</span>

<span class="comment"># For the line wrapping, it may be useful to have</span>
<span class="comment"># =#+PROPERTY: header-args -n= at the top of the file</span>
<span class="comment"># to have all blocks displayed with line numbers.</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Table captions should be below the tables
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-html-table-caption-above nil
      org-export-latex-table-caption-above nil)
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-block-begin-line">#+begin_details "Let's show folded, details, regions with a nice greenish colour"
</span><span class="org-block">This is part of org-special-block-extras, and it's something like this:
#+begin_src css :tangle ~/blog/blog-banner.css :noeval -n
details {
  padding: 1em;
  background-color: #e5f5e5;
  * background-color: pink; *
  border-radius: 15px;
  color: hsl(157 75% 20%);
  font-size: 0.9em;
  box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;
}
#+end_src

</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-level-1">* Blog Banner and Dynamic Code Highlighting</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Blog-Banner</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;blog-banner&gt;&gt;</span>

I want to have a nice banner at the top of every page, which should link
to useful parts of my blog.
<span class="org-block-begin-line">#+begin_src emacs-lisp -n
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-page-preamble
</span><span class="org-block"><span class="string">"&lt;div class=\"header\"&gt;
  &lt;a href=\"<a href="https://alhassy.github.io/">https://alhassy.github.io/</a>\" class=\"logo\"&gt;Life &amp; Computing Science&lt;/a&gt;
  &lt;br&gt;
    &lt;a href=\"<a href="https://alhassy.github.io/AlBasmala">https://alhassy.github.io/AlBasmala</a>\"&gt;AlBasmala&lt;/a&gt;
    &lt;a href=\"<a href="https://alhassy.github.io/archive">https://alhassy.github.io/archive</a>\"&gt;Archive&lt;/a&gt;
    &lt;a href=\"<a href="https://alhassy.github.io/tags">https://alhassy.github.io/tags</a>\"&gt;Tags&lt;/a&gt;
    &lt;a href=\"<a href="https://alhassy.github.io/rss.xml">https://alhassy.github.io/rss.xml</a>\"&gt;RSS&lt;/a&gt;
    &lt;a href=\"<a href="https://alhassy.github.io/about">https://alhassy.github.io/about</a>\"&gt;About&lt;/a&gt;
&lt;/div&gt;"</span></span><span class="org-block">)
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-drawer">:Lisp_Remark:</span>
Note that we could have been needlessly more generic by using, say,
<span class="org-verbatim">(org-static-blog-get-absolute-url org-static-blog-rss-file)</span>,
instead of hardcoding the links.
<span class="org-drawer">:End:</span>
<span class="org-drawer">:Also:</span>
org-static-blog-publish-url
org-static-blog-publish-title
<span class="org-drawer">:End:</span>

I want to style it as follows:

+ Line <span class="org-link"><a href="(headerHeader)">(headerHeader)</a></span>: The banner is in a box at the top with <span class="writegood-weasels">some</span> shadowing and
  centerd text using the <span class="org-verbatim">fantasy</span> font
+ Line <span class="org-link"><a href="(headerLogo)">(headerLogo)</a></span>: The blog's title is large and bold
+ Line <span class="org-link"><a href="(headerAnchor)">(headerAnchor)</a></span>: All links in the banner are black
+ Line <span class="org-link"><a href="(headerHover)">(headerHover)</a></span>: When you hover over a link, it becomes blue

<span class="org-block-begin-line">#+begin_src css -r -n :tangle ~/blog/blog-banner.css :noeval -n
</span><span class="org-block"><span class="css-selector">.header</span></span><span class="org-block"> { (ref:headerHeader)
  </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">Try to load &#8216;fantasy&#8217; if possible, else try to load the others.</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
  </span><span class="org-block"><span class="css-property">font-family</span></span><span class="org-block">: fantasy, monospace, Times;
  </span><span class="org-block"><span class="css-property">text-align</span></span><span class="org-block">: center;
  </span><span class="org-block"><span class="css-property">overflow</span></span><span class="org-block">: hidden;
  </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">background-color: #f1f1f1 !important;</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
  </span><span class="org-block"><span class="comment-delimiter">/* </span></span><span class="org-block"><span class="comment">background: #4183c4 !important;</span></span><span class="org-block"><span class="comment-delimiter"> */</span></span><span class="org-block">
  </span><span class="org-block"><span class="css-property">padding-top</span></span><span class="org-block">: 10px;
  </span><span class="org-block"><span class="css-property">padding-bottom</span></span><span class="org-block">: 10px;
  </span><span class="org-block"><span class="css-property">box-shadow</span></span><span class="org-block">: 0 2px 10px 2px </span><span class="org-block"><span class="custom-5">rgba(0, 0, 0, 0.2)</span></span><span class="org-block">;
}

</span><span class="org-block"><span class="css-selector">.header a.logo</span></span><span class="org-block"> { (ref:headerLogo)
  </span><span class="org-block"><span class="css-property">font-size</span></span><span class="org-block">: 50px;
  </span><span class="org-block"><span class="css-property">font-weight</span></span><span class="org-block">: bold;
}

</span><span class="org-block"><span class="css-selector">.header a</span></span><span class="org-block"> { (ref:headerAnchor)
  </span><span class="org-block"><span class="css-property">color</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-5">black</span></span><span class="org-block">;
  </span><span class="org-block"><span class="css-property">padding</span></span><span class="org-block">: 12px;
  </span><span class="org-block"><span class="css-property">text-decoration</span></span><span class="org-block">: none;
  </span><span class="org-block"><span class="css-property">font-size</span></span><span class="org-block">: 18px;
}

</span><span class="org-block"><span class="css-selector">.header a:hover</span></span><span class="org-block"> { (ref:headerHover)
  </span><span class="org-block"><span class="css-property">background-color</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-4">#ddd</span></span><span class="org-block">;
  </span><span class="org-block"><span class="css-property">background-color</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-3">#fff</span></span><span class="org-block">;
  </span><span class="org-block"><span class="css-property">color</span></span><span class="org-block">: </span><span class="org-block"><span class="custom-2">#4183c4</span></span><span class="org-block">;
}
</span><span class="org-block-end-line">#+end_src
</span>
Notice that as you hover over the references, such as <span class="org-link"><a href="(headerLogo)">this</a></span>, <span class="bold">the corresponding
line of code </span><span class="bold"><span class="writegood-passive-voice">is highlighted</span></span><span class="bold">!</span> Within a <span class="org-verbatim">src</span> block, one uses the switches <span class="org-verbatim">-n -r</span>
to enable references via line numbers, then declares <span class="org-code">(ref:name)</span> on line
and refers to it by <span class="org-link"><span class="org-verbatim"><a href="(name)">[[(name)][description]]</a></span></span>. Org-mode by default styles
such highlighting.
<span class="org-block-begin-line">#+begin_details Dynamic Code Highlighting
</span><span class="org-block">#+begin_src emacs-lisp -n :noweb-ref my-html-header :tangle no
"&lt;script type=\"text/javascript\"&gt;
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code </span><span class="org-block"><span class="writegood-passive-voice">is distributed</span></span><span class="org-block"> WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
,*/
&lt;!--*--&gt;&lt;![CDATA[/*&gt;&lt;!--*
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = \"code-highlighted\";
     elem.className   = \"code-highlighted\";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
*]]&gt;*//--&gt;
&lt;/script&gt;"
#+end_src
</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-meta-line">#+html: &lt;br&gt;</span>
<span class="org-block-begin-line">#+begin_remark
</span>Before we move on, I'd like to have heavy red font for links.
# +begin_src css :tangle ~/blog/blog-banner.css :noeval -n :tangle no
HERE PLS
# +end_src
But this causes the table of contents to <span class="writegood-passive-voice">be red</span>, which I dislike &#4314;(&#3232;&#30410;&#3232;)&#4314;
<span class="org-block-end-line">#+end_remark
</span>
<span class="org-level-1">* Article Tile &amp; Image</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Images</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;Images&gt;&gt;</span>

Every article declaratively has an associated image ^_^
- Images <span class="writegood-passive-voice">are loaded</span> from the <span class="org-verbatim">~/blog/images/</span> directory, but may be explicit paths or URLs.
- If none declared, we use <span class="org-verbatim">emacs-birthday-present.png</span> :-)
<span class="org-meta-line">  #+html: &lt;center&gt; &lt;img src="<a href="http://alhassy.com/images/emacs-birthday-present.png">http://alhassy.com/images/emacs-birthday-present.png</a>" width=100 height=100&gt; &lt;/center&gt;</span>

<span class="org-block-begin-line">  #+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">my/org-static-blog-assemble-image</span></span><span class="org-block"> (file </span><span class="org-block"><span class="type">&amp;optional</span></span><span class="org-block"> explicit-image-path-prefix)
  </span><span class="org-block"><span class="doc">"Assemble the value of &#8216;#+fileimage: image width height border?&#8217; as an HTML form.

By default, the image should </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">be located</span></span></span><span class="org-block"><span class="doc"> in the top-level `</span></span><span class="org-block"><span class="doc"><span class="constant">images/</span></span></span><span class="org-block"><span class="doc">' directory.
If the image </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is located</span></span></span><span class="org-block"><span class="doc"> elsewhere, or is a URL, </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is dictated</span></span></span><span class="org-block"><span class="doc"> by the presence of a `</span></span><span class="org-block"><span class="doc"><span class="constant">/</span></span></span><span class="org-block"><span class="doc">'
in the image path.

Here are 4 example uses:

,#+fileimage: emacs-birthday-present.png
,#+fileimage: ../images/emacs-birthday-present.png
,#+fileimage: <a href="https://upload.wikimedia.org/wikipedia/en/6/64/Dora_and_Boots.jpg">https://upload.wikimedia.org/wikipedia/en/6/64/Dora_and_Boots.jpg</a> 350 300
,#+fileimage: <a href="https://unsplash.com/photos/Vc2dD4l57og">https://unsplash.com/photos/Vc2dD4l57og</a>

+ Notice that the second indicates explicit width and height.
+ (To make the first approach work with local previews,
   we need the variable EXPLICIT-IMAGE-PATH-PREFIX which </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is used</span></span></span><span class="org-block"><span class="doc"> for local previews in `</span></span><span class="org-block"><span class="doc"><span class="constant">my/blog/style-setup</span></span></span><span class="org-block"><span class="doc">'. This requires a slash at the end.)
+ The unsplash approach is specific: It shows the *main* image in the provided URL, and links to the provided URL.
"</span></span><span class="org-block">
 (</span><span class="org-block"><span class="keyword">with-temp-buffer</span></span><span class="org-block">
   (insert-file-contents file)
   (goto-char 0)
   (search-forward-regexp </span><span class="org-block"><span class="string">"^\\#\\+fileimage: </span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">(</span></span></span><span class="org-block"><span class="string">.*</span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">)</span></span></span><span class="org-block"><span class="string">"</span></span><span class="org-block"> nil t)
   (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [(image width height no-border?)
          (s-split </span><span class="org-block"><span class="string">" "</span></span><span class="org-block"> (substring-no-properties
                        (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> (match-string 1)
                            </span><span class="org-block"><span class="string">"emacs-birthday-present.png"</span></span><span class="org-block">)))]
     (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> width (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> width 350))
     (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> height (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> height 350))
     (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> no-border? (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> no-border? </span><span class="org-block"><span class="string">""</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"style=\"border: 2px solid black;\""</span></span><span class="org-block">))
     (</span><span class="org-block"><span class="keyword">cond</span></span><span class="org-block">
      ((s-contains? </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block"> image) t) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">It's a URL, or explicit path, do nothing to it.
</span></span><span class="org-block">      (explicit-image-path-prefix (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> image (format </span><span class="org-block"><span class="string">"%s%s"</span></span><span class="org-block">  explicit-image-path-prefix image)))
      ((not (s-contains? </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block"> image)) (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> image (format </span><span class="org-block"><span class="string">"images/%s"</span></span><span class="org-block"> image)))
       )

     (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [unsplash (cl-second (s-match </span><span class="org-block"><span class="string">".*unsplash.com/photos/</span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">(</span></span></span><span class="org-block"><span class="string">.*</span></span><span class="org-block"><span class="string"><span class="regexp-grouping-backslash">\\</span></span></span><span class="org-block"><span class="string"><span class="regexp-grouping-construct">)</span></span></span><span class="org-block"><span class="string">"</span></span><span class="org-block"> image))]
       (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> href (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (concat </span><span class="org-block"><span class="string">"<a href="https://unsplash.com/photos/">https://unsplash.com/photos/</a>"</span></span><span class="org-block"> unsplash) image))
       (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> title (format </span><span class="org-block"><span class="string">"Image credit &#8220;%s&#8221;"</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (concat </span><span class="org-block"><span class="string">"<a href="https://unsplash.com/photos/">https://unsplash.com/photos/</a>"</span></span><span class="org-block"> unsplash) image)))
       (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> src (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> unsplash (format </span><span class="org-block"><span class="string">"<a href="https://source.unsplash.com/%s/%sx%s">https://source.unsplash.com/%s/%sx%s</a>"</span></span><span class="org-block"> unsplash width height) image))
       (format </span><span class="org-block"><span class="string">"&lt;center&gt;&lt;a href=\"%s\" class=\"tooltip\" title=\"%s\"&gt;&lt;img src=\"%s\" alt=\"Article image\"
             %s width=\"%s\" height=\"%s\" align=\"top\"/&gt;&lt;/a&gt;&lt;/center&gt;"</span></span><span class="org-block">
             href title src no-border? width height)))))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">*</span><span class="org-level-2">* Making this work with </span><span class="org-level-2"><span class="org-verbatim">org-notes-style</span></span><span class="org-level-2"> and </span><span class="org-level-2"><span class="org-verbatim">org-static-blog</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Making-this-work-with-org-notes-style-and-org-static-blog</span>
<span class="org-drawer">:END:</span>
To make use of <span class="org-verbatim">org-notes-style</span>, I need the title to use the <span class="org-verbatim">title</span> class
but <span class="org-verbatim">org-static-blog</span> uses the <span class="org-verbatim">post-title</span> blog, so I'll override the
<span class="org-verbatim">org-static-blog</span> preamble method to <span class="writegood-weasels">simply</span> use an auxiliary div.
- Along the way, I'll position the article image under the article's title.
- Line <span class="org-link"><a href="(fixTitle)">(fixTitle)</a></span>: <span class="org-verbatim">org-notes-style</span> has too much vertical space after the title,
  let's reduce it so that the article's data can follow it smoothly.
<span class="comment"># - Line <a href="(BR)">(BR)</a>: =org-static-blog= does not support Org-markup in the title, since it</span>
<span class="comment">#  just dumps the title in-place; here I provide a support for just =&lt;br&gt;=.</span>
<span class="org-block-begin-line">#+begin_src emacs-lisp -r -n -n
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-1"><span class="hl-todo"><span class="custom-1">MA</span></span></span></span></span></span><span class="org-block"><span class="comment">: This can </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">be deleted</span></span></span><span class="org-block"><span class="comment">?? Do a search for post-title in this article to see why?
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">org-static-blog-post-preamble</span></span><span class="org-block"> (post-filename)
  </span><span class="org-block"><span class="doc">"Returns the formatted date and headline of the post.
This function </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is called</span></span></span><span class="org-block"><span class="doc"> for every post and prepended to the post body.
Modify this function if you want to change a posts headline."</span></span><span class="org-block">
  (concat
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The title
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;h1 class=\"post-title\"&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"&lt;div class=\"title\" style=\"margin: </span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">0 0</span></span></span><span class="org-block"><span class="string"> </span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">0 0</span></span></span><span class="org-block"><span class="string"> !important;\"&gt;"</span></span><span class="org-block">  (ref:fixTitle)
   </span><span class="org-block"><span class="string">"&lt;a href=\""</span></span><span class="org-block"> (org-static-blog-get-post-url post-filename) </span><span class="org-block"><span class="string">"\"&gt;"</span></span><span class="org-block">
   (org-static-blog-get-title post-filename)
   </span><span class="org-block"><span class="string">"&lt;/a&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"&lt;/h1&gt;&lt;/div&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The date
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;div style=\"text-align: center;\"&gt;"</span></span><span class="org-block">
   (format-time-string (org-static-blog-gettext 'date-format)
                       (org-static-blog-get-date post-filename))
   </span><span class="org-block"><span class="string">"&lt;/div&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The article's image
</span></span><span class="org-block">   (my/org-static-blog-assemble-image post-filename)
   </span><span class="org-block"><span class="string">"&lt;br&gt;&lt;center&gt;&lt;strong&gt;Abstract&lt;/strong&gt;&lt;/center&gt;"</span></span><span class="org-block">))
</span><span class="org-block-end-line">#+end_src
</span>

<span class="comment"># Before we move on, Org-notes adds extra whitespace after the title, let's avoid</span>
<span class="comment"># that.</span>
<span class="comment"># #+begin_src css :tangle ~/blog/blog-banner.css :noeval</span>
<span class="comment">#  .title { margin: </span><span class="comment"><span class="writegood-duplicates">0 0</span></span><span class="comment"> </span><span class="comment"><span class="writegood-duplicates">0 0</span></span><span class="comment"> !important; }</span>
<span class="comment"># #+end_src</span>

<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> unsplash link setup                         </span><span class="org-level-2"><span class="org-tag">:Leave_as_cute_remark:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-unsplash-link-setup</span>
<span class="org-drawer">:END:</span>
<span class="org-block-begin-line">#+begin_src emacs-lisp :exports code
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">If you download images, from unspash, you'll have to host them somewhere!
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">An alternative is just to provide direct links to the unsplash images themselves!
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Example usage:
</span></span><span class="org-block"><span class="comment-delimiter">;;   </span></span><span class="org-block"><span class="comment">unsplash:gySMaocSdqs
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">This shows an image along with a useful tooltip; image size is 200x200 by default.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The image is also a link, redirecting to the source, including whomever took the original photo.
</span></span><span class="org-block-end-line">#+end_src
</span>
(-let [unsplash (cl-second (s-match ".*unsplash.com/photos/\<span class="org-latex-and-related">\(.*\\)</span>" "<span class="org-link"><a href="https://unsplash.com/photos/Vc2dD4l57og">https://unsplash.com/photos/Vc2dD4l57og</a></span>"))]
(if unsplash
  (format "&lt;center&gt;&lt;a href=\"<span class="org-link"><a href="https://unsplash.com/photos/%s">https://unsplash.com/photos/%s</a></span>\" class=\"tooltip\" title=\"Photo from Unsplash\"&gt;&lt;img
src=\"<span class="org-link"><a href="https://source.unsplash.com/%s/300x300">https://source.unsplash.com/%s/300x300</a></span>\"&gt;&lt;/a&gt;&lt;/center&gt;"
<span class="writegood-duplicates">unsplash unsplash</span>)))

unsplash:XXX0GQfgMy8

<span class="org-level-1">* MathJax Support ---</span><span class="org-level-1"><span class="org-latex-and-related"> $e^{i \cdot \pi} + 1 = 0$</span></span><span class="org-latex-and-related">
</span>  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">MathJax-Support</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;MathJax-Support&gt;&gt;</span>

Org loads the <span class="org-link"><a href="https://math.meta.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference">MathJax</a></span> display engine for mathematics whenever users write LaTeX-style math delimited by <span class="org-code">$...$</span> or by
<span class="org-verbatim">\[...\]</span>. Here is an example.

<span class="org-block-begin-line">#+begin_details "The CSS that Org loads by default"
</span><span class="org-block">#+begin_src emacs-lisp -n :noweb-ref my-html-header :tangle no
"&lt;script type=\"text/x-mathjax-config\"&gt;
    MathJax.Hub.Config({
        displayAlign: \"center\",
        displayIndent: \"0em\",

        \"HTML-CSS\": { scale: 100,
                        linebreaks: { automatic: \"false\" },
                        webFont: \"TeX\"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: \"false\" },
              font: \"TeX\"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: \"AMS\"},
               MultLineWidth: \"85%\",
               TagSide: \"right\",
               TagIndent: \".8em\"
             }
});
&lt;/script&gt;
&lt;script type=\"text/javascript\"
        src=\"<a href="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML">https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML</a>\"&gt;&lt;/script&gt;
"
#+end_src
</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-meta-line">#+html: &lt;br&gt;</span>
<span class="org-block-begin-line">#+begin_org-demo
</span><span class="org-block">\[ p &#8851; q = p \quad &#8801; \quad p &#8852; q = q \label{Golden-Rule}\tag{Golden-Rule}\]

Look at \ref{Golden-Rule}, it says, when specialised to numbers, the minimum
of two items is the first precisely when the maximum of the two is the second
---d'uh!
</span><span class="org-block-end-line">#+end_org-demo
</span>
<span class="org-hide">*</span><span class="org-level-2">* Unicode Warning!</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Unicode-Warning</span>
<span class="org-drawer">:END:</span>
We can make an equation &#8496; named &#119977; and refer to it by &#8466; by declaring
<span class="org-verbatim">\[&#8496; \tag{&#119977;} \label{&#8466;} \]</span> then refer to it with <span class="org-verbatim">\ref{&#8466;}</span>.  However, if &#119977; contains
Unicode, then the reference will not generally be &#8216;clickable&#8217; ---it wont take
you to the equation's declaration site.  For example, \ref{&#8849;-Definition} (<span class="org-verbatim">&#8849;-Definition</span>) below
has Unicode in both its tag and label, and so clicking that link wont go
anywhere, whereas \ref{Order-Definition} has Unicode only in its tag, with the
label being <span class="org-verbatim">\label{Order-Definition}</span>, and clicking it takes you to the formula.

<span class="org-block-begin-line">#+begin_org-demo
</span><span class="org-block">\[ p &#8849; q \quad &#8801; \quad p &#8851; q = p \tag{&#8849;-Definition}\label{&#8849;-Definition} \]

\[ p &#8849; q \quad &#8801; \quad p &#8852; q = q \tag{&#8849;-Definition}\label{Order-Definition} \]
</span><span class="org-block-end-line">#+end_org-demo
</span>
<span class="org-hide">*</span><span class="org-level-2">* Rule Resurrection</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Rule-Resurrection</span>
<span class="org-drawer">:END:</span>
The following rule for anchors <span class="org-verbatim">a {&#8943;}</span> resurrects <span class="org-verbatim">\ref{}</span> calls via MathJax
---which <span class="org-verbatim">org-notes-style</span> kills.
<span class="org-block-begin-line">#+begin_src css :tangle ~/blog/blog-banner.css :noeval
</span><span class="org-block"><span class="css-selector">a</span></span><span class="org-block"> { </span><span class="org-block"><span class="css-property">white-space</span></span><span class="org-block">: pre </span><span class="org-block"><span class="builtin">!important</span></span><span class="org-block">; }
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-level-2"><span class="italic">Making Math Stick-out with Spacing!</span></span><span class="org-level-2">                   </span><span class="org-level-2"><span class="org-tag">:</span></span><span class="org-level-2"><span class="org-tag"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span><span class="org-level-2"><span class="org-tag">:LowPriority:</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-nice-math-spacing</span>
<span class="org-drawer">:END:</span>

<span class="org-table">| This is low priority, since I'm not writing much math these days. |</span>

Notice how the <span class="italic">math expressions</span> stick out in these following sentences:
1. We use<span class="org-latex-and-related"> $x$ </span>as the name of the unknown.
2. The phrase<span class="org-latex-and-related"> $&#8704; x &#8226; &#8707; y &#8226; x &#12308;R&#12309; y$ </span>indicates that relation<span class="org-latex-and-related"> $R$ </span>is &#8220;total&#8221;.



Nice, the following adds extra whitespace around MathJax,
so that math elements have extra whitespace about them
so as to make them stand-out.
<span class="org-meta-line">#+HTML_MATHJAX: padding: </span><span class="org-meta-line"><span class="writegood-duplicates">25px 25px</span></span>
<span class="org-meta-line">#+HTML_HEAD: &lt;script type="text/x-mathjax-config"&gt;</span>
<span class="org-meta-line">#+HTML_HEAD: MathJax.Hub.Config({</span>
<span class="org-meta-line">#+HTML_HEAD:     "HTML-CSS": {</span>
<span class="org-meta-line">#+HTML_HEAD:         styles: {</span>
<span class="org-meta-line">#+HTML_HEAD:             ".MathJax nobr": {</span>
<span class="org-meta-line">#+HTML_HEAD:                 padding: "0.5em 0.5em"</span>
<span class="org-meta-line">#+HTML_HEAD:             },</span>
<span class="org-meta-line">#+HTML_HEAD:         }</span>
<span class="org-meta-line">#+HTML_HEAD:     }</span>
<span class="org-meta-line">#+HTML_HEAD: });</span>
<span class="org-meta-line">#+HTML_HEAD: &lt;/script&gt;</span>


<span class="custom"><span class="bold"><a href="orange:TODO">orange:</a></span></span><span class="custom"><span class="bold"><span class="hl-todo"><span class="custom-14"><a href="orange:TODO">TODO</a></span></span></span></span>: Actually add the required script to the header code section of my org-static-blog configuration. <span class="bold">OR</span> add it
as CSS as <span class="writegood-passive-voice">was done</span> for the MathJax styling above. <span class="bold">OR</span> add to my MathJax.org file? Something to think about.
<span class="org-drawer">:One_route:</span>
See  <span class="org-link"><a href="the-html-header">the-html-header</a></span> above
In addition, we have two more pieces we would like to add to the header: Support
for <span class="italic">dynamic</span> code-line highlighting, &#167;<span class="org-link"><a href="blog-banner">blog-banner</a></span>, and support for using
LaTeX-style notation to write mathematics, &#167;<span class="org-link"><a href="MathJax-Support">MathJax-Support</a></span>.  We will use a
<span class="org-link"><a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like">noweb-ref</a></span> named <span class="org-verbatim">my-html-header</span> to refer to them, which are then catenated below.
<span class="org-drawer">:end:</span>
<span class="org-level-1">* Using </span><span class="org-level-1"><span class="org-link"><a href="https://github.com/bastibe/org-static-blog">org-static-bloc</a><a href="https://github.com/bastibe/org-static-blog">k</a></span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">https-github-com-bastibe-org-static-blog-org-static-block</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;initial-setup&gt;&gt;</span>

Let's use <span class="org-link"><a href="https://github.com/bastibe/org-static-blog">org-static-block</a></span> to make our blog. Why?
- It's a Lisp program smaller than 900 lines, its source is <span class="writegood-weasels">easy</span> to read and
  understand, and, most importantly, it was super <span class="writegood-weasels">easy</span> to get started using it
  using the <span class="org-link"><a href="https://github.com/bastibe/org-static-blog#examples">given example</a></span>.

<span class="org-block-begin-line">#+begin_details "The necessary basic facts of our blog"
</span><span class="org-block">  #+begin_src emacs-lisp -n :exports code
(use-package org-static-blog)
(use-package lf) ;; So we can use `lf-string' for multi-line strings supporting interpolation:
;; (lf-string "100/2 is ${ (/ 100 2) }; neato!") ;; &#8658; "100/2 is 50; neato!"

(setq org-static-blog-publish-title "Life &amp; Computing Science")
(setq org-static-blog-publish-url "<a href="https://alhassy.github.io/">https://alhassy.github.io/</a>")
(setq org-static-blog-publish-directory "~/blog/")
(setq org-static-blog-posts-directory "~/blog/posts/")
(setq org-static-blog-drafts-directory "~/blog/drafts/")

;; Use &#8220;#+filetags: &#964;&#8321; &#964;&#8322; &#8230; &#964;&#8345;&#8221;
(setq org-static-blog-enable-tags t)

;; I'd like to have tocs and numbered headings
(setq org-export-with-toc t)
(setq org-export-with-section-numbers t)
#+end_src
</span><span class="org-block-end-line">#+end_details
</span>
<span class="org-hide">*</span><span class="org-level-2">* Article Footers: HTMLized Source and Git History</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Article-Footers</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;footers&gt;&gt;</span>

Here is the main function:
<span class="org-block-begin-line">#+begin_src emacs-lisp -n
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">org-static-blog-post-postamble</span></span><span class="org-block"> (post-file-name)
  </span><span class="org-block"><span class="doc">"Returns the HTML rendering the htmlised source, version history, and comment box at the end of a post.

This function </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is called</span></span></span><span class="org-block"><span class="doc"> for every post and the returned string </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is appended</span></span></span><span class="org-block"><span class="doc"> to the post body."</span></span><span class="org-block">
  (concat
   </span><span class="org-block"><span class="string">"&lt;hr&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"&lt;center&gt;"</span></span><span class="org-block">
   (blog/htmlize-file post-file-name)
   </span><span class="org-block"><span class="string">"&amp;ensp;"</span></span><span class="org-block">
   (blog/history-of-file post-file-name)
   </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">   (blog/css/arabic-font-setup)
   </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;br&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"&lt;a href=\"<a href="https://www.buymeacoffee.com/alhassy">https://www.buymeacoffee.com/alhassy</a>\"&gt;&lt;img src="</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"\"<a href="https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee">https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee</a>\"&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">"&lt;/a&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;br&gt;&lt;strong&gt; Generated by Emacs and Org-mode (&#8226;&#768;&#7447;&#8226;&#769;)&#1608; &lt;/strong&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">org-static-blog-page-postamble
</span></span><span class="org-block">   (blog/license)
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(blog/comments) ;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-14"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span></span></span><span class="org-block"><span class="comment">. Not working as intended; low priority.
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;/center&gt;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The next line </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">is required</span></span></span><span class="org-block"><span class="comment"> to make the org-static-blog-assemble-rss method work.
</span></span><span class="org-block">   </span><span class="org-block"><span class="string">"&lt;div hidden&gt; &lt;div id=\"postamble\" class=\"status\"&gt; &lt;/div&gt; &lt;/div&gt;"</span></span><span class="org-block">
   (blog/read-remaining-js)))
</span><span class="org-block-end-line">#+end_src
</span>
Where its helper methods are below:
<span class="custom-button"><a href="doc:blog/tags-of-file">doc:blog/tags-of-file</a></span>,
<span class="custom-button"><a href="doc:blog/history-of-file">doc:blog/history-of-file</a></span>,
<span class="custom-button"><a href="doc:blog/htmlize-file">doc:blog/htmlize-file</a></span>,
<span class="custom-button"><a href="doc:blog/read-remaining-js">doc:blog/read-remaining-js</a></span>
<span class="custom-button"><a href="doc:blog/license">doc:blog/license</a></span>
<span class="custom-button"><a href="doc:blog/comments">doc:blog/comments</a></span>
<span class="org-block-begin-line">#+begin_details
</span>#+begin_src emacs-lisp
(defun blog/tags-of-file (file-name)
  "Get an HTML listing of tags, as shields.io bages, associated with the given file."
          (concat
   ;; Straightforward implementation.
   ;; "&lt;div class=\"taglist\"&gt;"
   ;; (org-static-blog-post-taglist file-name)
   ;; "&lt;/div&gt;"

  ;; Badges implementation
   (if (not file-name)
       ""
     (concat
      (format "&lt;a href=\"<span class="org-link"><a href="https://alhassy.github.io/tags.html">https://alhassy.github.io/tags.html</a></span>\"&gt; %s &lt;/a&gt;"
              (org-link/octoicon "tag" nil 'html))
      (s-join " "
              (--map  (org-link/badge
                       (format "|%s|grey|%stag-%s.html"
                               (s-replace "-" "_" it)
                               org-static-blog-publish-url it)
                       nil 'html)
                      (org-static-blog-get-tags file-name)))))))

#+end_src

#+begin_src emacs-lisp
(defun blog/history-of-file (file-name)
  "Get an HTML badge that points to the Github history of a given file name, in my blog."
  (concat
     "&lt;a class=\"tooltip\" title=\"See the <span class="writegood-weasels">various</span> edits to this article over time\""
     "href=\"<span class="org-link"><a href="https://github.com/alhassy/alhassy.github.io/commits/master/">https://github.com/alhassy/alhassy.github.io/commits/master/</a></span>"
   "posts/" (f-base file-name) ".org\"&gt;&lt;img
   src=\"<span class="org-link"><a href="https://img.shields.io/badge/-History-informational?logo=github">https://img.shields.io/badge/-History-informational?logo=github</a></span>\"&gt;&lt;/a&gt;"))
#+end_src

#+begin_src emacs-lisp
(defun blog/htmlize-file (file-name)
  "Generate an htmlized version of a given source file; return an HTML badge linking to the colourised file.

We do not take the extra time to produce a colourised file when we are previewing an article."
  (unless org-preview-html-mode
(let ((org-hide-block-startup nil))
  (with-temp-buffer
    (find-<span class="writegood-duplicates">file file</span>-name)
    ;; (insert "\n#+HTML_HEAD: &lt;link href=\"../doom-solarized-light.css\" rel=\"stylesheet\"&gt;\n")
    (org-mode)
    (outline-show-all)
    (switch-to-buffer (htmlize-buffer))
    (write-file (concat "~/blog/" (f-base file-name) ".org.html"))
    (kill-buffer))))
(concat
"&lt;a class=\"tooltip\" title=\"See the colourised Org source of this article; i.e., what I typed to get this nice webpage\" href=\""
   (f-base file-name) ".org.html\"&gt;&lt;img
   src=\"<span class="org-link"><a href="https://img.shields.io/badge/-Source-informational?logo=read-the-docs">https://img.shields.io/badge/-Source-informational?logo=read-the-docs</a></span>\"&gt;&lt;/a&gt;"))
#+end_src

# HTML Footer: Licensing &amp; Comments
<span class="org-target">&lt;&lt;Comments&gt;&gt;</span>

#+begin_src emacs-lisp
(defun blog/license ()
  "Get HTML for Creative Commons Attribution-ShareAlike 3.0 Unported License."
(s-collapse-whitespace (s-replace "\n" ""
"
&lt;center style=\"font-size: 12px\"&gt;
  &lt;a rel=\"license\" href=\"<span class="org-link"><a href="https://creativecommons.org/licenses/by-sa/3.0/">https://creativecommons.org/licenses/by-sa/3.0/</a></span>\"&gt;
     &lt;img alt=\"Creative Commons License\" style=\"border-width:0\"
          src=\"<span class="org-link"><a href="https://i.creativecommons.org/l/by-sa/3.0/88x31.png\&quot;/">https://i.creativecommons.org/l/by-sa/3.0/88x31.png\"/</a></span>&gt;
  &lt;/a&gt;

  &lt;br/&gt;
  &lt;span xmlns:dct=\"<span class="org-link"><a href="https://purl.org/dc/terms/">https://purl.org/dc/terms/</a></span>\"
        href=\"<span class="org-link"><a href="https://purl.org/dc/dcmitype/Text">https://purl.org/dc/dcmitype/Text</a></span>\"
        property=\"dct:title\" rel=\"dct:type\"&gt;
     &lt;em&gt;Life &amp; Computing Science&lt;/em&gt;
  &lt;/span&gt;

  by
  &lt;a xmlns:cc=\"<span class="org-link"><a href="https://creativecommons.org/ns">https://creativecommons.org/ns</a></span>#\"
  href=\"<span class="org-link"><a href="https://alhassy.github.io/">https://alhassy.github.io/</a></span>\"
  property=\"cc:attributionName\" rel=\"cc:attributionURL\"&gt;
    Musa Al-hassy
  &lt;/a&gt;

  <span class="writegood-passive-voice">is licensed</span> under a
  &lt;a rel=\"license\" href=\"<span class="org-link"><a href="https://creativecommons.org/licenses/by-sa/3.0/">https://creativecommons.org/licenses/by-sa/3.0/</a></span>\"&gt;
    Creative Commons Attribution-ShareAlike 3.0 Unported License
  &lt;/a&gt;
&lt;/center&gt;")))
#+end_src

#+begin_src emacs-lisp -n
(defun blog/comments ()
  "Embed Disqus Comments for my blog"
(s-collapse-whitespace (s-replace "\n" ""
"
&lt;div id=\"disqus_thread\"&gt;&lt;/div&gt;
&lt;script type=\"text/javascript\"&gt;
<span class="italic">* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * *</span>
var disqus_shortname = 'life-and-computing-science';
<span class="italic">* * * DON'T EDIT BELOW THIS LINE * * *</span>
(function() {
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
&lt;/script&gt;
&lt;noscript&gt;Please enable JavaScript to view the
    &lt;a href=\"<span class="org-link"><a href="http://disqus.com/?ref_noscript">http://disqus.com/?ref_noscript</a></span>\"&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;
&lt;a href=\"<span class="org-link"><a href="http://disqus.com">http://disqus.com</a></span>\" class=\"dsq-brlink\"&gt;comments powered by &lt;span class=\"logo-disqus\"&gt;Disqus&lt;/span&gt;&lt;/a&gt;")))
#+end_src

#+begin_src emacs-lisp
(defun blog/read-remaining-js ()
  "Get the HTML required to make use of ReadRemaining.js"

  ;; [Maybe Not True] ReadReamining.js does not work well with xWidget browser within Emacs
  (if (equal org-preview-html-viewer 'xwidget)
      ""

   ;; ReadRemaining.js &#8759; How much time <span class="writegood-passive-voice">is left</span> to finish reading this article?
   ;;
  ;; jQuery already loaded by org-special-block-extras.
  ;; "&lt;script
  ;; src=\
  ;; "<span class="org-link"><a href="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js</a></span>\"&gt;&lt;/script&gt;"
 "&lt;link rel=\"stylesheet\" href=\"readremaining.js-readremainingjs/css/rr_light.css\"
     type='text/css'/&gt;
  &lt;script
     src=\"readremaining.js-readremainingjs/src/readremaining.jquery.js\"&gt;&lt;/script&gt;
  &lt;script src='readremaining.js/src/readremaining.jquery.js'
     type='text/javascript'&gt;&lt;/script&gt;
  &lt;script type=\"text/javascript\"&gt; $('body').readRemaining({showGaugeDelay : 10,
     showGaugeOnStart : true}); &lt;/script&gt;"))
#+end_src


<span class="org-link"><a href="https://aerolab.github.io/readremaining.js/">ReadRemaining.js</a></span> gives us a little floating clock on the bottom left of the
screen which says, e.g., <span class="italic">4m 9s left</span> when reading an article.
+ It tells us how much time <span class="writegood-passive-voice">is left</span> before the article <span class="writegood-passive-voice">is done</span>.
+ The time adjusts <span class="italic">dynamically</span> as the user scrolls down ---but not up.
+ Apparently it has to be at the end of the HTML <span class="org-verbatim">&lt;body&gt;</span>, otherwise it wont work
  for me.
  - It may be best to avoid loading jQuery multiple times; see <span class="org-link"><a href="https://alhassy.github.io/org-special-block-extras/#tooltipster">here</a></span> for the necessary conditional.

<span class="org-block-end-line">#+end_details
</span>
<span class="org-block-begin-line">#+begin_remark "&#4314;(&#3232;&#30410;&#3232;)&#4314;"
</span><span class="org-block">I want to consistently use the same theme to htmlize Org source, rather than the current session's theme.
</span><span class="org-block-end-line">#+end_remark
</span>

<span class="org-hide">*</span><span class="org-level-2">* Arabic Font Setup</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Arabic-Font-Setup</span>
<span class="org-drawer">:END:</span>
I'd like <span class="italic">inline</span> Arabic to <span class="writegood-passive-voice">be displayed</span> using <span class="org-link"><a href="https://www.amirifont.org/">&#1575;&#1604;&#1582;&#1591; &#1575;&#1604;&#1575;&#1620;&#1605;&#1740;&#1585;&#1740;</a></span> since that's <span class="org-link"><a href="http://alhassy.com/arabic-roots#Arabic-Input-Setup">how it looks </a></span><span class="org-link"><span class="italic"><a href="http://alhassy.com/arabic-roots#Arabic-Input-Setup">within</a></span></span><span class="org-link"><a href="http://alhassy.com/arabic-roots#Arabic-Input-Setup"> Emacs for me.</a></span>  But, Arabic
within tables should <span class="writegood-passive-voice">be displayed</span> in a more formal font, Scheherazade, that makes it really clear where letters start
and end, and where the vowels above/below letters <span class="writegood-passive-voice">are positioned</span>.

<span class="org-block-begin-line">#+begin_details
</span>#+begin_src emacs-lisp
(defun blog/css/arabic-font-setup ()
  "Setup the CSS/HTML required to make my Arabic writing look nice.

For a one-off use in an article, just place an &#8220;#+html:&#8221; in front of the result
of this function."

  "
  &lt;link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Amiri'&gt;
  &lt;style&gt;
     body {font-family: 'Amiri', sans-serif;}
     table {font-family:  'Scheherazade'; font-size: 105%; }
   &lt;/style&gt;")
#+end_src

To understand <span class="italic">why</span> these styling rules work, see this website:
<span class="org-link"><a href="https://rtlstyling.com/posts/rtl-styling#handling-fonts">Right-to-left Styling</a></span>.
<span class="org-block-end-line">#+end_details
</span>
<span class="org-meta-line">#+html: &lt;br&gt;</span>
<span class="org-block-begin-line">#+begin_org-demo :source-color white :result-color white
</span><span class="org-block">For example,
+ Inline: &#1575;&#1607;&#1604;&#1575;&#1611; &#1608;&#1587;&#1607;&#1604;&#1575;&#1611;
+ Within a table:
    |  &#1575;&#1607;&#1604;&#1575;&#1611; &#1608;&#1587;&#1607;&#1604;&#1575;&#1611; |
</span><span class="org-block-end-line">#+end_org-demo
</span><span class="comment"># Yuck! + Inline code: =&#1575;&#1607;&#1604;&#1575;&#1611; &#1608;&#1587;&#1607;&#1604;&#1575;&#1611;=</span>

As the above left source demonstrates, unless <span class="writegood-weasels">some</span> explicit action <span class="writegood-passive-voice">is taken</span>, Arabic fonts are by default rendered
hideously small.

<span class="org-hide">*</span><span class="org-level-2">* The Index Page</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span>  <span class="org-property-value">multipost-pages</span>
  <span class="org-drawer">:END:</span>

<span class="org-target">&lt;&lt;Index&gt;&gt;</span>

<span class="comment"># The =org-static-blog-with-find-file= macro does a lot of &#8216;in your face&#8217; writing,</span>
<span class="comment"># which really ought to </span><span class="comment"><span class="writegood-passive-voice">be hidden</span></span><span class="comment"> from sight.</span>

I'd like to be able to quickly change the blurb on the index page, so we make a
variable for that ---consisting of Org-markup.
<span class="org-block-begin-line">#+begin_src emacs-lisp -n
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> index-content-header
  (concat
   </span><span class="org-block"><span class="string">"Here are </span></span><span class="org-block"><span class="string"><span class="writegood-weasels">some</span></span></span><span class="org-block"><span class="string"> of my latest thoughts..."</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">" <a href="badge:Made_with|Lisp">badge:Made_with|Lisp</a> such as <a href="doc:thread-first">doc:thread-first</a> and <a href="doc:loop">doc:loop</a> (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;"</span></span><span class="org-block">
   </span><span class="org-block"><span class="string">" <a href="tweet:https://alhassy.github.io/">tweet:https://alhassy.github.io/</a>"</span></span><span class="org-block">))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="comment"># Default.</span>
<span class="comment"># (setq org-static-blog-index-length 5)</span>

The actual look and feel of <span class="org-code">index.html</span> is due to the method <span class="custom-button"><a href="doc:org-static-blog-assemble-multipost-page">doc:org-static-blog-assemble-multipost-page</a></span>.

<span class="org-block-begin-line">#+begin_details
</span>The existing org-static-blog-assemble-index is really fast,
since it just dumps articles wholesale into the landing page; not ideal.
I'd rather have a &#8216;preview&#8217; of articles.

The index page is a multipost page, so I'll override the
<span class="org-verbatim">org-static-blog-assemble-multipost-page</span> method so that articles <span class="writegood-passive-voice">are
summarised</span> by their title, data &amp; image, &#8216;abstract&#8217;, and a read-more badge.
- Every article <span class="writegood-passive-voice">is intended</span> to have a section named <span class="org-verbatim">Abstract</span>, whose contents
  <span class="writegood-passive-voice">are used</span> as the preview of the article. See &#167;<span class="org-link"><a href="new-article">new-article</a></span> for a template.
#+begin_src emacs-lisp -n
(defun org-static-blog-assemble-multipost-page
    (pub-filename post-filenames &amp;optional front-matter)
  "Assemble a page that contains multiple posts &#8220;previews&#8221; one after another.

- Each &#8220;preview&#8221; consists of a post's title, tags, image, and abstract.
- Previews <span class="writegood-passive-voice">are sorted</span> in descending time.

You can view the generated ~/blog/index.html by invoking:
   (progn (my/blog/style-setup/disable) (org-static-blog-assemble-index))
"
  (setq show-reading-time nil) ;; Experimental.
  (setq post-filenames
        (sort post-filenames (lambda (x y)
                               (time-less-p (org-static-blog-get-date y)
                                            (org-static-blog-get-date x)))))

  (let ((org-header (concat "#+EXPORT_FILE_NAME: " pub-filename
                            "\n#+options: toc:nil title:nil html-postamble:nil"
                            "\n#+title: " (if (equal "index" (f-base pub-filename))
                                              org-static-blog-publish-title
                                            (f-base pub-filename))
                            "\n#+begin_export html\n "
                            org-static-blog-page-preamble
                            org-static-blog-page-header
                            (if front-matter front-matter "")
                            "\n#+end_export"
                            ;; Extra styling of abstracts.
                            ;; Works; but not needed.
                            ;; "\n#+HTML_HEAD_EXTRA: &lt;style&gt; div.abstract {background-color: pink !important;} &lt;/style&gt;"
                            ))
        (index-header (if (equal "index" (f-base pub-filename))
                          (format "#+begin_export html\n%s\n#+end_export\n%s"
                                  org-static-blog-page-header index-content-header)
                        ""))
        (_ (view-echo-area-messages))
        (abstracts-of-posts (--map
                             (concat
                              (progn (message "Processing %s..." it) "") ;; Progress indicator

                              ;; &#10216;0&#10217; Title and link to article
                              (format "#+HTML: &lt;h2 class=\"title\"&gt;&lt;a href=\"%s\"&gt; %s&lt;/a&gt;&lt;/h2&gt;"
                                      (concat org-static-blog-publish-url (f-base it))
                                      (org-static-blog-get-title it))

                              ;; &#10216;1&#10217; Tags and reading time
                              (format "\n#+begin_export html\n&lt;center&gt;%s\n%s&lt;/center&gt;\n#+end_export"
                                      (blog/tags-of-file it)
                                      ;; Experimenting.
                                      (if (not show-reading-time)
                                          ""
                                        (format "\n%s %s mins read"
                                                "<a href="octoicon:clock">octoicon:clock</a>"
                                                (with-temp-buffer (insert-file-contents it)
                                                                  (org-ascii-export-as-ascii)
                                                                  (setq __x
                                                                        (count-words (point-min) (point-max)))
                                                                  (kill-buffer "<span class="bold">Org ASCII Export</span>")
                                                                  (delete-other-windows)
                                                                  (/ __x 200)))) ;; 200 words per minute reading
                                      )

                              ;; &#10216;2&#10217; Article image
                              (format "\n<span class="comment">@@</span><span class="org-tag">html:</span>%s<span class="comment">@@</span>\n" (my/org-static-blog-assemble-image it))

                              ;; &#10216;3&#10217; Preview
                              (format "\n#+INCLUDE: \"%s::*Abstract\" :only-contents t" it)

                              ;; &#10216;4&#10217; &#8220;Read more&#8221; link
                              (format (concat "\n<span class="comment">@@</span><span class="org-tag">html:</span>&lt;p style=\"text-align:right\"&gt;<span class="comment">@@</span>"
                                              " <a href="badge:Read|more|green|%s|read-the-docs">badge:Read|more|green|%s|read-the-docs</a> <span class="comment">@@</span><span class="org-tag">html:</span>&lt;/p&gt;<span class="comment">@@</span>")
                                      (concat org-static-blog-publish-url (f-base it))))
                             post-filenames))
        ;; This is the bottom-most matter in the index.html page
        (show-older-posts (concat  "\n#+begin_export html\n"
                                   "&lt;hr&gt; &lt;div id=\"archive\"&gt;"
                                   "&lt;a href=\""
                                   (org-static-blog-get-absolute-url org-static-blog-archive-file)
                                   "\"&gt;" (org-static-blog-gettext 'other-posts) "&lt;/a&gt;"
                                   "&lt;/div&gt;"
                                   "&lt;/div&gt;"
                                   (blog/license)
                                   "\n#+end_export")))
    (with-temp-buffer
      (insert (s-join "\n\n" (list org-header
                                   index-header
                                   (s-join "\n\n" abstracts-of-posts)
                                   show-older-posts)))
      (org-mode)
      (org-html-export-to-html))))
#+end_src
<span class="org-block-end-line">#+end_details
</span><span class="org-level-1">* Actually publishing an article</span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Actually-publishing-an-article</span>
<span class="org-drawer">:END:</span>

<span class="comment"># My preview setup does a great job at "publishing" my articles, as such, it seems I don't really need use org-static-blog-publish-file.</span>

<span class="comment"># (I would need org-static-blog-publish-file if I were to republish the entire blog, say via org-static-blog-publish)</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/git</span></span><span class="org-block"> (cmd </span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> args)
  </span><span class="org-block"><span class="doc">"Execute git command CMD, which </span></span><span class="org-block"><span class="doc"><span class="writegood-weasels">may have</span></span></span><span class="org-block"><span class="doc"> %s placeholders whose values are positional in ARGS."</span></span><span class="org-block">
  (shell-command (apply #'format (concat </span><span class="org-block"><span class="string">"cd ~/blog; git "</span></span><span class="org-block"> cmd) args)))

(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/publish-current-article</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"Place HTML files in the right place, update arhives, index, rss, tags; git push!"</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
    (blog/git </span><span class="org-block"><span class="string">"add %s"</span></span><span class="org-block"> (buffer-file-name))
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Placed article html into the published blog directory
</span></span><span class="org-block">  (blog/preview)
  (save-buffer)
  (</span><span class="org-block"><span class="keyword">-let</span></span><span class="org-block"> [article (concat (f-base (buffer-file-name)) </span><span class="org-block"><span class="string">".html"</span></span><span class="org-block">)]
    (shell-command (concat </span><span class="org-block"><span class="string">"mv "</span></span><span class="org-block"> article </span><span class="org-block"><span class="string">" ~/blog/"</span></span><span class="org-block">))
    (blog/git </span><span class="org-block"><span class="string">"add </span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">%s %s</span></span></span><span class="org-block"><span class="string">"</span></span><span class="org-block"> (buffer-file-name) article)
    (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> (equal (f-base (buffer-file-name)) </span><span class="org-block"><span class="string">"AlBasmala"</span></span><span class="org-block">)
      (blog/git </span><span class="org-block"><span class="string">"add AlBasmala.el"</span></span><span class="org-block">)))

  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Updated index.html, tags, archive, and rss to now include this new article
</span></span><span class="org-block">
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Need to disable my export-preprocessing hooks, when using org-static-blog utils.
</span></span><span class="org-block">  (blog/preview/disable)
  (view-echo-area-messages)

  (message </span><span class="org-block"><span class="string">"&#8658; HTMLizing article..."</span></span><span class="org-block">)
  (blog/htmlize-file (buffer-file-name))
  (blog/git </span><span class="org-block"><span class="string">"add %s.org.html"</span></span><span class="org-block"> (f-base (buffer-file-name)))

  (message </span><span class="org-block"><span class="string">"&#8658; Assembling tags..."</span></span><span class="org-block">)
  (org-static-blog-assemble-tags)
  (blog/git </span><span class="org-block"><span class="string">"add tag*"</span></span><span class="org-block">)

  (message </span><span class="org-block"><span class="string">"&#8658; Assembling archive..."</span></span><span class="org-block">)
  (org-static-blog-assemble-archive)
  (blog/git </span><span class="org-block"><span class="string">"add archive.html"</span></span><span class="org-block">)

  (message </span><span class="org-block"><span class="string">"&#8658; Assembling RSS feed..."</span></span><span class="org-block">)
  (org-static-blog-assemble-rss)
  (blog/git </span><span class="org-block"><span class="string">"add rss.xml"</span></span><span class="org-block">)

  (message </span><span class="org-block"><span class="string">"&#8658; Assembling landing page..."</span></span><span class="org-block">)
  (org-static-blog-assemble-index)
  (blog/git </span><span class="org-block"><span class="string">"add index.html"</span></span><span class="org-block">)

  (blog/git </span><span class="org-block"><span class="string">"commit -m \"%s\"; git push"</span></span><span class="org-block">
            (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> current-prefix-arg
                (read-string </span><span class="org-block"><span class="string">"Commit message: "</span></span><span class="org-block">)
              (format </span><span class="org-block"><span class="string">"Publish: Article %s.org"</span></span><span class="org-block"> (f-base (buffer-file-name)))))

  (message </span><span class="org-block"><span class="string">"&#8658; It may take up 20secs to 1minute for changes to be live at alhassy.com; congratulations!"</span></span><span class="org-block">))


</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-level-1">* Getting Started:  </span><span class="org-level-1"><span class="org-verbatim">blog/new-article</span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">blog-new-article</span>
  <span class="org-drawer">:END:</span>
<span class="org-target">&lt;&lt;new-article&gt;&gt;</span>

Helper function to make a new article.
<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp -n
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">blog/tags</span></span><span class="org-block">
  '(emacs faith category-theory order-theory
    lisp types packages haskell agda
    c frama-c program-proving)
  </span><span class="org-block"><span class="doc">"Tags for my blog articles."</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">blog/new-article</span></span><span class="org-block"> ()
</span><span class="org-block"><span class="doc">"Make a new article for my blog; prompting for the necessary ingredients.

If the filename entered already exists, we </span></span><span class="org-block"><span class="doc"><span class="writegood-weasels">simply</span></span></span><span class="org-block"><span class="doc"> write to it.
The user notices this and picks a new name.

This sets up a new article based on existing tags and posts.
+ Use C-SPC to select multiple tag items

Moreover it also enables `</span></span><span class="org-block"><span class="doc"><span class="constant">org-preview-html-mode</span></span></span><span class="org-block"><span class="doc">' so that on every alteration,
followed by a save, C-x C-s, will result in a live preview of the blog article,
nearly instantaneously."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
  (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> (file desc)

    (</span><span class="org-block"><span class="keyword">thread-last</span></span><span class="org-block"> org-static-blog-posts-directory
      f-entries
      (mapcar #'f-filename)
      (completing-read </span><span class="org-block"><span class="string">"Filename (Above are existing): "</span></span><span class="org-block">)
      (concat org-static-blog-posts-directory)
      (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> file))

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">For </span></span><span class="org-block"><span class="comment"><span class="writegood-weasels">some</span></span></span><span class="org-block"><span class="comment"> reason, &#8216;</span></span><span class="org-block"><span class="comment"><span class="constant">find-file</span></span></span><span class="org-block"><span class="comment">&#8217; in the thread above
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">wont let the completing-read display the possible completions.
</span></span><span class="org-block">    (find-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">)

    (insert </span><span class="org-block"><span class="string">"#+title: "</span></span><span class="org-block"> (read-string </span><span class="org-block"><span class="string">"Title: "</span></span><span class="org-block">)
            </span><span class="org-block"><span class="string">"\n#+author: "</span></span><span class="org-block"> user-full-name
            </span><span class="org-block"><span class="string">"\n#+email: "</span></span><span class="org-block">  user-mail-address
            </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">"\n#+date: " (format-time-string "&lt;%Y-%m-%d %H:%M&gt;")
</span></span><span class="org-block">            </span><span class="org-block"><span class="string">"\n#+filetags: "</span></span><span class="org-block"> (s-join </span><span class="org-block"><span class="string">" "</span></span><span class="org-block"> (helm-comp-read </span><span class="org-block"><span class="string">"Tags: "</span></span><span class="org-block">
                                                         blog/tags
                                                         </span><span class="org-block"><span class="builtin">:marked-candidates</span></span><span class="org-block"> t))
            </span><span class="org-block"><span class="string">"\n#+fileimage: emacs-birthday-present.png"</span></span><span class="org-block">
            </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">"\n#+fileimage: " (completing-read
</span></span><span class="org-block">            </span><span class="org-block"><span class="comment-delimiter">;;                    </span></span><span class="org-block"><span class="comment">"Image: "
</span></span><span class="org-block">            </span><span class="org-block"><span class="comment-delimiter">;;                    </span></span><span class="org-block"><span class="comment">(mapcar #'f-filename (f-entries "~/blog/images/")))
</span></span><span class="org-block">            </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">"\n#+include: ../MathJaxPreamble.org" ;; </span></span><span class="org-block"><span class="comment"><span class="hl-todo"><span class="custom-14"><span class="hl-todo"><span class="custom-14">TODO</span></span></span></span></span></span><span class="org-block"><span class="comment">. Is this someting I actually want here? If so, then consider tangling it from AlBasmala! (and add the whitespace-MathJax setup from above!)
</span></span><span class="org-block">            </span><span class="org-block"><span class="string">"\n#+description: "</span></span><span class="org-block">
               (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> desc (read-string </span><span class="org-block"><span class="string">"Article Purpose: "</span></span><span class="org-block">))
            </span><span class="org-block"><span class="string">"\n\n* Abstract :ignore: \n"</span></span><span class="org-block"> desc
            </span><span class="org-block"><span class="string">"\n\n* ???"</span></span><span class="org-block">)
    (save-buffer)
    (blog/preview)))
</span><span class="org-block-end-line">#+END_SRC
</span>
<span class="org-target">&lt;&lt;unfurling&gt;&gt;</span>

The <span class="org-verbatim">#+description</span> <span class="writegood-passive-voice">is exported</span> as HTML meta-data which <span class="writegood-passive-voice">is used</span> to
&#8216;unfurl&#8217; a link to an article: When a link to an article <span class="writegood-passive-voice">is pasted</span>
in a social media website, it <span class="italic">unfurls</span> into a little card showing
<span class="writegood-weasels">some</span> information about the link, such as its image, description, and author.
- For long descriptions, one can use multiple <span class="org-verbatim">#+description</span> lines;
  I'd like to have a terse one-liner with a longer description in the
  <span class="org-verbatim">Abstract</span> heading.

<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> Example calculation from that MathJax Setup?</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Example-calculation-from-that-MathJax-Setup</span>
   <span class="org-drawer">:END:</span>

Maybe move the MathJax setup into AlBasmala directly, then include it?
Or, maybe incorporate the MathJax setup via Emacs directly &#9829;&#8255;&#9829;
Such as org-html-head-extra

<span class="org-latex-and-related">\begin{calc}
   x \;&#8851;\; &#172; x \quad=\quad &#8869;
\step{ \ref{&#8849;-antisymmetric} }
   (x \;&#8851;\; &#172; x) \sqleqs &#8869;
   \landS &#8869; \sqleqs (x \;&#8851;\; &#172; x)
\step{ \ref{Bottom Element} }
   x \;&#8851;\; &#172; x \sqleqS &#8869;
\step{ \ref{Modus Ponens} }
   \mathsf{true}
\end{calc}</span>

Then,
<span class="org-latex-and-related">\[\eqn{Constructive De Morgan}{&#172;(x \;&#8852;\; y) \quad=\quad &#172; x \;&#8851;\; &#172; y}\]</span>

<span class="org-level-1">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1"> Publishing with  </span><span class="org-level-1"><span class="org-verbatim">[C-u C-u] C-</span></span><span class="org-level-1"><span class="org-verbatim"><span class="writegood-duplicates">c C</span></span></span><span class="org-level-1"><span class="org-verbatim">-b</span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Publishing-with-C-u-C-u-C-c-C-b</span>
  <span class="org-drawer">:END:</span>
<span class="org-drawer">:Hide_fornow:</span>
<span class="org-block-begin-line">  #+begin_src emacs-lisp -n :tangle no
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">No lock files, for now
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">The &#8220;.#file&#8221; files
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment"><a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Interlocking.html#Interlocking">https://www.gnu.org/software/emacs/manual/html_node/emacs/Interlocking.html#Interlocking</a>
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> create-lockfiles nil)
</span><span class="org-block-end-line">#+end_src
</span><span class="org-drawer">:End:</span>

<span class="org-block-begin-line">#+begin_src emacs-lisp -r -n
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Override all minor modes that use this binding.
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">bind-key*</span></span><span class="org-block"> (kbd </span><span class="org-block"><span class="string">"C-</span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">c C</span></span></span><span class="org-block"><span class="string">-b"</span></span><span class="org-block">)
  (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;optional</span></span><span class="org-block"> prefix)
</span><span class="org-block"><span class="doc">"C-</span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">c C</span></span></span><span class="org-block"><span class="doc">-b        &#8658; Publish current buffer
C-u C-</span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">c C</span></span></span><span class="org-block"><span class="doc">-b     &#8658; Publish entire blog
C-u C-u C-</span></span><span class="org-block"><span class="doc"><span class="writegood-duplicates">c C</span></span></span><span class="org-block"><span class="doc">-b &#8658; Publish entire blog; re-rendering all blog posts
                  (This will take time!)
"</span></span><span class="org-block">
     (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"P"</span></span><span class="org-block">)
     (</span><span class="org-block"><span class="keyword">pcase</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> (car prefix) 0)
       (0  (org-static-blog-publish-file (f-full (buffer-file-name)))
           (browse-url-of-file (format </span><span class="org-block"><span class="string">"<a href="file://%s%s.html">file://%s%s.html</a>"</span></span><span class="org-block"> (file-truename org-static-blog-publish-directory)
                                       (f-base (buffer-file-name)))))
       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Apparently I have to publish the current buffer before trying
</span></span><span class="org-block">       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">to publish the blog; otherwise I got </span></span><span class="org-block"><span class="comment"><span class="writegood-weasels">some</span></span></span><span class="org-block"><span class="comment"> errors.
</span></span><span class="org-block">       (4  (org-static-blog-publish-file (f-full (buffer-name)))
           (org-static-blog-publish))
       (16 </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(org-static-blog-publish t) &#8658; Crashes.
</span></span><span class="org-block">           </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Delete all .html files, except &#8220;about&#8221;
</span></span><span class="org-block">           (</span><span class="org-block"><span class="keyword">thread-last</span></span><span class="org-block"> (f-entries </span><span class="org-block"><span class="string">"~/blog/"</span></span><span class="org-block">)
             (</span><span class="org-block"><span class="keyword">--filter</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">and</span></span><span class="org-block"> (equal (f-ext it) </span><span class="org-block"><span class="string">"html"</span></span><span class="org-block">)
                            (not (member (f-base it) '(</span><span class="org-block"><span class="string">"about"</span></span><span class="org-block">)))))
             (</span><span class="org-block"><span class="keyword">--map</span></span><span class="org-block"> (f-delete it))) </span><span class="org-block"><span class="warning">(ref:delAll)</span></span><span class="org-block">
           </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Publish as usual
</span></span><span class="org-block">           (org-static-blog-publish-file (f-full (buffer-name)))
           (org-static-blog-publish)))))
</span><span class="org-block-end-line">#+end_src
</span>
Line <span class="org-link"><a href="(delAll)">(delAll)</a></span>: To re-render an article, just remove its corresponding .html file ;-)

<span class="org-level-1">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-1">  Ideas</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-todo</span>
  <span class="org-drawer">:END:</span>

<span class="comment"># </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">: Automate the insertation of HTML Premable/postable for statics like about/AlBasmala</span>

<span class="comment"># (maybe-clone "<a href="https://github.com/alhassy/alhassy.github.io.git">https://github.com/alhassy/alhassy.github.io.git</a>" "~/blog")</span>


<span class="comment"># <a href="teal:TODO">teal:</a></span><span class="comment"><span class="hl-todo"><span class="custom-14"><a href="teal:TODO">TODO</a></span></span></span><span class="comment">: Make C-u C-</span><span class="comment"><span class="writegood-duplicates">c C</span></span><span class="comment">-b switch to a particular theme so all exported html stuffs</span>
<span class="comment"># look the same ^_^</span>


<span class="comment"># Idea: Make the tags at the bottom be badges, alter/advice the corresponding</span>
<span class="comment"># function</span>
<span class="comment"># Idea: Add &#8220;last updated&#8221; date to footer?</span>

+ in the index, under each article's name:
  - twitter link ;-)
    - per article via advice

<span class="org-block-begin-line"> #+begin_export html
</span><span class="org-block"> &lt;</span><span class="org-block"><span class="function-name">footer</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">class</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"container"</span></span><span class="org-block">&gt;
     &lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">class</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"site-footer"</span></span><span class="org-block">&gt;

         &lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">class</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"copyright pull-left"</span></span><span class="org-block">&gt;
             Powered by
             &lt;</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">href</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"<a href="https://github.com/alhassy/emacs.d">https://github.com/alhassy/emacs.d</a>"</span></span><span class="org-block">&gt;Emacs&lt;/</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block">&gt;
         &lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;

         &lt;</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">href</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"<a href="https://github.com/alhassy">https://github.com/alhassy</a>"</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">target</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"_blank"</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">aria-label</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"view source code"</span></span><span class="org-block">&gt;
             octicon-github
         &lt;/</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block">&gt;

         &lt;</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">class</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"pull-right"</span></span><span class="org-block">&gt;
             &lt;</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">href</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"javascript:window.scrollTo(0,0)"</span></span><span class="org-block"> &gt;TOP&lt;/</span><span class="org-block"><span class="function-name">a</span></span><span class="org-block">&gt;
         &lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;
     &lt;/</span><span class="org-block"><span class="function-name">div</span></span><span class="org-block">&gt;
 &lt;/</span><span class="org-block"><span class="function-name">footer</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line"> #+end_export
</span>
 + Footer should include
   - See Org Source; see HTML source
   - buy-me-a-coffee

<span class="org-meta-line">#+html: &lt;hr&gt;</span>


<span class="comment">#</span>
<span class="comment"># + search</span>

<span class="comment"># + Org-mode unicorn as faveicon!</span>

<span class="comment"># This, like the upcoming articles, </span><span class="comment"><span class="writegood-passive-voice">is intended</span></span><span class="comment"> to be a living document.</span>
<span class="comment"># The date serves to be date of the first release and the repo contains</span>
<span class="comment"># the history of any alterations.</span>

<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> To consider</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-To-consider</span>
  <span class="org-drawer">:END:</span>


<span class="org-block-begin-line">#+BEGIN_SRC emacs-lisp :tangle no
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Okie, dokes. maybe useful
</span></span><span class="org-block">(maybe-clone </span><span class="org-block"><span class="string">"<a href="https://github.com/adithyaov/helm-org-static-blog">https://github.com/adithyaov/helm-org-static-blog</a>"</span></span><span class="org-block">)
(load-file </span><span class="org-block"><span class="string">"~/helm-org-static-blog/helm-org-static-blog.el"</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-publish-title </span><span class="org-block"><span class="string">"Life &amp; Computing Science"</span></span><span class="org-block">)
(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-publish-url </span><span class="org-block"><span class="string">"<a href="https://alhassy.github.io/">https://alhassy.github.io/</a>"</span></span><span class="org-block">)
(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-publish-directory </span><span class="org-block"><span class="string">"~/alhassy.github/posts/"</span></span><span class="org-block">)
(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-posts-directory </span><span class="org-block"><span class="string">"~/alhassy.github/posts/"</span></span><span class="org-block">)
(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-static-blog-drafts-directory </span><span class="org-block"><span class="string">"~/alhassy.github/drafts/"</span></span><span class="org-block">)
</span><span class="org-block-end-line">#+END_SRC
</span>
Show me the &#8220;non-trivial&#8221; files in my blog repo.
<span class="org-block-begin-line">#+begin_src emacs-lisp :results raw
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">thread-last</span></span><span class="org-block"> (f-entries </span><span class="org-block"><span class="string">"~/alhassy.github"</span></span><span class="org-block">)
  (</span><span class="org-block"><span class="keyword">--filter</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> (not (equal (f-ext it) </span><span class="org-block"><span class="string">"html"</span></span><span class="org-block">))
                (s-starts-with? </span><span class="org-block"><span class="string">"tag-"</span></span><span class="org-block"> (f-base it))))
  (</span><span class="org-block"><span class="keyword">--map</span></span><span class="org-block"> (format </span><span class="org-block"><span class="string">"<a href="file:%s">[[file:%s]]</a>"</span></span><span class="org-block"> it))
  (s-join </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block"> ))
</span><span class="org-block-end-line">#+end_src
</span>
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> Mention alternative to using &#8220;Abstract&#8221;</span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Mention-alternative-to-using-Abstract</span>
  <span class="org-drawer">:END:</span>

src: <span class="org-link"><a href="https://ogbe.net/blog/blogging_with_org.html">https://ogbe.net/blog/blogging_with_org.html</a></span>

  When I write a blog post, I enclose the "preview" part of the post in #+BEGIN_PREVIEW...#+END_PREVIEW tags, which my (<span class="writegood-weasels">very</span> <span class="writegood-weasels">simple</span>) parser then inserts into the sitemap page.

(defun my-blog-get-preview (file)
  "The comments in FILE have to be on their own lines, prefereably before and after paragraphs."
  (with-temp-buffer
    (insert-file-contents file)
    (goto-char (point-min))
    (let ((beg (+ 1 (re-search-forward "^#\\+BEGIN_PREVIE<span class="org-latex-and-related">W$")))
          (end (progn (re-search-forward "^#\\+END_PREVIEW$"</span>)
                      (match-beginning 0))))
      (buffer-substring beg end))))
<span class="org-hide">*</span><span class="org-level-2">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-2"> Old Jekyll Setup                              </span><span class="org-level-2"><span class="org-tag">:posterity:terrible:</span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Old-Jekyll-Setup</span>
  <span class="org-special-keyword">:header-args:</span>    <span class="org-property-value">:noeval</span>
  <span class="org-drawer">:END:</span>
Write in Org-mode and generate coloured markdown for Jekyll usage

<span class="comment"># Usage &#8759; Begin blog server then load AlBasmala, then edit &amp; preview.</span>
<span class="comment">#</span>
<span class="comment"># (shell-command "cd ~/alhassy.github.io/ ; bundle exec jekyll serve &amp;")</span>
<span class="comment"># (find-file "~/alhassy.github.io/content/AlBasmala.el")</span>
<span class="comment"># (preview-article :browser t)</span>
<span class="comment"># (preview-article)</span>

<span class="org-hide">**</span><span class="org-level-3">* Server Setup</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Server-Setup</span>
   <span class="org-drawer">:END:</span>

 When drafting, it's ideal to be able to inspect the resulting web article.
 To do so, we may initialise the Jekyll server as follows.
<span class="org-block-begin-line"> #+begin_src emacs-lisp :tangle no
</span><span class="org-block">(shell-command </span><span class="org-block"><span class="string">"cd ~/alhassy.github.io/ ; bundle exec jekyll serve &amp;"</span></span><span class="org-block">)
</span><span class="org-block-end-line"> #+end_src
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: #&lt;window 328 on *Org-Babel Error Output*&gt;
</span>
 In order to be an Org only interface, let's remove this shell invocation from
 the user's view --as an Org user, they need not <span class="writegood-passive-voice">be forced</span> to learn such Jekyll intricacies.

<span class="org-block-begin-line"> #+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">jekyll-served</span></span><span class="org-block"> nil </span><span class="org-block"><span class="doc">"Documents whether the blog server has begun."</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">ensure-blog-is-serving</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"Ensure that the server has begun."</span></span><span class="org-block">
   (</span><span class="org-block"><span class="keyword">unless</span></span><span class="org-block"> jekyll-served
      (shell-command </span><span class="org-block"><span class="string">"cd ~/alhassy.github.io/ ; bundle exec jekyll serve &amp;"</span></span><span class="org-block">)
      (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> jekyll-served t)))
</span><span class="org-block-end-line"> #+end_src
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: ensure-blog-is-serving
</span>
 Super <span class="writegood-weasels">simple</span>, but hides an annoying step &amp; layer from the user.

<span class="org-hide">**</span><span class="org-level-3">* </span><span class="org-level-3"><span class="org-code">file</span></span><span class="org-level-3"> Symbols</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">file-Symbols</span>
   <span class="org-drawer">:END:</span>

 We will look at <span class="writegood-weasels">various</span> generated files revolving around the given file,
 so let us generate the necessary variables that refer to such names.

 First off, <span class="writegood-weasels">some</span> useful libraries.
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">require</span></span><span class="org-block"> '</span><span class="org-block"><span class="constant">dash</span></span><span class="org-block">) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">A modern list library for Emacs
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">require</span></span><span class="org-block"> '</span><span class="org-block"><span class="constant">s</span></span><span class="org-block">)    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">String processing library.
</span></span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: s
</span>
 Now, let's make a function that produces our variables.
 This way we avoid tedious repetition of a particular pattern.
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">make-file-extension-variables</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;key</span></span><span class="org-block"> prefix name extensions)
  </span><span class="org-block"><span class="doc">" Produce symbols &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">prefix.ext</span></span></span><span class="org-block"><span class="doc">&#8217; whose value is the string &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">name.ext</span></span></span><span class="org-block"><span class="doc">&#8217;, where
    &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">ext</span></span></span><span class="org-block"><span class="doc">&#8217; range over the list &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">extensions</span></span></span><span class="org-block"><span class="doc">&#8217;.

    Both &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">prefix</span></span></span><span class="org-block"><span class="doc">&#8217; and &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">name</span></span></span><span class="org-block"><span class="doc">&#8217; should be strings.

    I insist that the arguments be keywords, &#8220;:prefix, :name, :extensions&#8221;,
    since I currently feel that this is more informative.
    All three pieces need to be there, otherwise no variables </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">are formed</span></span></span><span class="org-block"><span class="doc">.
    Success </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is signalled</span></span></span><span class="org-block"><span class="doc"> by the message string &#8221;new filename variables created&#8221;.

    Moreover, these symbols are local to the current buffer;
    in-particular, their values cannot </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">be altered</span></span></span><span class="org-block"><span class="doc"> from other buffers.
  "</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">and</span></span><span class="org-block"> prefix name
    (</span><span class="org-block"><span class="keyword">dolist</span></span><span class="org-block"> (ext extensions (message </span><span class="org-block"><span class="string">"new filename variables created"</span></span><span class="org-block">))
      (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((name.ext (concat name </span><span class="org-block"><span class="string">"."</span></span><span class="org-block"> ext))
         (symbol   (intern (concat prefix </span><span class="org-block"><span class="string">"."</span></span><span class="org-block"> ext))))
       (set symbol name.ext)
       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(make-local-variable symbol)
</span></span><span class="org-block">       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Undesirable since I want to use these names in other buffers.
</span></span><span class="org-block">      ))))
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: make-file-extension-variables
</span>
 <span class="org-drawer">:Example_of_locals_in_elisp:</span>
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle no
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> bar </span><span class="org-block"><span class="string">"noah"</span></span><span class="org-block">)          </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">All buffers can access this variable, with only this value as default value.
</span></span><span class="org-block">(make-local-variable 'bar) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">All future setq's only affect this buffer.
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> bar </span><span class="org-block"><span class="string">"rab"</span></span><span class="org-block">)

</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">As such, the following approach makes a variable local to begin with.
</span></span><span class="org-block">
(make-local-variable 'foo) </span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> foo </span><span class="org-block"><span class="string">"woah"</span></span><span class="org-block">)
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: woah
</span>
 <span class="org-drawer">:End:</span>

 With that in hand, let's actually make the <span class="org-code">file.*</span> variables.
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> AbsNAME (file-name-sans-extension buffer-file-name))
(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> NAME (file-name-sans-extension (buffer-name)))

(make-file-extension-variables
   </span><span class="org-block"><span class="builtin">:prefix</span></span><span class="org-block">     </span><span class="org-block"><span class="string">"file"</span></span><span class="org-block">
   </span><span class="org-block"><span class="builtin">:</span></span><span class="org-block"><span class="builtin"><span class="writegood-duplicates">name</span></span></span><span class="org-block"><span class="writegood-duplicates">       NAME</span></span><span class="org-block">
   </span><span class="org-block"><span class="builtin">:extensions</span></span><span class="org-block"> '(</span><span class="org-block"><span class="string">"org"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"el"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"src"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"tex"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"pdf"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"html"</span></span><span class="org-block">))
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: new filename variables created
</span>
 Finally, it would be nice to know where the blog repository lives.
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">blogrepo</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"~/alhassy.github.io/"</span></span><span class="org-block">
    </span><span class="org-block"><span class="doc">"The path to the blog repository on a local machine."</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">blogrepo-posts</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"~/alhassy.github.io/_posts/"</span></span><span class="org-block">
    </span><span class="org-block"><span class="doc">"The path to the blog repository's posts directory."</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">blogrepo-file.pdf</span></span><span class="org-block"> (concat </span><span class="org-block"><span class="string">"../assets/pdfs/"</span></span><span class="org-block"> file.pdf) </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(concat "~/alhassy.github.io/assets/pdfs/" file.pdf)
</span></span><span class="org-block">  </span><span class="org-block"><span class="doc">"The path to the blog repository where the generated PDF should live."</span></span><span class="org-block">)

</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Make these variables local to the current buffer.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Undesirable since I'd like to utlise these in other buffers.
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(make-local-variable 'blogrepo)
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(make-local-variable 'blogrepo-posts)
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(make-local-variable 'blogrepo-file.pdf)
</span></span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: blogrepo-file\.pdf
</span>
 Before we close we need Jekyll relevant names.
<span class="org-block-begin-line"> #+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">jekyll.name</span></span><span class="org-block"> nil
  </span><span class="org-block"><span class="doc">"The formal name of the resulting Jekyll blog article."</span></span><span class="org-block">)

(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">jekyll.name.md</span></span><span class="org-block"> nil
  </span><span class="org-block"><span class="doc">"The formal markdown of the resulting Jekyll blog article."</span></span><span class="org-block">)
</span><span class="org-block-end-line"> #+end_src
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: jekyll\.name\.md
</span>
<span class="org-hide">**</span><span class="org-level-3">* Get Org Keywords</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Get-Org-Keywords</span>
   <span class="org-drawer">:END:</span>

 We want to be able to access <span class="org-code">#+key: value</span> pairs from the article org source
 as a variable <span class="org-code">org.key</span>. We also allow as input default values, since the user
 may not have provided values for them.

<span class="org-block-begin-line"> #+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defvar</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">albasmala/keywords</span></span><span class="org-block">
 `((</span><span class="org-block"><span class="string">"title"</span></span><span class="org-block">       . nil)
   (</span><span class="org-block"><span class="string">"date"</span></span><span class="org-block">        . ,(format-time-string </span><span class="org-block"><span class="string">"%Y-%m-%d"</span></span><span class="org-block">))
   (</span><span class="org-block"><span class="string">"author"</span></span><span class="org-block">      . nil)
   (</span><span class="org-block"><span class="string">"image"</span></span><span class="org-block">       . nil)
   (</span><span class="org-block"><span class="string">"imageheight"</span></span><span class="org-block"> . 142)
   (</span><span class="org-block"><span class="string">"imagewidth"</span></span><span class="org-block">  . 142)
   (</span><span class="org-block"><span class="string">"categories"</span></span><span class="org-block">  . nil)
   (</span><span class="org-block"><span class="string">"sourcefile"</span></span><span class="org-block">  .
    ,(concat </span><span class="org-block"><span class="string">"<a href="https://raw.githubusercontent.com/alhassy/alhassy.github.io/master/content/">https://raw.githubusercontent.com/alhassy/alhassy.github.io/master/content/</a>"</span></span><span class="org-block">
        (buffer-name)))
   (</span><span class="org-block"><span class="string">"nopdf"</span></span><span class="org-block">              . nil)
   (</span><span class="org-block"><span class="string">"nomodificationdate"</span></span><span class="org-block"> . nil)
   (</span><span class="org-block"><span class="string">"draft"</span></span><span class="org-block">              . nil))
 </span><span class="org-block"><span class="doc">"This list contains tuples denoting a &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">property</span></span></span><span class="org-block"><span class="doc">&#8217; and it's &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">default</span></span></span><span class="org-block"><span class="doc">&#8217; value.
  These are the keywords that the user of this AlBasmala setup should utilise.

  For example, if the user does not provide a &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">date</span></span></span><span class="org-block"><span class="doc">&#8217;, then one </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is provided</span></span></span><span class="org-block"><span class="doc">,
  for them; the default date.

  Note that &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">sourcefile</span></span></span><span class="org-block"><span class="doc">&#8217; refers to the URL to the raw master location of the blog
  repository by default, but it's useful for the user to set it when the file </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is
  associated</span></span></span><span class="org-block"><span class="doc"> with a different repoistory. The URL should begin &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant"><a href="https://">https://</a>&#8943;</span></span></span><span class="org-block"><span class="doc">&#8217;.

  By default we produce a PDF and link to it from the article.
  If &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">nopdf</span></span></span><span class="org-block"><span class="doc">&#8217; </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is set</span></span></span><span class="org-block"><span class="doc"> to a non-nil value, then no PDF </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is generated</span></span></span><span class="org-block"><span class="doc">
  --which may be usefull since making a pdf takes time, which may not be desirable
  while drafting. Likewise, we always produce the most recent modification date,
  unless instructed otherwise. --c.f., &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">draft</span></span></span><span class="org-block"><span class="doc">&#8217;.

  The &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">draft</span></span></span><span class="org-block"><span class="doc">&#8217; variable is useful since it puts the word DRAFT alongside
  a generated number when drafting so as to ensure you're actually
  re-generating the article --rather than loading a previously generated one.
  When drafting, no PDF </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is generated</span></span></span><span class="org-block"><span class="doc">.

  Warning: The values cannot have links; e.g., embedding a link in the
  value of &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">author</span></span></span><span class="org-block"><span class="doc">&#8217; renders this script useless.
 "</span></span><span class="org-block">)
</span><span class="org-block-end-line"> #+end_src
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: albasmala/keywords
</span>
 For each keyword, let's uniformly produce these symbols, attempt to obtain their values,
 and use the defaults otherwise.

<span class="org-block-begin-line"> #+begin_src emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">make-org-variables</span></span><span class="org-block"> (keywords)
  </span><span class="org-block"><span class="doc">"For each &#8220;(key . default)&#8221; in the &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">keywords</span></span></span><span class="org-block"><span class="doc">&#8217; list, we produce a symbol named
  &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">org.key</span></span></span><span class="org-block"><span class="doc">&#8217; whose value </span></span><span class="org-block"><span class="doc"><span class="writegood-passive-voice">is set</span></span></span><span class="org-block"><span class="doc"> to be the value from &#8220;#+key: value&#8221;
  from the current buffer.

  The keys may be in lower case; we upcase them before obtaining
  their values. If there is no value, we use the defaults in &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">keywords</span></span></span><span class="org-block"><span class="doc">&#8217;.
  "</span></span><span class="org-block">

  (</span><span class="org-block"><span class="keyword">dolist</span></span><span class="org-block"> (keydef keywords (message </span><span class="org-block"><span class="string">"new org keyword variables created"</span></span><span class="org-block">))
    (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((key (car keydef))
       (value (org-keyword (upcase key)))
       (org.key (concat </span><span class="org-block"><span class="string">"org."</span></span><span class="org-block"> key))
       (symbol  (intern org.key)))

       (set symbol value)
       (</span><span class="org-block"><span class="keyword">unless</span></span><span class="org-block"> value (set symbol (cdr keydef)))
       (put symbol 'variable-documentation
        </span><span class="org-block"><span class="string">"Variable generated by &#8216;</span></span><span class="org-block"><span class="string"><span class="constant">make-org-variables</span></span></span><span class="org-block"><span class="string">&#8217;"</span></span><span class="org-block">)

       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(make-local-variable symbol)
</span></span><span class="org-block">       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Undesirable since I use the &#8216;</span></span><span class="org-block"><span class="comment"><span class="constant">org.key</span></span></span><span class="org-block"><span class="comment">&#8217; symbols
</span></span><span class="org-block">       </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">in the assocaited html buffers.
</span></span><span class="org-block">      )))
</span><span class="org-block-end-line"> #+end_src
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: make-org-variables
</span>
 <span class="org-drawer">:Setting_docstrings_after_the_fact:</span>

 (put FUNCTIONSYMBOL 'function-documentation VALUE)

 (get 'org.sourcefile 'variable-documentation)
 (put 'org.sourcefile 'variable-documentation "nice")

 (get symbol 'variable-documentation)
 (put 'symbol 'variable-documentation 'doc-string)
 <span class="org-drawer">:End:</span>

 We know turn to actually obtaining the values of keywords as a function call.
 Why not just set them once? These values can <span class="writegood-passive-voice">be altered</span> any time by the user, e.g., me,
 and as such they need to <span class="writegood-passive-voice">be reloaded</span> before the post <span class="writegood-passive-voice">is created</span> as a precautionary measure.
 E.g., the title in the org file and the title in the article may be distinct, so we allow
       the user this added flexibility.

 We invoke <span class="org-code">make-org-variables</span> to produce variables of the form <span class="org-code">org.var</span>.

<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">GetOrgKeyWords</span></span><span class="org-block"> () </span><span class="org-block"><span class="doc">"Get the #+KEYWORD values from the org-file."</span></span><span class="org-block">

   (make-org-variables albasmala/keywords)

   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">We have these here in-case the &#8220;org.date&#8221; </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">is altered</span></span></span><span class="org-block"><span class="comment">.
</span></span><span class="org-block">   (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> jekyll.name   (concat org.date </span><span class="org-block"><span class="string">"-"</span></span><span class="org-block"> NAME))
   (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> jekyll.name.md (concat org.date </span><span class="org-block"><span class="string">"-"</span></span><span class="org-block"> NAME </span><span class="org-block"><span class="string">".markdown"</span></span><span class="org-block">))
)

</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Globally set the variables
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(GetOrgKeyWords)
</span></span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-meta-line"> #+RESULTS:</span>
 <span class="org-code">: GetOrgKeyWords
</span>
 Note that these values can be manually overridden by including in your locals, for example:
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle no
</span><span class="org-block"># eval: (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org.title </span><span class="org-block"><span class="string">"Experimenting..."</span></span><span class="org-block"> )
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* MakeHeader</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">MakeHeader</span>
   <span class="org-drawer">:END:</span>

 The Jekyll backend has a particular header for articles, which we produce:

<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">MakeHeader</span></span><span class="org-block"> () </span><span class="org-block"><span class="doc">"Header for Jekyll backend."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> HEADER (concat
   </span><span class="org-block"><span class="string">"---\nlayout: post\nname: "</span></span><span class="org-block"> jekyll.name
   </span><span class="org-block"><span class="string">"\ntitle: "</span></span><span class="org-block">                  org.title
   </span><span class="org-block"><span class="string">"\ndate: "</span></span><span class="org-block">                   org.date
   </span><span class="org-block"><span class="string">"\nauthor: "</span></span><span class="org-block">                 org.author
   </span><span class="org-block"><span class="string">"\nimage:\n   href: "</span></span><span class="org-block">        org.image
   </span><span class="org-block"><span class="string">"\ncategories: "</span></span><span class="org-block">             org.categories
   </span><span class="org-block"><span class="string">"\n---\n"</span></span><span class="org-block">
   )))
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* Article Image</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Article-Image</span>
   <span class="org-drawer">:END:</span>

 An image <span class="writegood-passive-voice">is included</span> via the <span class="org-code">#+</span><span class="org-link"><span class="org-code"><a href="IMAGE:location">IMAGE:location</a></span></span> --see the usages sections below.
 Alternative methods include.

 + An image can <span class="writegood-passive-voice">be embedded</span> as a url, in Org-mode:
<span class="org-block-begin-line">    #+BEGIN_SRC org :tangle no
</span><span class="org-block">,#+begin_export html
&lt;center&gt; &lt;img src="</span><span class="org-block"><span class="org-link"><a href="http://book.realworldhaskell.org/support/rwh-200.jpg">http://book.realworldhaskell.org/support/rwh-200.jpg</a></span></span><span class="org-block">"
  alt="RWH Cover" width="142" height="142" align="top"&gt; &lt;/center&gt;
,#+end_export
</span><span class="org-block-end-line"> #+END_SRC
</span>
   <span class="org-drawer">:One_long_line:</span>
<span class="org-block-begin-line">    #+BEGIN_SRC org :tangle no
</span><span class="org-block">,#+HTML: &lt;center&gt; &lt;img src="</span><span class="org-block"><span class="org-link"><a href="http://book.realworldhaskell.org/support/rwh-200.jpg">http://book.realworldhaskell.org/support/rwh-200.jpg</a></span></span><span class="org-block">" alt="RWH Cover" width="142" height="142" align="top"&gt; &lt;/center&gt;
</span><span class="org-block-end-line"> #+END_SRC
</span> <span class="org-drawer">:End:</span>
 + Or as an Org link:
<span class="org-block-begin-line">    #+BEGIN_SRC org :tangle no
</span><span class="org-block"><span class="org-link"><a href="file:../assets/img/rwh-200.jpg">[[file:../assets/img/rwh-200.jpg]]</a></span></span><span class="org-block">
</span><span class="org-block-end-line"> #+END_SRC
</span>
 + Or as local image via explicit html link:
<span class="org-block-begin-line">    #+BEGIN_SRC org :tangle no
</span><span class="org-block">,#+begin_export html
&lt;center&gt; &lt;img src="../assets/img/rwh-200.jpg" alt="RWH Cover"
width="142" height="142" align="top"&gt; &lt;/center&gt;
,#+end_export
</span><span class="org-block-end-line"> #+END_SRC
</span>
   <span class="org-drawer">:One_long_line:</span>
<span class="org-block-begin-line">    #+BEGIN_SRC org :tangle no
</span><span class="org-block">,#+HTML: &lt;center&gt; &lt;img src="../assets/img/rwh-200.jpg" alt="RWH Cover" width="142" height="142" align="top"&gt; &lt;/center&gt;
</span><span class="org-block-end-line"> #+END_SRC
</span> <span class="org-drawer">:End:</span>

 For now, I use the approach of inserting an HTML URL:
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">insert-image-and-other-formats</span></span><span class="org-block"> ()
   </span><span class="org-block"><span class="doc">"Insert image location obtained from #+IMAGE org keyword, as well as top-matter."</span></span><span class="org-block">

   (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((html.image.info
       (concat </span><span class="org-block"><span class="string">"&lt;center&gt; &lt;img src=\""</span></span><span class="org-block"> org.image
         </span><span class="org-block"><span class="string">"\" alt=\"Musa's article image\""</span></span><span class="org-block">
         </span><span class="org-block"><span class="string">" width=\""</span></span><span class="org-block"> (format </span><span class="org-block"><span class="string">"%s"</span></span><span class="org-block"> org.imagewidth) </span><span class="org-block"><span class="string">"\" "</span></span><span class="org-block">
         </span><span class="org-block"><span class="string">"height=\""</span></span><span class="org-block"> (format </span><span class="org-block"><span class="string">"%s"</span></span><span class="org-block"> org.imageheight) </span><span class="org-block"><span class="string">"\" "</span></span><span class="org-block">
         </span><span class="org-block"><span class="string">"align=\"top\"&gt; &lt;/center&gt;"</span></span><span class="org-block">)))

   (re-replace-in-file </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">see below
</span></span><span class="org-block">      (concat AbsNAME </span><span class="org-block"><span class="string">".html"</span></span><span class="org-block">)
      </span><span class="org-block"><span class="string">"&lt;h1.*h1&gt;"</span></span><span class="org-block">
      (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (x) (concat x </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block"> html.image.info </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block"> (make-top-matter))))))
</span><span class="org-block-end-line"> #+END_SRC
</span>
 One possible extension would be to make parameters for image width and height.
 Perhaps I will get to doing so in time.

 Disclaimer: I wrote the following <span class="italic">before</span> I learned any lisp; everything below is
 <span class="writegood-weasels">probably</span> terrible.
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">re-replace-in-file</span></span><span class="org-block"> (file regex whatDo)
   </span><span class="org-block"><span class="doc">"Find and replace a regular expression in-place in a file.

   Terrible function &#8230; before I took the time to learn any Elisp!
   "</span></span><span class="org-block">
    (find-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">)
    (goto-char 0)
    (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((altered (replace-regexp-in-string regex whatDo (buffer-string))))
      (erase-buffer)
      (insert altered)
      (save-buffer)
      (kill-buffer)))
</span><span class="org-block-end-line"> #+END_SRC
</span>
 Example usage:
<span class="org-block-begin-line"> #+BEGIN_EXAMPLE emacs-lisp
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Within mysite.html we rewrite: &lt;h1.*h1&gt;   &#8614;   &lt;h1.*h1&gt;\n NICE
</span></span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">I.e., we add a line break after the first heading and a new word, &#8220;NICE&#8221;.
</span></span><span class="org-block">(re-replace-in-file </span><span class="org-block"><span class="string">"mysite.html"</span></span><span class="org-block">
                    </span><span class="org-block"><span class="string">"&lt;h1.*h1&gt;"</span></span><span class="org-block">
                    (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> (x) (concat x </span><span class="org-block"><span class="string">"\n NICE"</span></span><span class="org-block">)))
</span><span class="org-block-end-line"> #+END_EXAMPLE
</span><span class="org-hide">**</span><span class="org-level-3">* PDF Generation</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">PDF-Generation</span>
   <span class="org-drawer">:END:</span>

 <span class="org-drawer">:Old_tangle_latex_approach:</span>
 The org block header for the following has
<span class="org-block-begin-line"> #+begin_src org :tangle no
</span><span class="org-block">:var webArticle = (file-name-sans-extension (buffer-name))
</span><span class="org-block-end-line"> #+end_src
</span> This allows us to use the buffer's name within the tangled LaTeX! Neato.
<span class="org-meta-line"> #+NAME: headers</span>
 BEGIN_SRC org :tangle headers.ltx :exports code :var webArticle = (file-name-sans-extension (buffer-name))

 END_SRC
 That is, the string <span class="org-code">webArticle</span> is a parameter of this source block.

 Later,
   ;; Replace webArticle with the name of the article in our headers.ltx file.
   (re-replace-in-file "~/alhassy.github.io/content/headers.ltx" "webArticle" (lambda (x) NAME))
 <span class="org-drawer">:End:</span>

 Finally, we weave everything together:
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Include LaTeX Org-calls, produce the PDF, then revert the file.
</span></span><span class="org-block"><span class="comment-delimiter">;;</span></span><span class="org-block"><span class="comment">
</span></span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">prepend-for-</span></span><span class="org-block"><span class="function-name"><span class="writegood-weasels">simple</span></span></span><span class="org-block"><span class="function-name">-latex</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;rest</span></span><span class="org-block"> extras)
  </span><span class="org-block"><span class="doc">"Prepend an Org file with a </span></span><span class="org-block"><span class="doc"><span class="writegood-weasels">simple</span></span></span><span class="org-block"><span class="doc"> LaTeX preamble; perform extras before returing to source file.
  "</span></span><span class="org-block">
  (save-buffer)
  (copy-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">.org file.src 'overwrite)  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Produce a checkpoint.
</span></span><span class="org-block">  (beginning-of-buffer)

  (insert (s-join </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block"> `(
    </span><span class="org-block"><span class="string">"#+OPTIONS: toc:nil"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\usepackage[margin=0.5in]{geometry}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\usepackage{fancyhdr}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\setlength{\\headheight}{30pt}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\lhead{} \\rhead{} \\cfoot{\\vspace{-3em} \\thepage} \\lfoot{} \\rfoot{}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\chead{\\emph{This PDF </span></span><span class="org-block"><span class="string"><span class="writegood-passive-voice">was generated</span></span></span><span class="org-block"><span class="string"> \\emph{ungracefully} from a web article on"</span></span><span class="org-block">
    ,(concat </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\url{<a href="https://alhassy.github.io/">https://alhassy.github.io/</a>"</span></span><span class="org-block"> NAME </span><span class="org-block"><span class="string">"/}}}"</span></span><span class="org-block">)
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\let\\doit=\\maketitle"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\def\\maketitle{\\doit\\thispagestyle{fancy}}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX: \\pagestyle{fancy} \\tableofcontents \\newpage"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\usepackage{color}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\definecolor{darkgreen}{rgb}{0.0, 0.3, 0.1}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\definecolor{darkblue}{rgb}{0.0, 0.1, 0.3}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"#+LATEX_HEADER: \\hypersetup{colorlinks,linkcolor=darkblue,citecolor=darkblue,urlcolor=darkgreen}"</span></span><span class="org-block">
    </span><span class="org-block"><span class="string">"\n"</span></span><span class="org-block">
      )))

  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Using (lambda () (extras...)) makes the extras happen before the reversion below.
</span></span><span class="org-block">  (eval extras)

  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">revert to working file
</span></span><span class="org-block">  (copy-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">.src file.org 'overwrite)
  (delete-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">.src)
  (toggle enable-local-variables </span><span class="org-block"><span class="builtin">:all</span></span><span class="org-block">
    (revert-buffer 'ignore-auto 'no-confirmation))

  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">A copy, rather a move, since article repo may differ from blog repo.
</span></span><span class="org-block">  (copy-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">.pdf

         </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">&#8216;</span></span><span class="org-block"><span class="comment"><span class="constant">blogrepo-file.pdf</span></span></span><span class="org-block"><span class="comment">&#8217; is the path relative to the blog repository;
</span></span><span class="org-block">         </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">this format allows us to view the PDF when the local blog server is running.
</span></span><span class="org-block">         </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">However, we may currently be residing in a different repository.
</span></span><span class="org-block">         </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">As such, we shift the cp command to move to the absolute path to the blog repo.
</span></span><span class="org-block">         (concat </span><span class="org-block"><span class="string">"~/alhassy.github.io"</span></span><span class="org-block"> (s-chop-prefix </span><span class="org-block"><span class="string">".."</span></span><span class="org-block"> blogrepo-file.pdf))
         </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(file-truename blogrepo-file.pdf) ;; fix me
</span></span><span class="org-block">
         'overwrite
    )
)

(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">my-org-latex-export-to-pdf</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"Produce a </span></span><span class="org-block"><span class="doc"><span class="writegood-weasels">simple</span></span></span><span class="org-block"><span class="doc"> PDF that has wide margins and has a warning"</span></span><span class="org-block">
  (prepend-for-</span><span class="org-block"><span class="writegood-weasels">simple</span></span><span class="org-block">-latex (</span><span class="org-block"><span class="keyword">lambda</span></span><span class="org-block"> () (org-latex-export-to-pdf)))
)

</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* Other Formats</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Other-Formats</span>
   <span class="org-drawer">:END:</span>

 Readers of the article may want to see the source
 --which may contain code or parts not rendered in the article, such as exercise solutions.
<span class="comment"> # --</span>
<span class="comment"> # or they may prefer a PDF version for printing or </span><span class="comment"><span class="writegood-weasels">simply</span></span><span class="comment"> for an alternate aesthetic.</span>

<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">get-raw-and-commits</span></span><span class="org-block"> (url)
  </span><span class="org-block"><span class="doc">"
  Given a github &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">url</span></span></span><span class="org-block"><span class="doc">&#8217;, return the associated commits history and raw textual urls,
  as a dotted pair.

  For example,
  url     &#8594; <a href="https://github.com/&#10218;user&#10219;/&#10218;project&#10219;/blob/master/content/&#10218;filepath">https://github.com/&#10218;user&#10219;/&#10218;project&#10219;/blob/master/content/&#10218;filepath</a>&#10219;
  raw     &#8594; <a href="https://raw.githubusercontent.com/&#10218;user&#10219;/&#10218;project&#10219;/master/content/&#10218;filepath">https://raw.githubusercontent.com/&#10218;user&#10219;/&#10218;project&#10219;/master/content/&#10218;filepath</a>&#10219;
  commits &#8594; <a href="https://github.com/&#10218;user&#10219;/&#10218;project&#10219;/commits/master/content/&#10218;filepath">https://github.com/&#10218;user&#10219;/&#10218;project&#10219;/commits/master/content/&#10218;filepath</a>&#10219;
  "</span></span><span class="org-block">

  (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((github  </span><span class="org-block"><span class="string">"<a href="https://github.com/">https://github.com/</a>"</span></span><span class="org-block">)
     (comm  (s-split </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block"> (s-chop-prefix github url)))
       )

      (</span><span class="org-block"><span class="keyword">setf</span></span><span class="org-block"> (nth 2 comm) </span><span class="org-block"><span class="string">"commits"</span></span><span class="org-block">)

      </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">raw, then commits
</span></span><span class="org-block">      `(
       , (s-prepend </span><span class="org-block"><span class="string">"<a href="https://raw.githubusercontent.com/">https://raw.githubusercontent.com/</a>"</span></span><span class="org-block">
         (s-replace </span><span class="org-block"><span class="string">"/blob/"</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block"> (s-chop-prefix github url)))
       .
       ,(s-prepend github (s-join </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block"> comm))
       )
  )
)
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">make-html-link</span></span><span class="org-block"> (url identifier)
  </span><span class="org-block"><span class="doc">"Yield HTML string code for a link to &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">url</span></span></span><span class="org-block"><span class="doc">&#8217; presented as &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">identifier</span></span></span><span class="org-block"><span class="doc">&#8217;;
   if &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">url</span></span></span><span class="org-block"><span class="doc">&#8217; is non-nil; otherwise, yield only the text &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">identifier</span></span></span><span class="org-block"><span class="doc">&#8217;.
  "</span></span><span class="org-block">
  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">(message-box url)
</span></span><span class="org-block">  (</span><span class="org-block"><span class="keyword">if</span></span><span class="org-block"> url
      (concat </span><span class="org-block"><span class="string">"&lt;a href=\""</span></span><span class="org-block"> url </span><span class="org-block"><span class="string">"\" target=\"_self\"&gt;"</span></span><span class="org-block"> identifier </span><span class="org-block"><span class="string">"&lt;/a&gt;"</span></span><span class="org-block">)
      identifier
  )
)
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">make-top-matter</span></span><span class="org-block"> ()
  </span><span class="org-block"><span class="doc">"This is the top-most text that appears right after the article's
   title. It includes viewing the source, a PDF rendition, and
   the most recent date of modification --unless the variables are nil.
  "</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((date (format-time-string </span><span class="org-block"><span class="string">"%Y-%m-%d"</span></span><span class="org-block">))
     (content </span><span class="org-block"><span class="string">""</span></span><span class="org-block">)
     (rawsrc  (car (get-raw-and-commits org.sourcefile)))
     (commits (cdr (get-raw-and-commits org.sourcefile)))
    )

     </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Perform the loop over tuples (constraint url description).
</span></span><span class="org-block">     (</span><span class="org-block"><span class="keyword">dolist</span></span><span class="org-block"> (var `( (,org.nopdf ,blogrepo-file.pdf  </span><span class="org-block"><span class="string">"Read as PDF"</span></span><span class="org-block">   )
             (,org.nopdf nil                 </span><span class="org-block"><span class="string">" or "</span></span><span class="org-block">          )
             (nil ,rawsrc                    </span><span class="org-block"><span class="string">"See the source"</span></span><span class="org-block">)
             (,org.nomodificationdate nil
                ,(concat </span><span class="org-block"><span class="string">" ; "</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">unless</span></span><span class="org-block"> org.nopdf </span><span class="org-block"><span class="string">"&lt;br&gt;"</span></span><span class="org-block">)))
             (,org.nomodificationdate ,commits </span><span class="org-block"><span class="string">"Last modified"</span></span><span class="org-block">)
             (,org.nomodificationdate nil ,(concat </span><span class="org-block"><span class="string">" on "</span></span><span class="org-block"> date))
           )
          content)
      </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Unless there are constraints, concatenate the resulting html.
</span></span><span class="org-block">      (</span><span class="org-block"><span class="keyword">unless</span></span><span class="org-block"> (car var) (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> content (concat content (make-html-link (cadr var) (caddr var)))))
     )

     </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">for debugging / drafting,
</span></span><span class="org-block">     (concat
       (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> org.draft (format </span><span class="org-block"><span class="string">"&lt;center&gt; Draft: %s &lt;/center&gt;"</span></span><span class="org-block"> (gensym)))
       </span><span class="org-block"><span class="string">"&lt;small&gt; &lt;center&gt; &#10216; "</span></span><span class="org-block"> content </span><span class="org-block"><span class="string">" &#10217; &lt;/center&gt; &lt;/small&gt;"</span></span><span class="org-block">)
  )
)
</span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Rather than &lt;small&gt;, maybe utilise &lt;font size="3"&gt;.
</span></span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">***</span><span class="org-level-4">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-4"> org-html-postamble-format at the end of the webpage </span><span class="org-level-4"><span class="org-tag">:old_approach:</span></span>
    <span class="org-drawer">:PROPERTIES:</span>
    <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-org-html-postamble-format-at-the-end-of-the-webpage</span>
    <span class="org-drawer">:END:</span>

<span class="comment"> # Look at the super short doc to know how to manipulate this variable: (describe-symbol 'org-html-postamble-format)</span>
<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org-html-postamble-format
  (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((nomorg (buffer-name))
     (nom    (file-name-sans-extension nomorg))
     (src    (make-html-link (concat </span><span class="org-block"><span class="string">"../content/"</span></span><span class="org-block"> nomorg) </span><span class="org-block"><span class="string">"Org Source"</span></span><span class="org-block">))
     (nompdf (concat blogrepo </span><span class="org-block"><span class="string">"/assets/pdfs/"</span></span><span class="org-block"> nom </span><span class="org-block"><span class="string">".pdf"</span></span><span class="org-block">))
     (pdf    (make-html-link nompdf </span><span class="org-block"><span class="string">"View me as a PDF"</span></span><span class="org-block">))
    )
`((</span><span class="org-block"><span class="string">"en"</span></span><span class="org-block"> ,(concat </span><span class="org-block"><span class="string">"&lt;hr&gt; &lt;center&gt; Last modified on %C ; "</span></span><span class="org-block"> pdf </span><span class="org-block"><span class="string">" or see the "</span></span><span class="org-block"> src </span><span class="org-block"><span class="string">" ; Contact me at %e &lt;/center&gt;"</span></span><span class="org-block">))))
)
</span><span class="org-block-end-line"> #+END_SRC
</span>
 To avoid having a postamble altogether we could include
<span class="org-block-begin-line"> #+BEGIN_SRC org
</span><span class="org-block">,#+OPTIONS: html-postamble:nil
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* </span><span class="org-level-3"><span class="org-code">preview-article</span></span><span class="org-level-3"> -- the heart of </span><span class="org-level-3"><span class="org-code">AlBasmala.el</span></span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">preview-article-the-heart-of-AlBasmala-el</span>
   <span class="org-drawer">:END:</span>

 We make the article in stages:
  0. Go to the Org source and use the native Org utitlies to produce a coloured html file.
  1. Insert the article image into that html file.
     - We do so <span class="bold">before</span> producing the Jekyll markdown variant so that we can preview it correctly.
  2. Remove <span class="writegood-weasels">some</span> clutter from the html, yielding a markdown file.
  3. Prepend the Jekyll header created using the keywords.
  4. Move the markdown file to the <span class="org-code">_posts</span> directory and show the html file in a browser.

 <span class="org-drawer">:Nope:</span>
 We use <span class="org-code">toggle</span>, a personal function from my <span class="org-code">init</span>,
 that toggles a variables value till the end of its form.
 We use it below to disable all <span class="org-link"><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/File-Local-Variables.html">Emacs buffer local variables</a></span>, do <span class="writegood-weasels">some</span> work,
 then re-enable them afterwards. Such variables generally require a query
 since they could be dangerous, like erasing the disk, so we disable them temporarily.
 <span class="org-drawer">:End:</span>

<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(local-set-key (kbd </span><span class="org-block"><span class="string">"&lt;f7&gt;"</span></span><span class="org-block">) 'preview-article)

  (</span><span class="org-block"><span class="keyword">cl-defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">preview-article</span></span><span class="org-block"> (</span><span class="org-block"><span class="type">&amp;key</span></span><span class="org-block"> (browser nil) (draft nil))
    </span><span class="org-block"><span class="doc">"Create and preview a the html form of the content.

    A non-nil value for &#8220;org.nopdf&#8221; short-circuits the generation of a PDF,
    thereby yielding a possibly faster execution.

    A non-nil value for &#8220;:browser&#8221; opens the article using the default browser.
    This may be undesirable, since it may open </span></span><span class="org-block"><span class="doc"><span class="writegood-weasels">many</span></span></span><span class="org-block"><span class="doc"> tabs in your brower.

    The &#8216;</span></span><span class="org-block"><span class="doc"><span class="constant">draft</span></span></span><span class="org-block"><span class="doc">&#8217; keyword option is here in case we want to override
    whatever the local &#8216;#+DRAFT&#8217; value may be.
    "</span></span><span class="org-block">

    (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)
    (save-buffer)

    (ensure-blog-is-serving)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Remove any existing html, in case we fail to generate it
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">we do not want to render an out of date version.
</span></span><span class="org-block">    (shell-command (concat </span><span class="org-block"><span class="string">"rm ~/alhassy.github.io/_posts/"</span></span><span class="org-block"> jekyll.name.md))

    (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> enable-local-variables nil)
    (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> enable-local-eval nil)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">compile coloured html
</span></span><span class="org-block">    (find-</span><span class="org-block"><span class="writegood-duplicates">file file</span></span><span class="org-block">.org)
    (GetOrgKeyWords)
    (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> draft (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> org.</span><span class="org-block"><span class="writegood-duplicates">draft draft</span></span><span class="org-block">))
    (org-html-export-to-html)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Insert image, duh.
</span></span><span class="org-block">    (insert-image-and-other-formats)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Discard first 3 lines, (note the 1-indexing), since they don't look </span></span><span class="org-block"><span class="comment"><span class="writegood-weasels">very</span></span></span><span class="org-block"><span class="comment"> nice
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">in the resulting markdown file when rendered on the Jekyll site.
</span></span><span class="org-block">    (shell-command (concat </span><span class="org-block"><span class="string">"tail -n +4 &lt;"</span></span><span class="org-block"> file.html </span><span class="org-block"><span class="string">" &gt;"</span></span><span class="org-block"> jekyll.name.md))

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Preprend file with a header.
</span></span><span class="org-block">    (find-file jekyll.name.md)
    (beginning-of-buffer)
    (MakeHeader)
    (insert HEADER)
    (save-buffer)
    (kill-buffer jekyll.name.md)

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Move it to posts directory.
</span></span><span class="org-block">    (shell-command (concat </span><span class="org-block"><span class="string">"mv "</span></span><span class="org-block"> jekyll.name.md </span><span class="org-block"><span class="string">" "</span></span><span class="org-block"> blogrepo-posts))

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">;; Uncomment for debugging.
</span></span><span class="org-block">    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">;; (find-file (concat "~/alhassy.github.io/_posts/" jekyll.name.md))
</span></span><span class="org-block">
    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">no pdf generation in draft mode
</span></span><span class="org-block">    (</span><span class="org-block"><span class="keyword">unless</span></span><span class="org-block"> (</span><span class="org-block"><span class="keyword">or</span></span><span class="org-block"> org.draft org.nopdf) (my-org-latex-export-to-pdf))

    </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Preview locally in browser.
</span></span><span class="org-block">    (</span><span class="org-block"><span class="keyword">when</span></span><span class="org-block"> browser
      (</span><span class="org-block"><span class="keyword">let*</span></span><span class="org-block"> ((buf (concat </span><span class="org-block"><span class="string">"*AlBasmala*"</span></span><span class="org-block"> NAME </span><span class="org-block"><span class="string">"*"</span></span><span class="org-block">)))

        (toggle kill-buffer-query-functions nil (</span><span class="org-block"><span class="keyword">ignore-errors</span></span><span class="org-block"> (kill-buffer buf)))
        (async-shell-command (concat </span><span class="org-block"><span class="string">"open <a href="http://localhost:4000/">http://localhost:4000/</a>"</span></span><span class="org-block"> NAME </span><span class="org-block"><span class="string">"/"</span></span><span class="org-block">) buf)
      )
    )

    (message </span><span class="org-block"><span class="string">"Article has </span></span><span class="org-block"><span class="string"><span class="writegood-passive-voice">been opened</span></span></span><span class="org-block"><span class="string"> in your browser."</span></span><span class="org-block">)

    (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> enable-local-variables t)
    (</span><span class="org-block"><span class="keyword">setq</span></span><span class="org-block"> enable-local-eval t)
  )
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* </span><span class="org-special-keyword">COMMENT</span><span class="org-level-3"> Version control                    </span><span class="org-level-3"><span class="org-tag">:Deprecated:Before_magit_time:</span></span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Version-control</span>
   <span class="org-drawer">:END:</span>

   A <span class="writegood-weasels">simple</span> version control mechanism; will likely switch to <span class="org-code">magit</span> in the future.

<span class="org-block-begin-line">  #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(global-set-key (kbd </span><span class="org-block"><span class="string">"&lt;f8&gt;"</span></span><span class="org-block">) 'commit)

(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">commit</span></span><span class="org-block"> () </span><span class="org-block"><span class="doc">"Commit changes to git in the form: &#8220;ChangedFile: CommitMessage&#8221;."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)

  </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">In-case the article </span></span><span class="org-block"><span class="comment"><span class="writegood-passive-voice">was updated</span></span></span><span class="org-block"><span class="comment"> but we forgot to produce new generated files.
</span></span><span class="org-block">  (preview-article)

  (shell-command </span><span class="org-block"><span class="string">"rm *.html"</span></span><span class="org-block">)   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">remove noise
</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">let</span></span><span class="org-block"> ((msg (read-string (format </span><span class="org-block"><span class="string">"Commit message for %s: "</span></span><span class="org-block"> NAME))))
   </span><span class="org-block"><span class="comment-delimiter">; </span></span><span class="org-block"><span class="comment">(shell-command (format "git add    ../_posts/%s ../content/</span></span><span class="org-block"><span class="comment"><span class="writegood-duplicates">%s %s</span></span></span><span class="org-block"><span class="comment"> %s" jekyll.name.md file.org blogrepo-file.pdf file.el))
</span></span><span class="org-block">   </span><span class="org-block"><span class="comment-delimiter">; </span></span><span class="org-block"><span class="comment">(shell-command (format "git commit ../_posts/%s ../content/</span></span><span class="org-block"><span class="comment"><span class="writegood-duplicates">%s %s</span></span></span><span class="org-block"><span class="comment"> %s -m \"%s: %s\"" jekyll.name.md file.org blogrepo-file.pdf file.el NAME msg))
</span></span><span class="org-block">
   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">&#8220;git add commitables&#8221;
</span></span><span class="org-block">   (shell-command  (s-join </span><span class="org-block"><span class="string">" "</span></span><span class="org-block"> (cons </span><span class="org-block"><span class="string">"git add"</span></span><span class="org-block"> commitables)))

   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">&#8220;git commit commitables -m NAME: message&#8221;
</span></span><span class="org-block">   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">Note that the commit message needs to be in quotes.
</span></span><span class="org-block">   (shell-command  (s-join </span><span class="org-block"><span class="string">" "</span></span><span class="org-block"> (append (cons </span><span class="org-block"><span class="string">"git commit"</span></span><span class="org-block"> commitables) (list (format </span><span class="org-block"><span class="string">"-m \"%s: %s\""</span></span><span class="org-block"> NAME msg)))))
  )
)
</span><span class="org-block-end-line">  #+END_SRC
</span>
<span class="org-hide">**</span><span class="org-level-3">* Publish</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Publish</span>
   <span class="org-drawer">:END:</span>

<span class="org-block-begin-line"> #+BEGIN_SRC emacs-lisp :tangle AlBasmala.el
</span><span class="org-block">(</span><span class="org-block"><span class="keyword">defun</span></span><span class="org-block"> </span><span class="org-block"><span class="function-name">publish</span></span><span class="org-block"> () </span><span class="org-block"><span class="doc">"Send material to github pages."</span></span><span class="org-block">
  (</span><span class="org-block"><span class="keyword">interactive</span></span><span class="org-block">)

  (message (format </span><span class="org-block"><span class="string">"Publishing article: %s "</span></span><span class="org-block"> NAME))

  (shell-command </span><span class="org-block"><span class="string">"rm *.html"</span></span><span class="org-block">)   </span><span class="org-block"><span class="comment-delimiter">;; </span></span><span class="org-block"><span class="comment">remove noise
</span></span><span class="org-block">
  (eshell)
  (</span><span class="org-block"><span class="keyword">with-current-buffer</span></span><span class="org-block"> </span><span class="org-block"><span class="string">"*eshell*"</span></span><span class="org-block">
    (eshell-return-to-prompt)
    (insert (concat </span><span class="org-block"><span class="string">"cd ~/alhassy.github.io/_posts/"</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">" ; "</span></span><span class="org-block">
            (format </span><span class="org-block"><span class="string">"git add </span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">%s %s</span></span></span><span class="org-block"><span class="string">"</span></span><span class="org-block"> jekyll.name.md blogrepo-file.pdf))
            </span><span class="org-block"><span class="string">" ; "</span></span><span class="org-block">
            (format </span><span class="org-block"><span class="string">"git commit </span></span><span class="org-block"><span class="string"><span class="writegood-duplicates">%s %s</span></span></span><span class="org-block"><span class="string"> -m \"%s: %s\""</span></span><span class="org-block"> jekyll.name.md blogrepo-file.pdf NAME </span><span class="org-block"><span class="string">"Article updated."</span></span><span class="org-block">)
            </span><span class="org-block"><span class="string">" ; "</span></span><span class="org-block">
            </span><span class="org-block"><span class="string">"git push"</span></span><span class="org-block">)
    (switch-to-buffer </span><span class="org-block"><span class="string">"*eshell*"</span></span><span class="org-block">)
    (eshell-send-input)
  )
)
</span><span class="org-block-end-line"> #+END_SRC
</span>
<span class="comment"> # Remember it takes 10 seconds for the live github page to actually change!</span>

<span class="org-hide">**</span><span class="org-level-3">* Usage</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">Usage</span>
   <span class="org-drawer">:END:</span>

<span class="comment"> # Within src blocks containing org, you need to escape org heading, the `*`, delimiters with a comma.</span>
<span class="comment"> # E.g.: ,* My heading</span>


<span class="org-block-begin-line"> #+BEGIN_EXPORT html
</span><span class="org-block"> &lt;</span><span class="org-block"><span class="function-name">table</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">style</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"width:100%"</span></span><span class="org-block">&gt;
   &lt;</span><span class="org-block"><span class="function-name">tr</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line"> #+END_EXPORT
</span>
<span class="org-meta-line"> #+HTML: &lt;td&gt;</span>
 The <span class="org-link"><a href="file:template.org">example</a></span> source,
<span class="org-meta-line"> #+HTML: &lt;small&gt;</span>
<span class="comment"> # </span><span class="comment"><span class="hl-todo"><span class="custom-14">TODO</span></span></span><span class="comment">. ? +INCLUDE: "template.org" src org</span>
<span class="org-meta-line"> #+HTML: &lt;/small&gt; &lt;/td&gt;</span>

<span class="org-meta-line"> #+HTML:  &lt;td&gt; Results in, &lt;br&gt; &lt;br&gt; &lt;br&gt;</span>
<span class="org-block-begin-line"> #+BEGIN_EXPORT html
</span><span class="org-block"> &lt;</span><span class="org-block"><span class="function-name">iframe</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">src</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"../assets/demoing_template.html"</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">style</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"width:100%"</span></span><span class="org-block"> </span><span class="org-block"><span class="variable-name">height</span></span><span class="org-block">=</span><span class="org-block"><span class="string">"487"</span></span><span class="org-block">&gt;
     alternative content for browsers which do not support iframe.
 &lt;/</span><span class="org-block"><span class="function-name">iframe</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line"> #+END_EXPORT
</span><span class="org-meta-line"> #+HTML:  &lt;/td&gt;</span>
<span class="org-block-begin-line"> #+BEGIN_EXPORT html
</span><span class="org-block">   &lt;/</span><span class="org-block"><span class="function-name">tr</span></span><span class="org-block">&gt;
 &lt;/</span><span class="org-block"><span class="function-name">table</span></span><span class="org-block">&gt;
</span><span class="org-block-end-line"> #+END_EXPORT
</span>
<span class="org-meta-line"> #+latex: In the LaTeX format, this content is not supported.</span>


<span class="org-hide">**</span><span class="org-level-3">* footer</span>
   <span class="org-drawer">:PROPERTIES:</span>
   <span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">footer</span>
   <span class="org-drawer">:END:</span>

 <span class="hl-todo"><span class="custom-12">NOTE</span></span>: It takes about 20secs ~ 1min for the changes to be live on github pages.

<span class="org-level-1">* The name: </span><span class="org-level-1"><span class="org-link"><a href="https://en.wikipedia.org/wiki/Basmala">al-bas-mal</a><a href="https://en.wikipedia.org/wiki/Basmala">a</a></span></span>
  <span class="org-drawer">:PROPERTIES:</span>
  <span class="org-special-keyword">:CUSTOM_ID:</span>  <span class="org-property-value">the-name</span>
  <span class="org-drawer">:END:</span>

The prefix <span class="italic">al</span> is the Arabic definite particle which may correspond to English's <span class="italic">the</span>;
whereas <span class="italic">basmala</span> refers to a beginning.

That is, this is a variation on the traditional <span class="org-link"><a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program">"hello world"</a></span> ;-)

<span class="org-level-1">* Appendix: Using a Custom Domain: </span><span class="org-level-1"><span class="org-code">alhassy.com</span></span>
<span class="org-drawer">:PROPERTIES:</span>
<span class="org-special-keyword">:CUSTOM_ID:</span> <span class="org-property-value">COMMENT-Using-a-Custom-Domain-alhassy-com</span>
<span class="org-drawer">:END:</span>

1. Go to your repo: <span class="org-link"><a href="https://github.com/alhassy/alhassy.github.io/settings/pages">https://github.com/alhassy/alhassy.github.io/settings/pages</a></span>
2. Add a <span class="org-verbatim">Custom Domain</span> such as an &#8220;apex domain&#8221; like <span class="org-verbatim">alhassy.com</span> (or a www domain like <span class="org-verbatim">www.alhassy.com</span>)
   - Apex domains require <span class="org-verbatim">A</span> records to be setup on your DNS provider.
   - www domains require <span class="org-verbatim">CNAME</span> records.
   - On my DNS provider, I setup both: That way, with or without <span class="org-verbatim">www.</span>, people will arrive at my blog.
3. Go to your DNS provider, and add two records
   <span class="org-table">| Type  | Name | Priority | Content           |   TTL |</span>
   <span class="org-table">|-------+------+----------+-------------------+-------|</span>
   <span class="org-table">| CNAME | www  |        0 | alhassy.github.io | 14400 |</span>
   <span class="org-table">| CNAME | @    |        0 | alhassy.github.io | 14400 |</span>
4. In a terminal, run: <span class="org-verbatim">dig www.alhassy.com +nostats +nocomments +nocmd</span>
   - The <span class="org-verbatim">www.</span> is intentional.

5. You should see something like:
<span class="org-block-begin-line">    #+begin_example bash
</span><span class="org-block">    www.alhassy.com.    14400   IN      CNAME   alhassy.github.io.
    alhassy.github.io.  3600    IN      A       185.199.111.153
    alhassy.github.io.  3600    IN      A       185.199.108.153
    alhassy.github.io.  3600    IN      A       185.199.109.153
    alhassy.github.io.  3600    IN      A       185.199.110.153
</span><span class="org-block-end-line">    #+end_example
</span>
    This says that it may take 3600 seconds, or 1hour, for the redirect of <span class="org-code">alhassy.com</span> to
    <span class="org-code">alhassy.github.io</span> to <span class="writegood-passive-voice">be completed</span>. It may take longer; keep reading.

6. In your DNS provider, add 4 records, one for each IP Address you got from the <span class="org-verbatim">dig</span> command.
   (These addresses are also on the official Github <span class="org-link"><a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site">docs</a></span>).

   <span class="org-table">| Type | Name | Priority |         Content |   TTL |</span>
   <span class="org-table">|------+------+----------+-----------------+-------|</span>
   <span class="org-table">| A    | @    |        0 | 185.199.108.153 | 14400 |</span>
   <span class="org-table">| A    | @    |        0 | 185.199.109.153 | 14400 |</span>
   <span class="org-table">| A    | @    |        0 | 185.199.110.153 | 14400 |</span>
   <span class="org-table">| A    | @    |        0 | 185.199.111.153 | 14400 |</span>

7. Run <span class="org-verbatim">dig alhassy.com +noall +answer -t A</span> and ensure it points to these IP addresses.
   - Notice the lack of a <span class="org-verbatim">www.</span>

8. Open an incognito browser, private browsing session, and navigate to <span class="org-verbatim">alhassy.com</span>.
   a. If this redirects to your <span class="org-verbatim">alhassy.github.io</span> blog, then joy!
      - If the redirect does not happen in your non-incognito browser, just clear your browsing history and try again.
   b. Otherwise, it may take <span class="writegood-weasels">some</span> time (something like 1/2hour to 3 days) for the DNS propagation
      to <span class="writegood-passive-voice">be completed</span>.
      - You can check the progress by using a <span class="org-link"><a href="https://www.whatsmydns.net/#A/alhassy.com">service like this</a></span>.
      - It took me about 1/2hour for the URL to redirect to my github.io blog.

Further resources:
- <span class="org-link"><a href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site">Managing a custom domain for your GitHub Pages site - GitHub Docs</a></span>
- <span class="org-link"><a href="https://richpauloo.github.io/2019-11-17-Linking-a-Custom-Domain-to-Github-Pages/">Linking A Custom Domain To Github Pages</a></span>
</pre>
  </body>
</html>
